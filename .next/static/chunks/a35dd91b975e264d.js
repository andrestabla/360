(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,a)=>{t.exports=e.r(76562)},31487,e=>{"use strict";let t=["MANAGE_UNITS","MANAGE_USERS","VIEW_ALL_DOCS","UPLOAD_DOCS","DELETE_DOCS","MANAGE_WORKFLOWS","VIEW_ANALYTICS","MANAGE_SETTINGS","MANAGE_ROLES","MANAGE_STORAGE","VIEW_AUDIT","MANAGE_POSTS","MANAGE_SURVEYS","IMPERSONATE_USERS"],a=[{id:"T1",name:"Empresa Demo",slug:"demo",domains:["demo.maturity360.com"],status:"ACTIVE",timezone:"America/Bogota",locale:"es-CO",branding:{app_title:"Empresa Demo",primary_color:"#2563eb",accent_color:"#1d4ed8",updated_at:new Date().toISOString()},policies:{max_failed_logins:3,lock_minutes:15,file_max_size_bytes:0xa00000,allowed_mime_types:["application/pdf","image/png","image/jpeg"],audit_retention_days:90,sso_enabled:!1,updated_at:new Date().toISOString()},features:["DASHBOARD","WORKFLOWS","REPOSITORY","CHAT","ANALYTICS","SURVEYS"],sector:"technology",contactName:"Juan Admin",contactEmail:"admin@demo.com",contactPhone:"+57 300 123 4567",users:5,storage:"2.5 GB",created_at:"2024-01-15T10:00:00Z",roleTemplates:{1:[...t],2:["MANAGE_UNITS","VIEW_ALL_DOCS","UPLOAD_DOCS","VIEW_ANALYTICS"],3:["VIEW_ALL_DOCS","UPLOAD_DOCS"],4:["VIEW_ALL_DOCS"],5:["VIEW_ALL_DOCS"],6:[]}},{id:"T2",name:"Corporacion Alpha",slug:"alpha",domains:["alpha.maturity360.com"],status:"ACTIVE",timezone:"America/Bogota",locale:"es-CO",branding:{app_title:"Corporacion Alpha",primary_color:"#059669",accent_color:"#047857",updated_at:new Date().toISOString()},policies:{max_failed_logins:5,lock_minutes:30,file_max_size_bytes:0x1400000,allowed_mime_types:["application/pdf"],audit_retention_days:180,sso_enabled:!0,updated_at:new Date().toISOString()},features:["DASHBOARD","WORKFLOWS","REPOSITORY","CHAT"],sector:"finance",contactName:"Maria Gonzalez",contactEmail:"admin@alpha.com",users:12,storage:"8.2 GB",created_at:"2024-02-20T14:30:00Z",roleTemplates:{1:[...t],2:["MANAGE_UNITS","VIEW_ALL_DOCS","UPLOAD_DOCS"],3:["VIEW_ALL_DOCS","UPLOAD_DOCS"],4:["VIEW_ALL_DOCS"],5:[],6:[]}}],n=[{id:"post-1",tenantId:"T1",author:"Juan Admin",authorId:"u1",title:"Bienvenidos a Maturity360",excerpt:"Conoce nuestra nueva plataforma de gestion organizacional",content:"Estamos emocionados de presentar Maturity360, una plataforma integral para la gestion de madurez organizacional. Esta herramienta les permitira mejorar sus procesos, colaborar de manera efectiva y alcanzar sus objetivos estrategicos.",category:"Anuncios",status:"published",audience:"all",date:new Date().toISOString(),likes:15,commentsCount:3},{id:"post-2",tenantId:"T1",author:"Maria Lopez",authorId:"u2",title:"Nuevos procedimientos operativos",excerpt:"Actualizacion de los procedimientos del area de operaciones",content:"Se han actualizado los procedimientos operativos para mejorar la eficiencia. Por favor revisen los documentos adjuntos en el repositorio.",category:"Operaciones",status:"published",audience:"unit",date:new Date(Date.now()-864e5).toISOString(),likes:8,commentsCount:1}],i=[{id:"doc-1",tenantId:"T1",title:"Manual de Procesos v2.0",type:"PDF",size:"2.5 MB",version:"2.0",status:"active",authorId:"u1",unit:"Direccion General",visibility:"public",tags:["procesos","manual","calidad"],likes:12,commentsCount:4,date:new Date().toISOString()},{id:"doc-2",tenantId:"T1",title:"Politica de Seguridad",type:"PDF",size:"1.2 MB",version:"1.5",status:"active",authorId:"u3",unit:"TI",visibility:"public",tags:["seguridad","TI","politicas"],likes:8,commentsCount:2,date:new Date(Date.now()-1728e5).toISOString()}],o=[{id:"proj-1",tenantId:"T1",title:"Implementacion ISO 9001",description:"Proyecto de certificacion en calidad ISO 9001:2015",startDate:"2024-01-01",endDate:"2024-12-31",status:"active",creatorId:"u1",createdAt:"2024-01-01T10:00:00Z",participants:["u1","u2","u3"],phases:[{id:"phase-1",name:"Diagnostico",order:1,status:"completed",activities:[{id:"act-1",name:"Evaluacion inicial",status:"completed",participants:["u1","u2"],documents:[]}]},{id:"phase-2",name:"Implementacion",order:2,status:"in_progress",activities:[{id:"act-2",name:"Documentacion de procesos",status:"in_progress",participants:["u2","u3"],documents:[]}]}],color:"#2563eb"}],s=[{id:"conv-1",tenant_id:"T1",type:"dm",participants:["u1","u2"],lastMessage:"Hola, necesito revisar el documento",lastMessageAt:new Date().toISOString(),unreadCount:0,createdAt:new Date(Date.now()-6048e5).toISOString()},{id:"conv-2",tenant_id:"T1",type:"group",name:"Equipo de Proyecto ISO",participants:["u1","u2","u3"],lastMessage:"Reunion manana a las 10am",lastMessageAt:new Date(Date.now()-36e5).toISOString(),unreadCount:2,createdAt:new Date(Date.now()-2592e6).toISOString()}],r=[{id:"msg-1",tenant_id:"T1",conversation_id:"conv-1",sender_id:"u2",body:"Hola, necesito revisar el documento",body_type:"text",created_at:new Date().toISOString(),senderName:"Maria Lopez"},{id:"msg-2",tenant_id:"T1",conversation_id:"conv-2",sender_id:"u1",body:"Reunion manana a las 10am",body_type:"text",created_at:new Date(Date.now()-36e5).toISOString(),senderName:"Juan Admin"}],d=[{id:"survey-1",tenantId:"T1",title:"Diagnostico de Madurez Organizacional",description:"Evaluacion inicial del nivel de madurez",status:"active",questions:[{id:"q1",text:"Como calificaria el nivel de documentacion de procesos?",type:"scale",required:!0,dimension:"Procesos"},{id:"q2",text:"La organizacion cuenta con indicadores de gestion definidos?",type:"boolean",required:!0,dimension:"Medicion"}],createdAt:new Date().toISOString()}],l={tenants:a,users:[{id:"u1",name:"Juan Admin",email:"admin@demo.com",role:"Admin Global",level:1,tenantId:"T1",unit:"Direccion General",initials:"JA",bio:"Administrador principal de la plataforma",phone:"+57 300 123 4567",location:"Bogota, Colombia",jobTitle:"Director General",language:"es",timezone:"America/Bogota",status:"ACTIVE"},{id:"u2",name:"Maria Lopez",email:"maria@demo.com",role:"Gerente",level:2,tenantId:"T1",unit:"Operaciones",initials:"ML",bio:"Gerente de Operaciones",phone:"+57 300 234 5678",location:"Medellin, Colombia",jobTitle:"Gerente de Operaciones",language:"es",timezone:"America/Bogota",status:"ACTIVE"},{id:"u3",name:"Carlos Perez",email:"carlos@demo.com",role:"Analista",level:3,tenantId:"T1",unit:"TI",initials:"CP",bio:"Analista de sistemas",jobTitle:"Analista TI",language:"es",timezone:"America/Bogota",status:"ACTIVE"},{id:"u4",name:"Ana Garcia",email:"ana@demo.com",role:"Usuario",level:4,tenantId:"T1",unit:"Recursos Humanos",initials:"AG",bio:"Coordinadora de RRHH",jobTitle:"Coordinadora RRHH",status:"ACTIVE"},{id:"u5",name:"Pedro Martinez",email:"pedro@alpha.com",role:"Admin Global",level:1,tenantId:"T2",unit:"Direccion",initials:"PM",bio:"Director Alpha",jobTitle:"Director",status:"ACTIVE"}],units:[{id:"U-T1-1",tenantId:"T1",name:"Direccion General",depth:0,type:"UNIT",description:"Unidad principal de la organizacion"},{id:"U-T1-2",tenantId:"T1",name:"Operaciones",depth:1,parentId:"U-T1-1",type:"DEPARTMENT",description:"Departamento de operaciones"},{id:"U-T1-3",tenantId:"T1",name:"TI",depth:1,parentId:"U-T1-1",type:"DEPARTMENT",description:"Tecnologia de la informacion"},{id:"U-T1-4",tenantId:"T1",name:"Recursos Humanos",depth:1,parentId:"U-T1-1",type:"DEPARTMENT",description:"Gestion de talento humano"}],posts:n,docs:i,projects:o,projectFolders:[],repoFolders:[],workflowDefinitions:[{id:"wf-def-1",tenantId:"T1",title:"Solicitud de Vacaciones",description:"Proceso para solicitar vacaciones",unit:"Recursos Humanos",icon:"calendar",schema:[{id:"step-1",name:"Solicitud",type:"task"},{id:"step-2",name:"Aprobacion Jefe",type:"approval",assigneeRole:"Gerente"},{id:"step-3",name:"Notificacion RRHH",type:"notification"}],slaHours:48,active:!0}],workflowCases:[],platformAudit:[],platformAdmins:[{id:"admin-1",name:"Super Admin",email:"superadmin@maturity360.com",role:"SUPER_ADMIN",status:"ACTIVE",mfaEnabled:!0,lastLogin:new Date().toISOString()}],platformSettings:{defaultModules:["DASHBOARD","WORKFLOWS","REPOSITORY","CHAT","ANALYTICS"],defaultLocale:"es-CO",defaultTimezone:"America/Bogota",authPolicy:{allowRegistration:!0,requireEmailVerification:!0,sessionTimeout:3600,enforceSSO:!1,passwordMinLength:8,mfaPolicy:"optional"}},conversations:s,conversationMembers:[],messages:r,workNotes:[],surveyResponses:[],surveys:d,publicComments:[],emailOutbox:[],storageConfigs:{},contextChats:{},save:function(){try{localStorage.setItem("m360_db",JSON.stringify({tenants:this.tenants,users:this.users,units:this.units,posts:this.posts,docs:this.docs,projects:this.projects,projectFolders:this.projectFolders,repoFolders:this.repoFolders,workflowDefinitions:this.workflowDefinitions,workflowCases:this.workflowCases,platformAudit:this.platformAudit,conversations:this.conversations,messages:this.messages,workNotes:this.workNotes,surveyResponses:this.surveyResponses,surveys:this.surveys,publicComments:this.publicComments,storageConfigs:this.storageConfigs}))}catch(e){console.error("Failed to save DB:",e)}},load:function(){try{let e=localStorage.getItem("m360_db");if(e){let t=JSON.parse(e);Object.assign(this,t)}}catch(e){console.error("Failed to load DB:",e)}}};l.load(),e.s(["DB",0,l,"PERMISSIONS",0,t])},73146,e=>{"use strict";var t=e.i(43476),a=e.i(71645),n=e.i(31487),i=e.i(18566);let o=(0,a.createContext)(void 0);function s({children:s}){let[r,d]=(0,a.useState)(null),[l,c]=(0,a.useState)(null),[u,m]=(0,a.useState)(null),[p,D]=(0,a.useState)(!1),[S,_]=(0,a.useState)(0),[g,I]=(0,a.useState)(!1),[f,A]=(0,a.useState)(0),T=(0,i.useRouter)(),h=u&&n.DB.tenants.find(e=>e.id===u)||null;(0,a.useEffect)(()=>{{let e=localStorage.getItem("m360_user"),t=localStorage.getItem("m360_tenant_id"),a=localStorage.getItem("m360_is_super_admin"),n=localStorage.getItem("m360_original_session");e&&d(JSON.parse(e)),t&&m(t),a&&D("true"===a),n&&c(JSON.parse(n));let i=localStorage.getItem("m360_sidebar_collapsed");i&&I("true"===i)}},[]),(0,a.useEffect)(()=>{r?localStorage.setItem("m360_user",JSON.stringify(r)):localStorage.removeItem("m360_user"),u?localStorage.setItem("m360_tenant_id",u):localStorage.removeItem("m360_tenant_id"),p?localStorage.setItem("m360_is_super_admin","true"):localStorage.removeItem("m360_is_super_admin"),l?localStorage.setItem("m360_original_session",JSON.stringify(l)):localStorage.removeItem("m360_original_session"),localStorage.setItem("m360_sidebar_collapsed",g.toString())},[r,u,p,l,g]);let v=async()=>{if(!r||!u)return void A(0);try{let{ChatService:t}=await e.A(86528),a=(await t.getConversations(r.id,u)).data.reduce((e,t)=>e+(t.unreadCount||0),0);A(a)}catch(e){console.error("Failed to refresh unread count",e)}};(0,a.useEffect)(()=>{v();let e=setInterval(v,1e4);return()=>clearInterval(e)},[r,u]),(0,a.useEffect)(()=>{window.hasSeeded||(console.log("Running Auto-Seeder..."),(()=>{let e=n.DB.conversations.find(e=>"dm"===e.type);if(!e)return console.log("No DM found to seed");console.log("Seeding attachments to conversation:",e.id),n.DB.messages.push({id:"MSG-IMG-TEST",tenant_id:"T1",conversation_id:e.id,sender_id:e.participants?.[0]||"system",body:"Mira esta imagen",body_type:"image",created_at:new Date().toISOString(),senderName:"Test Bot",attachments:[{id:"ATT-1",tenant_id:"T1",message_id:"MSG-IMG-TEST",file_name:"demo-image.jpg",mime_type:"image/jpeg",size:512e3,storage_key:"mock",url:"https://picsum.photos/400/300",created_at:new Date().toISOString()}]}),n.DB.messages.push({id:"MSG-FILE-TEST",tenant_id:"T1",conversation_id:e.id,sender_id:e.participants?.[0]||"system",body:"Aquí tienes el reporte",body_type:"file",created_at:new Date().toISOString(),senderName:"Test Bot",attachments:[{id:"ATT-2",tenant_id:"T1",message_id:"MSG-FILE-TEST",file_name:"reporte-anual.pdf",mime_type:"application/pdf",size:2621440,storage_key:"mock",url:"#",created_at:new Date().toISOString()}]}),console.log("Seeded 2 messages with attachments.")})(),window.hasSeeded=!0);let e=window.location.hostname,t=e.split("."),a="";t.length>(e.includes("localhost")?1:2)&&(a=t[0]),a&&u&&a.toLowerCase()!==u.toLowerCase()&&(console.warn(`Security: User for ${u} detected on ${a}. Logging out.`),B()),a&&p&&!u&&console.warn("Security: Super Admin detected on Tenant Domain.")},[r,u,p]),(0,a.useEffect)(()=>{if(h&&h.branding){let e=document.documentElement;e.style.setProperty("--primary",h.branding.primary_color),e.style.setProperty("--primary-dark",h.branding.accent_color)}else{let e=document.documentElement;e.style.removeProperty("--primary"),e.style.removeProperty("--primary-dark")}},[h]);let B=()=>{d(null),c(null),m(null),D(!1),localStorage.removeItem("m360_user"),localStorage.removeItem("m360_tenant_id"),localStorage.removeItem("m360_is_super_admin"),localStorage.removeItem("m360_original_session"),T.push("/")};return(0,t.jsx)(o.Provider,{value:{currentUser:r,currentTenantId:u,currentTenant:h,isSuperAdmin:p,version:S,originalSession:l,impersonateUser:(e,t)=>{if(!p||!r)return;let a=n.DB.users.find(a=>a.id===e&&a.tenantId===t);a&&(console.log(`Starting impersonation of ${a.email} by ${r.email}`),c(r),d(a),m(t),D(!1),T.push("/dashboard"),n.DB.platformAudit.unshift({id:`evt-${Date.now()}`,event_type:"IMPERSONATION_STARTED",actor_id:r.id,actor_name:r.name,target_tenant_id:t,target_user_id:e,metadata:{reason:"Support Action"},ip:"127.0.0.1",created_at:new Date().toISOString()}))},stopImpersonation:()=>{l&&(console.log("Stopping impersonation, returning to Superadmin"),d(l),D(!0),m(null),c(null),T.push("/dashboard/tenants"),n.DB.platformAudit.unshift({id:`evt-${Date.now()}`,event_type:"IMPERSONATION_ENDED",actor_id:l.id,actor_name:l.name,metadata:{},ip:"127.0.0.1",created_at:new Date().toISOString()}))},login:(e,t,a)=>{if("superadmin"===e)D(!0),d({name:"Super Admin",role:"Platform Owner",initials:"SA",id:"superadmin",level:0,tenantId:"global",unit:"Global",bio:"Super Admin",email:a||"proyectos@algoritmot.com",phone:"",location:"",jobTitle:"Admin",language:"Es",timezone:"GMT-5",status:"ACTIVE"}),m(null),n.DB.platformAudit.unshift({id:`audit-${Date.now()}`,event_type:"LOGIN_SUCCESS",actor_id:"superadmin",actor_name:"Super Admin",metadata:{role:"SUPER_ADMIN"},ip:"127.0.0.1",created_at:new Date().toISOString()}),T.push("/dashboard/tenants");else if(t){let i;if(D(!1),m(t),a&&(i=n.DB.users.find(e=>e.tenantId===t&&e.email?.toLowerCase()===a.toLowerCase())),i||(i=n.DB.users.find(a=>a.tenantId===t&&("admin"===e?1===a.level:a.level>1))),i){if("SUSPENDED"===i.status){alert("Access Denied: Your account has been suspended."),n.DB.platformAudit.unshift({id:`audit-${Date.now()}`,event_type:"LOGIN_FAILED",actor_id:i.id||"unknown",actor_name:i.name||"Unknown",target_tenant_id:t,metadata:{reason:"Account Suspended"},ip:"127.0.0.1",created_at:new Date().toISOString()});return}if("DELETED"===i.status)return void alert("Access Denied: Account not found.");d(i),n.DB.platformAudit.unshift({id:`audit-${Date.now()}`,event_type:"LOGIN_SUCCESS",actor_id:i.id,actor_name:i.name,target_tenant_id:t,metadata:{role:i.role,level:i.level},ip:"127.0.0.1",created_at:new Date().toISOString()}),T.push("/dashboard")}else console.error("User not found for login simulation")}},logout:B,updateUser:e=>{if(r){let t={...r,...e};d(t);let a=n.DB.users.findIndex(e=>e.id===r.id);a>=0&&(n.DB.users[a]=t,n.DB.save())}},createTenant:e=>{let t=`T${n.DB.tenants.length+1}`,a=new Date().toISOString(),i={id:t,name:e.name||"New Tenant",slug:e.slug||`tenant-${t}`,domains:e.domains||[],status:"ACTIVE",timezone:e.timezone||"America/Bogota",locale:e.locale||"es-CO",branding:{app_title:e.name||"New Tenant",primary_color:"#2563eb",accent_color:"#1d4ed8",updated_at:a,...e.branding},policies:{max_failed_logins:3,lock_minutes:15,file_max_size_bytes:0xa00000,allowed_mime_types:["application/pdf"],audit_retention_days:90,sso_enabled:!1,updated_at:a,...e.policies},roleTemplates:{1:Object.values(n.PERMISSIONS),2:["MANAGE_UNITS","VIEW_ALL_DOCS","UPLOAD_DOCS"],3:["VIEW_ALL_DOCS","UPLOAD_DOCS"],4:["VIEW_ALL_DOCS"],5:["VIEW_ALL_DOCS"],6:[]},users:1,storage:"0 GB",created_at:a,features:e.features||["DASHBOARD","WORKFLOWS","REPOSITORY","CHAT","ANALYTICS"],sector:e.sector,contactName:e.contactName,contactEmail:e.contactEmail,contactPhone:e.contactPhone};n.DB.tenants.push(i);let o=`u-adm-${t}`,s=e.contactEmail||`admin@${i.slug}.com`;return n.DB.users.push({id:o,name:e.contactName||`Admin ${i.name}`,email:s,role:"Admin Global",level:1,tenantId:t,unit:"Root",initials:"AD",bio:"Initial Admin",phone:e.contactPhone||"",location:"Main",jobTitle:"Administrator",language:i.locale,timezone:i.timezone,status:"ACTIVE"}),n.DB.emailOutbox.unshift({id:`email-${Date.now()}`,to:s,subject:"Bienvenido a Maturity360 - Credenciales de Acceso",body:`Hola ${e.contactName||"Admin"},

Tu organizaci\xf3n ${i.name} ha sido registrada exitosamente.

Tus credenciales de acceso son:
URL: https://maturity360.com/login
Usuario: ${s}
Contrase\xf1a Temporal: Temp123!`,status:"SENT",sentAt:a}),n.DB.platformAudit.unshift({id:`audit-${Date.now()}`,event_type:"TENANT_CREATED",actor_id:r?.id||"system",actor_name:r?.name||"System",target_tenant_id:t,metadata:{name:i.name,slug:i.slug,adminEmail:s},ip:"127.0.0.1",created_at:new Date().toISOString()}),n.DB.save(),console.log("Tenant Created:",i),i},updateTenant:(e,t)=>{let a=n.DB.tenants.findIndex(t=>t.id===e);if(a>=0){let i=n.DB.tenants[a],o=Object.keys(t).filter(e=>"branding"!==e&&"policies"!==e);t.branding&&o.push("branding"),t.policies&&o.push("policies"),n.DB.platformAudit.unshift({id:`audit-${Date.now()}`,event_type:t.status?`TENANT_${t.status}`:"TENANT_UPDATED",actor_id:r?.id||"system",actor_name:r?.name||"System",target_tenant_id:e,metadata:{changes:o,updates:t},ip:"127.0.0.1",created_at:new Date().toISOString()}),n.DB.tenants[a]={...i,...t,branding:t.branding?{...i.branding,...t.branding}:i.branding,policies:t.policies?{...i.policies,...t.policies}:i.policies},n.DB.save()}},deleteTenant:e=>{let t=n.DB.tenants.findIndex(t=>t.id===e);if(t<0)return;let a=n.DB.tenants[t];for(let t=n.DB.users.length-1;t>=0;t--)n.DB.users[t].tenantId===e&&n.DB.users.splice(t,1);for(let t=n.DB.docs.length-1;t>=0;t--)n.DB.docs[t].tenantId===e&&n.DB.docs.splice(t,1);for(let t=n.DB.projects.length-1;t>=0;t--)n.DB.projects[t].tenantId===e&&n.DB.projects.splice(t,1);for(let t=n.DB.posts.length-1;t>=0;t--)n.DB.posts[t].tenantId===e&&n.DB.posts.splice(t,1);for(let t=n.DB.workflowCases.length-1;t>=0;t--)n.DB.workflowCases[t].tenantId===e&&n.DB.workflowCases.splice(t,1);n.DB.tenants.splice(t,1),n.DB.platformAudit.unshift({id:`audit-${Date.now()}`,event_type:"TENANT_DELETED",actor_id:r?.id||"system",actor_name:r?.name||"System",target_tenant_id:e,metadata:{name:a.name,slug:a.slug},ip:"127.0.0.1",created_at:new Date().toISOString()}),_(e=>e+1)},createUnit:e=>{if(!u)return;let t={id:`U-${u}-${Math.floor(1e4*Math.random())}`,tenantId:u,name:e.name||"New Unit",depth:e.depth||0,code:e.code,parentId:e.parentId,ownerId:e.ownerId,description:e.description,members:e.members||[],type:e.type||"UNIT"};n.DB.units.push(t),n.DB.save()},updateUnit:(e,t)=>{let a=n.DB.units.findIndex(t=>t.id===e);a>=0&&(n.DB.units[a]={...n.DB.units[a],...t},n.DB.save())},deleteUnit:e=>{let t=n.DB.units.findIndex(t=>t.id===e);t>=0&&n.DB.units.splice(t,1)},updateLevelPermissions:(e,t)=>{if(!h)return;let a=n.DB.tenants.findIndex(e=>e.id===u);if(a>=0){let i=n.DB.tenants[a];i.roleTemplates={...i.roleTemplates,[e]:t}}},adminCheckEmailUnique:e=>!n.DB.users.some(t=>t.email?.toLowerCase()===e.toLowerCase()),adminCreateUser:(e,t={})=>{let a=`u-${Date.now()}`,i={id:a,tenantId:e.tenantId||u||"global",password:t.customPassword,name:e.name||"Usuario Nuevo",email:e.email,role:e.role||"Analista",level:e.level||6,unit:e.unit||"",initials:(e.name||"U").substring(0,2).toUpperCase(),bio:e.bio||"",phone:e.phone||"",location:e.location||"",jobTitle:e.jobTitle||"Empleado",language:"Es",timezone:"GMT-5",status:e.status||"ACTIVE",mustChangePassword:!0,inviteSentAt:t.sendNotification?new Date().toISOString():void 0,inviteExpiresAt:t.sendNotification?new Date(Date.now()+2592e5).toISOString():void 0};n.DB.users.push(i),n.DB.platformAudit.unshift({id:`audit-${Date.now()}`,event_type:"USER_CREATED",actor_id:r?.id||"system",actor_name:r?.name||"System",target_user_id:a,target_tenant_id:i.tenantId,metadata:{...i,notificationSent:t.sendNotification},ip:"127.0.0.1",created_at:new Date().toISOString()}),n.DB.save(),t.sendNotification&&i.email&&(n.DB.emailOutbox.unshift({id:`email-${Date.now()}`,to:i.email,subject:`Bienvenido a Maturity360 - ${"global"!==i.tenantId?"Tenant Invitation":"Platform Access"}`,body:`Hola ${i.name},

Tu cuenta ha sido creada. Tu contrase\xf1a temporal es: Temp123!
Ingresa en: https://${i.tenantId}.maturity360.com`,status:"SENT",sentAt:new Date().toISOString()}),console.log(`[MockEmail] Sent to ${i.email}`))},adminResendInvite:e=>{let t=n.DB.users.findIndex(t=>t.id===e);if(t>=0){let e=n.DB.users[t],a={...e,inviteSentAt:new Date().toISOString(),inviteExpiresAt:new Date(Date.now()+2592e5).toISOString()};n.DB.users[t]=a,e.email&&n.DB.emailOutbox.unshift({id:`email-${Date.now()}`,to:e.email,subject:"Resend: Bienvenido a Maturity360",body:`Hola ${e.name},

Aqui tienes tu enlace de acceso: https://${e.tenantId}.maturity360.com
Credenciales temporales: Temp123!`,status:"SENT",sentAt:new Date().toISOString()}),n.DB.platformAudit.unshift({id:`audit-${Date.now()}`,event_type:"USER_INVITE_RESENT",actor_id:r?.id||"system",actor_name:r?.name||"System",target_user_id:e.id,target_tenant_id:e.tenantId,metadata:{email:e.email},ip:"127.0.0.1",created_at:new Date().toISOString()}),n.DB.save()}},adminUpdateUser:(e,t)=>{let a=n.DB.users.findIndex(t=>t.id===e);if(a>=0){let i=n.DB.users[a],o=[];t.role&&t.role!==i.role&&o.push(`Role change: ${i.role} -> ${t.role}`),t.tenantId&&t.tenantId!==i.tenantId&&o.push(`Tenant transfer: ${i.tenantId} -> ${t.tenantId}`),t.status&&t.status!==i.status&&o.push(`Status change: ${i.status} -> ${t.status}`),t.email&&t.email!==i.email&&o.push(`Email update: ${i.email} -> ${t.email}`),t.password&&o.push("Password manually updated"),void 0!==t.mustChangePassword&&t.mustChangePassword!==i.mustChangePassword&&o.push(`Force Password Change: ${t.mustChangePassword?"Enabled":"Disabled"}`),o.length>0&&n.DB.platformAudit.unshift({id:`audit-${Date.now()}`,event_type:"USER_UPDATED",actor_id:r?.id||"system",actor_name:r?.name||"System",target_user_id:e,target_tenant_id:i.tenantId,metadata:{changes:o,updates:t},ip:"127.0.0.1",created_at:new Date().toISOString()}),n.DB.users[a]={...i,...t},n.DB.save()}},adminDeleteUser:e=>{let t=n.DB.users.findIndex(t=>t.id===e);if(t>=0){let a=n.DB.users[t];if(1===a.level&&"DELETED"!==a.status&&0===n.DB.users.filter(t=>t.tenantId===a.tenantId&&1===t.level&&t.id!==e&&"ACTIVE"===t.status).length)return void alert("Integrity Error: Cannot delete the last active Admin for this tenant.");let i=a.status;n.DB.users[t]={...a,status:"DELETED"},n.DB.platformAudit.unshift({id:`audit-${Date.now()}`,event_type:"USER_DELETED",actor_id:r?.id||"system",actor_name:r?.name||"System",target_user_id:e,target_tenant_id:a.tenantId,metadata:{previous_status:i},ip:"127.0.0.1",created_at:new Date().toISOString()})}},adminCreatePost:e=>{let t={...e,id:`P-${u}-${Date.now()}`,date:"Ahora",likes:0,commentsCount:0};n.DB.posts.unshift(t),n.DB.save(),_(e=>e+1)},adminUpdatePost:(e,t)=>{let a=n.DB.posts.find(t=>t.id===e);a&&(Object.assign(a,t),n.DB.save(),_(e=>e+1))},adminDeletePost:e=>{let t=n.DB.posts.findIndex(t=>t.id===e);-1!==t&&(n.DB.posts.splice(t,1),n.DB.save(),_(e=>e+1))},adminCreateWorkflow:e=>{if(!u)return;let t={id:`WF-${Date.now()}`,tenantId:u,title:e.title||"Nuevo Proceso",description:e.description||"",unit:e.unit||"",ownerId:e.ownerId,icon:e.icon||"FileText",schema:e.schema||{fields:[]},slaHours:e.slaHours||24,active:!0};n.DB.workflowDefinitions.unshift(t),n.DB.save(),_(e=>e+1)},uploadDoc:e=>{let t={id:`DOC-${u}-${Date.now()}`,date:new Date().toISOString().split("T")[0],likes:0,commentsCount:0,...e};n.DB.docs.unshift(t),n.DB.save(),_(e=>e+1)},updateDoc:(e,t)=>{let a=n.DB.docs.find(t=>t.id===e);a&&(Object.assign(a,t),n.DB.save(),_(e=>e+1))},deleteDoc:e=>{let t=n.DB.docs.findIndex(t=>t.id===e);t>=0&&(n.DB.docs.splice(t,1),n.DB.save(),_(e=>e+1))},toggleDocLike:e=>{let t=n.DB.docs.find(t=>t.id===e);t&&(t.likes>0?t.likes--:t.likes++,n.DB.save(),_(e=>e+1))},addDocComment:(e,t)=>{let a={id:`c-${Date.now()}`,docId:e,authorId:r?.id||"anon",authorName:r?.name||"Anónimo",content:t,createdAt:new Date().toISOString()};n.DB.publicComments.push(a);let i=n.DB.docs.find(t=>t.id===e);i&&(i.commentsCount=(i.commentsCount||0)+1),n.DB.save(),_(e=>e+1)},createProject:e=>{if(!u)return;let t={id:`PROJ-${Date.now()}`,tenantId:u,title:e.title||"Nuevo Proyecto",description:e.description||"",startDate:e.startDate||new Date().toISOString(),endDate:e.endDate||new Date().toISOString(),status:"PLANNING",creatorId:r?.id||"sys",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),participants:e.participants||[],phases:e.phases||[],folderId:e.folderId,color:e.color};n.DB.projects.unshift(t),n.DB.save(),_(e=>e+1)},updateProject:(e,t)=>{let a=n.DB.projects.findIndex(t=>t.id===e);a>=0&&(n.DB.projects[a]={...n.DB.projects[a],...t,updatedAt:new Date().toISOString()},n.DB.save(),_(e=>e+1))},deleteProject:e=>{let t=n.DB.projects.findIndex(t=>t.id===e);t>=0&&(n.DB.projects.splice(t,1),n.DB.save(),_(e=>e+1))},duplicateProject:e=>{let t=n.DB.projects.find(t=>t.id===e);if(t&&u){let e=Date.now(),a={...t,id:`PROJ-${e}`,title:`${t.title} (Copia)`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),status:"PLANNING",phases:t.phases.map((t,a)=>({...t,id:`ph-${e}-${a}`,status:"NOT_STARTED",activities:t.activities.map((t,n)=>({...t,id:`act-${e}-${a}-${n}`,status:"NOT_STARTED",documents:[]}))}))};n.DB.projects.unshift(a),n.DB.save(),_(e=>e+1)}},createProjectFolder:(e,t)=>{if(!u)return;let a={id:`fld-${u}-${Date.now()}`,tenantId:u,name:e,createdAt:new Date().toISOString(),parentId:t};n.DB.projectFolders.push(a),n.DB.save(),_(e=>e+1)},updateProjectFolder:(e,t)=>{let a=n.DB.projectFolders.findIndex(t=>t.id===e);a>=0&&(n.DB.projectFolders[a]={...n.DB.projectFolders[a],...t},n.DB.save(),_(e=>e+1))},deleteProjectFolder:e=>{let t=n.DB.projectFolders.findIndex(t=>t.id===e);t>=0&&(n.DB.projects.forEach(t=>{t.folderId===e&&delete t.folderId}),n.DB.projectFolders.splice(t,1),n.DB.save(),_(e=>e+1))},isSidebarCollapsed:g,toggleSidebar:()=>I(e=>!e),unreadChatCount:f,refreshUnreadCount:v,updatePlatformSettings:e=>{Object.assign(n.DB.platformSettings,e),n.DB.save(),_(e=>e+1)},createRepoFolder:e=>{if(!u)return;let t={id:`RF-${u}-${Date.now()}`,tenantId:u,name:e.name||"Nueva Carpeta",description:e.description,parentId:e.parentId||void 0,level:e.level||1,unit:e.unit||"General",process:e.process,color:e.color||"#3b82f6",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};n.DB.repoFolders.push(t),n.DB.save(),_(e=>e+1)},updateRepoFolder:(e,t)=>{let a=n.DB.repoFolders.findIndex(t=>t.id===e);a>=0&&(n.DB.repoFolders[a]={...n.DB.repoFolders[a],...t,updatedAt:new Date().toISOString()},n.DB.save(),_(e=>e+1))},deleteRepoFolder:e=>{let t=n.DB.repoFolders.findIndex(t=>t.id===e);t>=0&&(n.DB.repoFolders.splice(t,1),n.DB.save(),_(e=>e+1))}},children:s})}function r(){let e=(0,a.useContext)(o);if(void 0===e)throw Error("useApp must be used within an AppProvider");return e}e.s(["AppProvider",()=>s,"useApp",()=>r],73146)},8151,e=>{"use strict";var t=e.i(43476),a=e.i(71645);let n=(0,a.createContext)(void 0);function i({children:e}){let[i,o]=(0,a.useState)(!1),[s,r]=(0,a.useState)(null),[d,l]=(0,a.useState)(null),[c,u]=(0,a.useState)(!1),[m,p]=(0,a.useState)(null);return(0,t.jsx)(n.Provider,{value:{isSlideOpen:i,slideType:s,slideData:d,openSlide:(e,t,a)=>{r(e),l({id:t,title:a}),o(!0)},closeSlide:()=>{o(!1),setTimeout(()=>{r(null),l(null)},300)},isViewerOpen:c,viewerTitle:m,openViewer:e=>{p(e),u(!0)},closeViewer:()=>{u(!1),p(null)}},children:e})}function o(){let e=(0,a.useContext)(n);if(void 0===e)throw Error("useUI must be used within a UIProvider");return e}e.s(["UIProvider",()=>i,"useUI",()=>o])},96923,e=>{"use strict";var t=e.i(43476),a=e.i(73146),n=e.i(8151);function i({children:e}){return(0,t.jsx)(a.AppProvider,{children:(0,t.jsx)(n.UIProvider,{children:e})})}e.s(["Providers",()=>i])},86528,e=>{e.v(t=>Promise.all(["static/chunks/a53b7cf3df4857fa.js"].map(t=>e.l(t))).then(()=>t(98342)))}]);