module.exports=[2689,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(98263),e=a.i(55134),f=a.i(39321),g=a.i(60217);let h=new Map([["bold",c.createElement(c.Fragment,null,c.createElement("path",{d:"M225.81,74.65A11.86,11.86,0,0,1,220.3,76a12,12,0,0,1-10.67-6.47,90.1,90.1,0,0,0-32-35.38,12,12,0,1,1,12.8-20.29,115.25,115.25,0,0,1,40.54,44.62A12,12,0,0,1,225.81,74.65ZM46.37,69.53a90.1,90.1,0,0,1,32-35.38A12,12,0,1,0,65.6,13.86,115.25,115.25,0,0,0,25.06,58.48a12,12,0,0,0,5.13,16.17A11.86,11.86,0,0,0,35.7,76,12,12,0,0,0,46.37,69.53Zm173.51,98.35A20,20,0,0,1,204,200H171.81a44,44,0,0,1-87.62,0H52a20,20,0,0,1-15.91-32.12c7.17-9.33,15.73-26.62,15.88-55.94A76,76,0,0,1,204,112C204.15,141.26,212.71,158.55,219.88,167.88ZM147.6,200H108.4a20,20,0,0,0,39.2,0Zm48.74-24c-8.16-13-16.19-33.57-16.34-63.94A52,52,0,1,0,76,112c-.15,30.42-8.18,51-16.34,64Z"}))],["duotone",c.createElement(c.Fragment,null,c.createElement("path",{d:"M208,192H48a8,8,0,0,1-6.88-12C47.71,168.6,56,147.81,56,112a72,72,0,0,1,144,0c0,35.82,8.3,56.6,14.9,68A8,8,0,0,1,208,192Z",opacity:"0.2"}),c.createElement("path",{d:"M224,71.1a8,8,0,0,1-10.78-3.42,94.13,94.13,0,0,0-33.46-36.91,8,8,0,1,1,8.54-13.54,111.46,111.46,0,0,1,39.12,43.09A8,8,0,0,1,224,71.1ZM35.71,72a8,8,0,0,0,7.1-4.32A94.13,94.13,0,0,1,76.27,30.77a8,8,0,1,0-8.54-13.54A111.46,111.46,0,0,0,28.61,60.32,8,8,0,0,0,35.71,72Zm186.1,103.94A16,16,0,0,1,208,200H167.2a40,40,0,0,1-78.4,0H48a16,16,0,0,1-13.79-24.06C43.22,160.39,48,138.28,48,112a80,80,0,0,1,160,0C208,138.27,212.78,160.38,221.81,175.94ZM150.62,200H105.38a24,24,0,0,0,45.24,0ZM208,184c-10.64-18.27-16-42.49-16-72a64,64,0,0,0-128,0c0,29.52-5.38,53.74-16,72Z"}))],["fill",c.createElement(c.Fragment,null,c.createElement("path",{d:"M224,71.1a8,8,0,0,1-10.78-3.42,94.13,94.13,0,0,0-33.46-36.91,8,8,0,1,1,8.54-13.54,111.46,111.46,0,0,1,39.12,43.09A8,8,0,0,1,224,71.1ZM35.71,72a8,8,0,0,0,7.1-4.32A94.13,94.13,0,0,1,76.27,30.77a8,8,0,1,0-8.54-13.54A111.46,111.46,0,0,0,28.61,60.32,8,8,0,0,0,35.71,72Zm186.1,103.94A16,16,0,0,1,208,200H167.2a40,40,0,0,1-78.4,0H48a16,16,0,0,1-13.79-24.06C43.22,160.39,48,138.28,48,112a80,80,0,0,1,160,0C208,138.27,212.78,160.38,221.81,175.94ZM150.62,200H105.38a24,24,0,0,0,45.24,0Z"}))],["light",c.createElement(c.Fragment,null,c.createElement("path",{d:"M223.05,69.33A6,6,0,0,1,215,66.76,96,96,0,0,0,180.8,29.08a6,6,0,0,1,6.4-10.15,109.26,109.26,0,0,1,38.41,42.31A6,6,0,0,1,223.05,69.33ZM41,66.76A96,96,0,0,1,75.2,29.08a6,6,0,0,0-6.4-10.15A109.26,109.26,0,0,0,30.39,61.24,6,6,0,1,0,41,66.76Zm179,110.18A14,14,0,0,1,208,198h-42.5a38,38,0,0,1-75,0H48a14,14,0,0,1-12.06-21.06C45.13,161.09,50,138.63,50,112a78,78,0,0,1,156,0C206,139,210.74,160.86,220.08,176.94ZM153.29,198H102.71a26,26,0,0,0,50.58,0Zm56.42-15C199.29,165,194,141.15,194,112a66,66,0,0,0-132,0c0,29.16-5.29,53-15.71,71a2,2,0,0,0,0,2,1.9,1.9,0,0,0,1.7,1H208a1.9,1.9,0,0,0,1.7-1A2,2,0,0,0,209.71,183Z"}))],["regular",c.createElement(c.Fragment,null,c.createElement("path",{d:"M224,71.1a8,8,0,0,1-10.78-3.42,94.13,94.13,0,0,0-33.46-36.91,8,8,0,1,1,8.54-13.54,111.46,111.46,0,0,1,39.12,43.09A8,8,0,0,1,224,71.1ZM35.71,72a8,8,0,0,0,7.1-4.32A94.13,94.13,0,0,1,76.27,30.77a8,8,0,1,0-8.54-13.54A111.46,111.46,0,0,0,28.61,60.32,8,8,0,0,0,35.71,72Zm186.1,103.94A16,16,0,0,1,208,200H167.2a40,40,0,0,1-78.4,0H48a16,16,0,0,1-13.79-24.06C43.22,160.39,48,138.28,48,112a80,80,0,0,1,160,0C208,138.27,212.78,160.38,221.81,175.94ZM150.62,200H105.38a24,24,0,0,0,45.24,0ZM208,184c-10.64-18.27-16-42.49-16-72a64,64,0,0,0-128,0c0,29.52-5.38,53.74-16,72Z"}))],["thin",c.createElement(c.Fragment,null,c.createElement("path",{d:"M222.13,67.55a3.94,3.94,0,0,1-1.84.45,4,4,0,0,1-3.55-2.16,99.41,99.41,0,0,0-34.87-38.46,4,4,0,1,1,4.26-6.76,107.34,107.34,0,0,1,37.71,41.54A4,4,0,0,1,222.13,67.55ZM39.26,65.84A99.41,99.41,0,0,1,74.13,27.38a4,4,0,0,0-4.26-6.76A107.34,107.34,0,0,0,32.16,62.16a4,4,0,0,0,1.71,5.39,3.94,3.94,0,0,0,1.84.45A4,4,0,0,0,39.26,65.84ZM218.36,178A12,12,0,0,1,208,196H163.77a36,36,0,0,1-71.54,0H48A12,12,0,0,1,37.64,178C47.17,161.56,52,139.37,52,112a76,76,0,0,1,152,0C204,139.36,208.83,161.55,218.36,178ZM155.71,196H100.29a28,28,0,0,0,55.42,0Zm55.73-14C201.19,164.34,196,140.79,196,112a68,68,0,0,0-136,0c0,28.8-5.19,52.34-15.44,70a4,4,0,0,0,0,4A3.89,3.89,0,0,0,48,188H208a3.89,3.89,0,0,0,3.43-2A4,4,0,0,0,211.44,182Z"}))]]),i=c.forwardRef((a,b)=>c.createElement(g.default,{ref:b,...a,weights:h}));function j({sidebar:a,children:g}){let{currentUser:h,currentTenantId:j}=(0,d.useApp)(),[k,l]=(0,c.useState)([]);return(0,c.useEffect)(()=>{if(!h||!j)return;let a=new Date().toISOString(),b=setInterval(async()=>{let b=new Date().toISOString();try{let c=await e.ChatService.checkNewMessages(h.id,j,a);c.length>0&&l(a=>[...a,...c]),a=b}catch(a){console.error("Poll fail",a)}},8e3);return()=>clearInterval(b)},[h,j]),(0,b.jsxs)("div",{className:"flex h-[calc(100vh-6rem)] bg-white rounded-2xl shadow-sm overflow-hidden border border-gray-100 relative",children:[(0,b.jsx)("aside",{className:"w-80 border-r border-gray-100 bg-gray-50/50 flex flex-col md:flex",children:a}),(0,b.jsx)("main",{className:"flex-1 flex flex-col min-w-0 bg-white relative",children:g}),(0,b.jsx)("div",{className:"absolute top-4 right-4 z-50 flex flex-col gap-2 pointer-events-none",children:k.map(a=>(0,b.jsxs)("div",{className:"pointer-events-auto w-80 bg-white rounded-lg shadow-xl border-l-4 border-blue-500 p-3 animate-in slide-in-from-right-5 fade-in duration-300 flex gap-3 items-start",children:[(0,b.jsx)("div",{className:"bg-blue-50 p-1.5 rounded-full text-blue-500 shrink-0 mt-0.5",children:(0,b.jsx)(i,{size:16,weight:"fill"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("h4",{className:"font-bold text-xs text-gray-800",children:a.senderName||"Nuevo mensaje"}),(0,b.jsx)("p",{className:"text-xs text-gray-500 truncate mt-0.5",children:"text"===a.body_type?a.body:`ðŸ“Ž Archivo adjunto`})]}),(0,b.jsx)("button",{onClick:()=>{var b;return b=a.id,void l(a=>a.filter(a=>a.id!==b))},className:"text-gray-400 hover:text-gray-600",children:(0,b.jsx)(f.X,{size:14})})]},a.id))})]})}i.displayName="BellRingingIcon";var k=a.i(27964),l=a.i(69478);let m=new Map([["bold",c.createElement(c.Fragment,null,c.createElement("path",{d:"M236,128a108,108,0,0,1-216,0c0-42.52,24.73-81.34,63-98.9A12,12,0,1,1,93,50.91C63.24,64.57,44,94.83,44,128a84,84,0,0,0,168,0c0-33.17-19.24-63.43-49-77.09A12,12,0,1,1,173,29.1C211.27,46.66,236,85.48,236,128Z"}))],["duotone",c.createElement(c.Fragment,null,c.createElement("path",{d:"M224,128a96,96,0,1,1-96-96A96,96,0,0,1,224,128Z",opacity:"0.2"}),c.createElement("path",{d:"M232,128a104,104,0,0,1-208,0c0-41,23.81-78.36,60.66-95.27a8,8,0,0,1,6.68,14.54C60.15,61.59,40,93.27,40,128a88,88,0,0,0,176,0c0-34.73-20.15-66.41-51.34-80.73a8,8,0,0,1,6.68-14.54C208.19,49.64,232,87,232,128Z"}))],["fill",c.createElement(c.Fragment,null,c.createElement("path",{d:"M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,176A72,72,0,0,1,92,65.64a8,8,0,0,1,8,13.85,56,56,0,1,0,56,0,8,8,0,0,1,8-13.85A72,72,0,0,1,128,200Z"}))],["light",c.createElement(c.Fragment,null,c.createElement("path",{d:"M230,128a102,102,0,0,1-204,0c0-40.18,23.35-76.86,59.5-93.45a6,6,0,0,1,5,10.9C58.61,60.09,38,92.49,38,128a90,90,0,0,0,180,0c0-35.51-20.61-67.91-52.5-82.55a6,6,0,0,1,5-10.9C206.65,51.14,230,87.82,230,128Z"}))],["regular",c.createElement(c.Fragment,null,c.createElement("path",{d:"M232,128a104,104,0,0,1-208,0c0-41,23.81-78.36,60.66-95.27a8,8,0,0,1,6.68,14.54C60.15,61.59,40,93.27,40,128a88,88,0,0,0,176,0c0-34.73-20.15-66.41-51.34-80.73a8,8,0,0,1,6.68-14.54C208.19,49.64,232,87,232,128Z"}))],["thin",c.createElement(c.Fragment,null,c.createElement("path",{d:"M228,128a100,100,0,0,1-200,0c0-39.4,22.9-75.37,58.33-91.63a4,4,0,1,1,3.34,7.27C57.07,58.6,36,91.71,36,128a92,92,0,0,0,184,0c0-36.29-21.07-69.4-53.67-84.36a4,4,0,1,1,3.34-7.27C205.1,52.63,228,88.6,228,128Z"}))]]),n=c.forwardRef((a,b)=>c.createElement(g.default,{ref:b,...a,weights:m}));n.displayName="CircleNotchIcon";var o=a.i(10158),p=a.i(5710),q=a.i(50944),r=a.i(47384);function s({isOpen:a,onClose:g,onUserSelect:h}){let{currentTenantId:i,currentUser:j}=(0,d.useApp)(),[l,m]=(0,c.useState)(""),[o,p]=(0,c.useState)([]),[q,s]=(0,c.useState)(!1);(0,c.useEffect)(()=>{a?t(""):(m(""),p([]))},[a]);let t=async a=>{if(i){s(!0);try{let b=await e.ChatService.searchUsers(i,a);p(b.filter(a=>a.id!==j?.id))}finally{s(!1)}}};return a?(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm animate-in fade-in duration-200",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md overflow-hidden flex flex-col max-h-[80vh]",children:[(0,b.jsxs)("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50/50",children:[(0,b.jsx)("h3",{className:"font-bold text-gray-800 text-lg",children:"Nueva ConversaciÃ³n"}),(0,b.jsx)("button",{onClick:g,className:"p-2 hover:bg-gray-200 rounded-full transition-colors text-gray-500",children:(0,b.jsx)(f.X,{size:20})})]}),(0,b.jsx)("div",{className:"p-4 border-b border-gray-100",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(k.MagnifyingGlass,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),(0,b.jsx)("input",{type:"text",className:"w-full pl-10 pr-4 py-3 bg-gray-50 border border-transparent rounded-xl focus:bg-white focus:border-blue-500 focus:ring-4 focus:ring-blue-500/10 transition-all outline-none text-sm font-medium",placeholder:"Buscar personas...",value:l,onChange:a=>{let b=a.target.value;m(b),t(b)},autoFocus:!0})]})}),(0,b.jsxs)("div",{className:"flex-1 overflow-y-auto p-2 space-y-1 custom-scrollbar",children:[q&&(0,b.jsx)("div",{className:"flex justify-center py-8",children:(0,b.jsx)(n,{size:24,className:"animate-spin text-blue-500"})}),!q&&0===o.length&&(0,b.jsx)("div",{className:"text-center py-8 text-gray-400",children:(0,b.jsx)("p",{className:"text-sm",children:"No se encontraron usuarios"})}),!q&&o.map(a=>(0,b.jsxs)("button",{onClick:()=>h(a.id),className:"w-full flex items-center gap-3 p-3 hover:bg-blue-50 rounded-xl transition-colors group text-left",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-100 to-indigo-100 text-blue-600 flex items-center justify-center font-bold text-sm border border-white shadow-sm",children:a.initials}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h4",{className:"text-sm font-semibold text-gray-900 group-hover:text-blue-700",children:a.name}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:[a.role," â€¢ ",a.unit]})]}),(0,b.jsx)(r.UserPlus,{size:18,className:"text-gray-300 group-hover:text-blue-500 transition-colors"})]},a.id))]})]})}):null}var t=a.i(71174);function u({isOpen:a,onClose:g,onGroupCreate:h}){let{currentTenantId:i,currentUser:j}=(0,d.useApp)(),[l,m]=(0,c.useState)(""),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)([]),[s,u]=(0,c.useState)([]),[v,w]=(0,c.useState)(!1);(0,c.useEffect)(()=>{a?x(""):(p(""),r([]),u([]),m(""))},[a]);let x=async a=>{if(i){w(!0);try{let b=await e.ChatService.searchUsers(i,a);r(b.filter(a=>a.id!==j?.id))}finally{w(!1)}}},y=a=>{s.find(b=>b.id===a.id)?u(b=>b.filter(b=>b.id!==a.id)):u(b=>[...b,a])};return a?(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm animate-in fade-in duration-200",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md overflow-hidden flex flex-col max-h-[85vh]",children:[(0,b.jsxs)("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50/50",children:[(0,b.jsx)("h3",{className:"font-bold text-gray-800 text-lg",children:"Nuevo Grupo"}),(0,b.jsx)("button",{onClick:g,className:"p-2 hover:bg-gray-200 rounded-full transition-colors text-gray-500",children:(0,b.jsx)(f.X,{size:20})})]}),(0,b.jsxs)("div",{className:"p-4 space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Nombre del Grupo"}),(0,b.jsx)("input",{type:"text",className:"w-full px-4 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:bg-white focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/10 transition-all outline-none",placeholder:"Ej. Proyecto Alpha",value:l,onChange:a=>m(a.target.value)})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(k.MagnifyingGlass,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),(0,b.jsx)("input",{type:"text",className:"w-full pl-10 pr-4 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:bg-white focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/10 transition-all outline-none text-sm",placeholder:"Buscar integrantes...",value:o,onChange:a=>{let b=a.target.value;p(b),x(b)}})]}),s.length>0&&(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:s.map(a=>(0,b.jsxs)("div",{className:"bg-indigo-50 text-indigo-700 px-2 py-1 rounded-full text-xs font-medium flex items-center gap-1 border border-indigo-100",children:[a.name,(0,b.jsx)("button",{onClick:()=>y(a),className:"hover:text-indigo-900",children:(0,b.jsx)(f.X,{size:12})})]},a.id))})]}),(0,b.jsxs)("div",{className:"flex-1 overflow-y-auto p-2 border-t border-gray-100 space-y-1 custom-scrollbar",children:[v&&(0,b.jsx)("div",{className:"flex justify-center py-4",children:(0,b.jsx)(n,{size:24,className:"animate-spin text-indigo-500"})}),!v&&q.map(a=>{let c=!!s.find(b=>b.id===a.id);return(0,b.jsxs)("button",{onClick:()=>y(a),className:`w-full flex items-center gap-3 p-2 rounded-lg transition-colors group text-left
                                    ${c?"bg-indigo-50/50":"hover:bg-gray-50"}
                                `,children:[(0,b.jsx)("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs shadow-sm transition-colors
                                    ${c?"bg-indigo-500 text-white":"bg-gray-100 text-gray-500"}
                                `,children:c?(0,b.jsx)(t.Check,{size:14,weight:"bold"}):a.initials}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h4",{className:`text-sm font-semibold ${c?"text-indigo-900":"text-gray-900"}`,children:a.name}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:a.role})]})]},a.id)})]}),(0,b.jsx)("div",{className:"p-4 border-t border-gray-100 bg-gray-50/50 flex justify-end",children:(0,b.jsxs)("button",{disabled:!l.trim()||0===s.length,onClick:()=>{l.trim()&&0!==s.length&&h(l,s.map(a=>a.id))},className:`px-4 py-2 rounded-lg font-medium text-sm transition-all shadow-sm
                            ${!l.trim()||0===s.length?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-indigo-600 text-white hover:bg-indigo-700 hover:shadow-md active:scale-95"}
                        `,children:["Crear Grupo (",s.length,")"]})})]})}):null}function v(){let{currentTenantId:a,currentUser:f,refreshUnreadCount:g}=(0,d.useApp)(),[h,i]=(0,c.useState)([]),[j,m]=(0,c.useState)(!0),[r,t]=(0,c.useState)(""),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)(0),B=(0,q.useRouter)(),C=(0,q.useSearchParams)(),D=C.get("chatId"),E=(0,c.useCallback)(async()=>{if(f&&a){m(!0);try{let b=(await e.ChatService.getConversations(f.id,a)).data.map(a=>a.id===D?{...a,unreadCount:0}:a);i(b)}catch(a){console.error(a)}finally{m(!1)}}},[f,a,z]);(0,c.useEffect)(()=>{E();let b=setInterval(()=>{e.ChatService.getConversations(f.id,a).then(a=>{i(b=>a.data.map(a=>a.id===D?{...a,unreadCount:0}:a))})},5e3);return()=>clearInterval(b)},[E,f,a]);let F=async b=>{if(a&&f){w(!1);try{let c=await e.ChatService.createDM(f.id,b,a),d=c.data?.id;if(!d)throw Error("Failed to create chat");await E();let g=new URLSearchParams(C);g.set("chatId",d),B.push(`/dashboard/chat?${g.toString()}`)}catch(a){console.error(a),alert("Error creating chat")}}},G=async(b,c)=>{if(a&&f){y(!1);try{let d=await e.ChatService.createGroup(f.id,a,b,c),g=d.data?.id;if(!g)throw Error("Failed to create group");await E();let h=new URLSearchParams(C);h.set("chatId",g),B.push(`/dashboard/chat?${h.toString()}`)}catch(a){console.error(a)}}},[H,I]=(0,c.useState)(null),[J,K]=(0,c.useState)(!1);(0,c.useEffect)(()=>{let b=setTimeout(async()=>{if(!r.trim())return void I(null);if(f&&a){K(!0);try{let b=await e.ChatService.searchConversations(f.id,a,r);I(b)}catch(a){console.error(a)}finally{K(!1)}}},500);return()=>clearTimeout(b)},[r,f,a]);let L=null!==H?H:h;return(0,b.jsxs)("div",{className:"flex flex-col h-full bg-white border-r border-gray-100",children:[(0,b.jsxs)("div",{className:"p-4 border-b border-gray-100 bg-white/50 backdrop-blur-sm sticky top-0 z-10",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-800 tracking-tight",children:"Mensajes"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{onClick:()=>y(!0),className:"p-1.5 bg-indigo-50 text-indigo-600 rounded-lg hover:bg-indigo-100 transition-colors",title:"Nuevo Grupo",children:(0,b.jsx)(p.UsersThree,{weight:"bold",size:18})}),(0,b.jsx)("button",{onClick:()=>w(!0),className:"p-1.5 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors",title:"Nuevo Chat",children:(0,b.jsx)(o.Plus,{weight:"bold",size:18})}),j||J?(0,b.jsx)(n,{className:"animate-spin text-blue-500",size:20}):null]})]}),(0,b.jsxs)("div",{className:"relative group",children:[(0,b.jsx)(k.MagnifyingGlass,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 group-focus-within:text-blue-500 transition-colors",size:16}),(0,b.jsx)("input",{type:"text",placeholder:"Buscar...",className:"w-full pl-9 pr-4 py-2.5 bg-gray-50 border border-transparent rounded-xl text-sm focus:bg-white focus:border-blue-100 focus:ring-4 focus:ring-blue-500/10 transition-all outline-none placeholder-gray-400 font-medium",value:r,onChange:a=>t(a.target.value)})]})]}),(0,b.jsxs)("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-2 space-y-1",children:[L.map(a=>(0,b.jsxs)("button",{onClick:()=>{let b;(b=new URLSearchParams(C)).set("chatId",a.id),B.push(`/dashboard/chat?${b.toString()}`),i(b=>b.map(b=>b.id===a.id?{...b,unreadCount:0}:b)),g()},className:`w-full text-left p-3 rounded-xl transition-all duration-200 flex items-start gap-3 group relative
                            ${D===a.id?"bg-blue-50/50 shadow-sm ring-1 ring-blue-100":"hover:bg-gray-50"}
                        `,children:[(0,b.jsx)("div",{className:`w-12 h-12 rounded-full flex items-center justify-center shrink-0 border-2 border-white shadow-sm ring-1 ring-black/5
                            ${"group"===a.type?"bg-indigo-100 text-indigo-600":"bg-gradient-to-br from-pink-100 to-rose-100 text-rose-600"}`,children:"group"===a.type?(0,b.jsx)(l.Users,{weight:"bold",size:20}):(0,b.jsx)("span",{className:"text-sm font-bold",children:a.avatar})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0 py-0.5",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-0.5",children:[(0,b.jsx)("h4",{className:`text-sm font-bold truncate ${D===a.id?"text-gray-900":"text-gray-700"}`,children:a.title}),(0,b.jsx)("span",{className:`text-[10px] font-medium ${a.unreadCount&&a.unreadCount>0?"text-blue-600":"text-gray-400"}`,children:(a=>{if(!a)return"";let b=new Date(a),c=Math.floor((new Date().getTime()-b.getTime())/864e5);return 0===c?b.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):1===c?"Ayer":c<7?b.toLocaleDateString([],{weekday:"short"}):b.toLocaleDateString([],{month:"short",day:"numeric"})})(a.last_message_at)})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsxs)("p",{className:`text-xs truncate max-w-[85%] ${a.unreadCount&&a.unreadCount>0?"text-gray-900 font-medium":"text-gray-500"}`,children:["dm"===a.type&&D!==a.id?"Tu: ":"",a.lastMessagePreview]}),void 0!=a.unreadCount&&a.unreadCount>0&&(0,b.jsx)("span",{className:"min-w-[18px] h-[18px] px-1 rounded-full bg-blue-600 text-white text-[10px] font-bold flex items-center justify-center shadow-sm shadow-blue-200",children:a.unreadCount})]})]})]},a.id)),!j&&!J&&0===L.length&&(0,b.jsx)("div",{className:"text-center py-10 opacity-50",children:(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"No se encontraron conversaciones"})})]}),(0,b.jsx)(s,{isOpen:v,onClose:()=>w(!1),onUserSelect:F}),(0,b.jsx)(u,{isOpen:x,onClose:()=>y(!1),onGroupCreate:G})]})}var w=a.i(82665),x=a.i(89184),y=a.i(72129),z=a.i(30112);let A=new Map([["bold",c.createElement(c.Fragment,null,c.createElement("path",{d:"M224,154.8l-47.09-21.11-.18-.08a19.94,19.94,0,0,0-19,1.75,13.08,13.08,0,0,0-1.12.84l-22.31,19c-13-7.05-26.43-20.37-33.49-33.21l19.06-22.66a11.76,11.76,0,0,0,.85-1.15,20,20,0,0,0,1.66-18.83,1.42,1.42,0,0,1-.08-.18L101.2,32A20.06,20.06,0,0,0,80.42,20.15,60.27,60.27,0,0,0,28,80c0,81.61,66.39,148,148,148a60.27,60.27,0,0,0,59.85-52.42A20.06,20.06,0,0,0,224,154.8ZM176,204A124.15,124.15,0,0,1,52,80,36.29,36.29,0,0,1,80.48,44.46l18.82,42L80.14,109.28a12,12,0,0,0-.86,1.16A20,20,0,0,0,78,130.08c9.42,19.28,28.83,38.56,48.31,48A20,20,0,0,0,146,176.63a11.63,11.63,0,0,0,1.11-.85l22.43-19.07,42,18.81A36.29,36.29,0,0,1,176,204Z"}))],["duotone",c.createElement(c.Fragment,null,c.createElement("path",{d:"M223.94,174.08A48.33,48.33,0,0,1,176,216,136,136,0,0,1,40,80,48.33,48.33,0,0,1,81.92,32.06a8,8,0,0,1,8.3,4.8l21.13,47.2a8,8,0,0,1-.66,7.53L89.32,117a7.93,7.93,0,0,0-.54,7.81c8.27,16.93,25.77,34.22,42.75,42.41a7.92,7.92,0,0,0,7.83-.59l25-21.3a8,8,0,0,1,7.59-.69l47.16,21.13A8,8,0,0,1,223.94,174.08Z",opacity:"0.2"}),c.createElement("path",{d:"M222.37,158.46l-47.11-21.11-.13-.06a16,16,0,0,0-15.17,1.4,8.12,8.12,0,0,0-.75.56L134.87,160c-15.42-7.49-31.34-23.29-38.83-38.51l20.78-24.71c.2-.25.39-.5.57-.77a16,16,0,0,0,1.32-15.06l0-.12L97.54,33.64a16,16,0,0,0-16.62-9.52A56.26,56.26,0,0,0,32,80c0,79.4,64.6,144,144,144a56.26,56.26,0,0,0,55.88-48.92A16,16,0,0,0,222.37,158.46ZM176,208A128.14,128.14,0,0,1,48,80,40.2,40.2,0,0,1,82.87,40a.61.61,0,0,0,0,.12l21,47L83.2,111.86a6.13,6.13,0,0,0-.57.77,16,16,0,0,0-1,15.7c9.06,18.53,27.73,37.06,46.46,46.11a16,16,0,0,0,15.75-1.14,8.44,8.44,0,0,0,.74-.56L168.89,152l47,21.05h0s.08,0,.11,0A40.21,40.21,0,0,1,176,208Z"}))],["fill",c.createElement(c.Fragment,null,c.createElement("path",{d:"M231.88,175.08A56.26,56.26,0,0,1,176,224C96.6,224,32,159.4,32,80A56.26,56.26,0,0,1,80.92,24.12a16,16,0,0,1,16.62,9.52l21.12,47.15,0,.12A16,16,0,0,1,117.39,96c-.18.27-.37.52-.57.77L96,121.45c7.49,15.22,23.41,31,38.83,38.51l24.34-20.71a8.12,8.12,0,0,1,.75-.56,16,16,0,0,1,15.17-1.4l.13.06,47.11,21.11A16,16,0,0,1,231.88,175.08Z"}))],["light",c.createElement(c.Fragment,null,c.createElement("path",{d:"M221.59,160.3l-47.24-21.17a14,14,0,0,0-13.28,1.22,4.81,4.81,0,0,0-.56.42l-24.69,21a1.88,1.88,0,0,1-1.68.06c-15.87-7.66-32.31-24-40-39.65a1.91,1.91,0,0,1,0-1.68l21.07-25a6.13,6.13,0,0,0,.42-.58,14,14,0,0,0,1.12-13.27L95.73,34.49a14,14,0,0,0-14.56-8.38A54.24,54.24,0,0,0,34,80c0,78.3,63.7,142,142,142a54.25,54.25,0,0,0,53.89-47.17A14,14,0,0,0,221.59,160.3ZM176,210C104.32,210,46,151.68,46,80A42.23,42.23,0,0,1,82.67,38h.23a2,2,0,0,1,1.84,1.31l21.1,47.11a2,2,0,0,1,0,1.67L84.73,113.15a4.73,4.73,0,0,0-.43.57,14,14,0,0,0-.91,13.73c8.87,18.16,27.17,36.32,45.53,45.19a14,14,0,0,0,13.77-1c.19-.13.38-.27.56-.42l24.68-21a1.92,1.92,0,0,1,1.6-.1l47.25,21.17a2,2,0,0,1,1.21,2A42.24,42.24,0,0,1,176,210Z"}))],["regular",c.createElement(c.Fragment,null,c.createElement("path",{d:"M222.37,158.46l-47.11-21.11-.13-.06a16,16,0,0,0-15.17,1.4,8.12,8.12,0,0,0-.75.56L134.87,160c-15.42-7.49-31.34-23.29-38.83-38.51l20.78-24.71c.2-.25.39-.5.57-.77a16,16,0,0,0,1.32-15.06l0-.12L97.54,33.64a16,16,0,0,0-16.62-9.52A56.26,56.26,0,0,0,32,80c0,79.4,64.6,144,144,144a56.26,56.26,0,0,0,55.88-48.92A16,16,0,0,0,222.37,158.46ZM176,208A128.14,128.14,0,0,1,48,80,40.2,40.2,0,0,1,82.87,40a.61.61,0,0,0,0,.12l21,47L83.2,111.86a6.13,6.13,0,0,0-.57.77,16,16,0,0,0-1,15.7c9.06,18.53,27.73,37.06,46.46,46.11a16,16,0,0,0,15.75-1.14,8.44,8.44,0,0,0,.74-.56L168.89,152l47,21.05h0s.08,0,.11,0A40.21,40.21,0,0,1,176,208Z"}))],["thin",c.createElement(c.Fragment,null,c.createElement("path",{d:"M220.78,162.13,173.56,141A12,12,0,0,0,162.18,142a3.37,3.37,0,0,0-.38.28L137,163.42a3.93,3.93,0,0,1-3.7.21c-16.24-7.84-33.05-24.52-40.89-40.57a3.9,3.9,0,0,1,.18-3.69l21.2-25.21c.1-.12.19-.25.28-.38a12,12,0,0,0,1-11.36L93.9,35.28a12,12,0,0,0-12.48-7.19A52.25,52.25,0,0,0,36,80c0,77.2,62.8,140,140,140a52.25,52.25,0,0,0,51.91-45.42A12,12,0,0,0,220.78,162.13ZM220,173.58A44.23,44.23,0,0,1,176,212C103.22,212,44,152.78,44,80A44.23,44.23,0,0,1,82.42,36a3.87,3.87,0,0,1,.48,0,4,4,0,0,1,3.67,2.49l21.11,47.14a4,4,0,0,1-.23,3.6l-21.19,25.2c-.1.13-.2.25-.29.39a12,12,0,0,0-.78,11.75c8.69,17.79,26.61,35.58,44.6,44.27a12,12,0,0,0,11.79-.87l.37-.28,24.83-21.12a3.93,3.93,0,0,1,3.57-.27l47.21,21.16A4,4,0,0,1,220,173.58Z"}))]]),B=c.forwardRef((a,b)=>c.createElement(g.default,{ref:b,...a,weights:A}));B.displayName="PhoneIcon";let C=new Map([["bold",c.createElement(c.Fragment,null,c.createElement("path",{d:"M249.45,69.31a12,12,0,0,0-12.51,1L212,88.43V72a20,20,0,0,0-20-20H32A20,20,0,0,0,12,72V184a20,20,0,0,0,20,20H192a20,20,0,0,0,20-20V167.57l24.94,18.14A12,12,0,0,0,256,176V80A12,12,0,0,0,249.45,69.31ZM188,180H36V76H188Zm44-27.57-20-14.54V118.11l20-14.54Z"}))],["duotone",c.createElement(c.Fragment,null,c.createElement("path",{d:"M200,72V184a8,8,0,0,1-8,8H32a8,8,0,0,1-8-8V72a8,8,0,0,1,8-8H192A8,8,0,0,1,200,72Z",opacity:"0.2"}),c.createElement("path",{d:"M251.77,73a8,8,0,0,0-8.21.39L208,97.05V72a16,16,0,0,0-16-16H32A16,16,0,0,0,16,72V184a16,16,0,0,0,16,16H192a16,16,0,0,0,16-16V159l35.56,23.71A8,8,0,0,0,248,184a8,8,0,0,0,8-8V80A8,8,0,0,0,251.77,73ZM192,184H32V72H192V184Zm48-22.95-32-21.33V116.28L240,95Z"}))],["fill",c.createElement(c.Fragment,null,c.createElement("path",{d:"M192,72V184a16,16,0,0,1-16,16H32a16,16,0,0,1-16-16V72A16,16,0,0,1,32,56H176A16,16,0,0,1,192,72Zm58,.25a8.23,8.23,0,0,0-6.63,1.22L209.78,95.86A4,4,0,0,0,208,99.19v57.62a4,4,0,0,0,1.78,3.33l33.78,22.52a8,8,0,0,0,8.58.19,8.33,8.33,0,0,0,3.86-7.17V80A8,8,0,0,0,250,72.25Z"}))],["light",c.createElement(c.Fragment,null,c.createElement("path",{d:"M250.83,74.71a6,6,0,0,0-6.16.3L206,100.79V72a14,14,0,0,0-14-14H32A14,14,0,0,0,18,72V184a14,14,0,0,0,14,14H192a14,14,0,0,0,14-14V155.21L244.67,181a6,6,0,0,0,9.33-5V80A6,6,0,0,0,250.83,74.71ZM194,184a2,2,0,0,1-2,2H32a2,2,0,0,1-2-2V72a2,2,0,0,1,2-2H192a2,2,0,0,1,2,2Zm48-19.21-36-24V115.21l36-24Z"}))],["regular",c.createElement(c.Fragment,null,c.createElement("path",{d:"M251.77,73a8,8,0,0,0-8.21.39L208,97.05V72a16,16,0,0,0-16-16H32A16,16,0,0,0,16,72V184a16,16,0,0,0,16,16H192a16,16,0,0,0,16-16V159l35.56,23.71A8,8,0,0,0,248,184a8,8,0,0,0,8-8V80A8,8,0,0,0,251.77,73ZM192,184H32V72H192V184Zm48-22.95-32-21.33V116.28L240,95Z"}))],["thin",c.createElement(c.Fragment,null,c.createElement("path",{d:"M249.89,76.47a4,4,0,0,0-4.11.2L204,104.53V72a12,12,0,0,0-12-12H32A12,12,0,0,0,20,72V184a12,12,0,0,0,12,12H192a12,12,0,0,0,12-12V151.47l41.78,27.86A4,4,0,0,0,252,176V80A4,4,0,0,0,249.89,76.47ZM196,184a4,4,0,0,1-4,4H32a4,4,0,0,1-4-4V72a4,4,0,0,1,4-4H192a4,4,0,0,1,4,4Zm48-15.47-40-26.67V114.14l40-26.67Z"}))]]),D=c.forwardRef((a,b)=>c.createElement(g.default,{ref:b,...a,weights:C}));D.displayName="VideoCameraIcon";var E=a.i(1739);let F=new Map([["bold",c.createElement(c.Fragment,null,c.createElement("path",{d:"M152.41,88.56l-89.6,88a12,12,0,0,1-16.82,0L7.59,138.85a12,12,0,0,1,16.82-17.13l30,29.46,81.19-79.74a12,12,0,0,1,16.82,17.12Zm96.15-17a12,12,0,0,0-17-.15L150.4,151.18l-7.88-7.74a12,12,0,0,0-16.82,17.12l16.29,16a12,12,0,0,0,16.82,0l89.6-88A12,12,0,0,0,248.56,71.59Z"}))],["duotone",c.createElement(c.Fragment,null,c.createElement("path",{d:"M240,64V192a16,16,0,0,1-16,16H32a16,16,0,0,1-16-16V64A16,16,0,0,1,32,48H224A16,16,0,0,1,240,64Z",opacity:"0.2"}),c.createElement("path",{d:"M149.61,85.71l-89.6,88a8,8,0,0,1-11.22,0L10.39,136a8,8,0,1,1,11.22-11.41L54.4,156.79l84-82.5a8,8,0,1,1,11.22,11.42Zm96.1-11.32a8,8,0,0,0-11.32-.1l-84,82.5-18.83-18.5a8,8,0,0,0-11.21,11.42l24.43,24a8,8,0,0,0,11.22,0l89.6-88A8,8,0,0,0,245.71,74.39Z"}))],["fill",c.createElement(c.Fragment,null,c.createElement("path",{d:"M224,48H32A16,16,0,0,0,16,64V192a16,16,0,0,0,16,16H224a16,16,0,0,0,16-16V64A16,16,0,0,0,224,48ZM72,168a8,8,0,0,1-5.66-2.34l-24-24a8,8,0,0,1,11.32-11.32L72,148.69l58.34-58.35a8,8,0,0,1,11.32,11.32l-64,64A8,8,0,0,1,72,168Zm141.66-66.34-64,64a8,8,0,0,1-11.32,0l-16-16a8,8,0,0,1,11.32-11.32L144,148.69l58.34-58.35a8,8,0,0,1,11.32,11.32Z"}))],["light",c.createElement(c.Fragment,null,c.createElement("path",{d:"M148.2,84.28l-89.6,88a6,6,0,0,1-8.4,0L11.8,134.57A6,6,0,1,1,20.2,126l34.2,33.58,85.4-83.87a6,6,0,1,1,8.4,8.56Zm96.08-8.48a6,6,0,0,0-8.48-.08l-85.4,83.87-20.23-19.87a6,6,0,1,0-8.41,8.56l24.44,24a6,6,0,0,0,8.4,0l89.6-88A6,6,0,0,0,244.28,75.8Z"}))],["regular",c.createElement(c.Fragment,null,c.createElement("path",{d:"M149.61,85.71l-89.6,88a8,8,0,0,1-11.22,0L10.39,136a8,8,0,1,1,11.22-11.41L54.4,156.79l84-82.5a8,8,0,1,1,11.22,11.42Zm96.1-11.32a8,8,0,0,0-11.32-.1l-84,82.5-18.83-18.5a8,8,0,0,0-11.21,11.42l24.43,24a8,8,0,0,0,11.22,0l89.6-88A8,8,0,0,0,245.71,74.39Z"}))],["thin",c.createElement(c.Fragment,null,c.createElement("path",{d:"M146.8,82.85l-89.6,88a4,4,0,0,1-5.6,0L13.2,133.14a4,4,0,0,1,5.6-5.71l35.6,35,86.8-85.24a4,4,0,0,1,5.6,5.7Zm96-5.65a4,4,0,0,0-5.65,0l-86.8,85.24-21.63-21.24a4,4,0,1,0-5.61,5.7l24.44,24a4,4,0,0,0,5.6,0l89.6-88A4,4,0,0,0,242.85,77.2Z"}))]]),G=c.forwardRef((a,b)=>c.createElement(g.default,{ref:b,...a,weights:F}));G.displayName="ChecksIcon";let H=new Map([["bold",c.createElement(c.Fragment,null,c.createElement("path",{d:"M208.49,152.49l-72,72a12,12,0,0,1-17,0l-72-72a12,12,0,0,1,17-17L116,187V40a12,12,0,0,1,24,0V187l51.51-51.52a12,12,0,0,1,17,17Z"}))],["duotone",c.createElement(c.Fragment,null,c.createElement("path",{d:"M200,144l-72,72L56,144Z",opacity:"0.2"}),c.createElement("path",{d:"M207.39,140.94A8,8,0,0,0,200,136H136V40a8,8,0,0,0-16,0v96H56a8,8,0,0,0-5.66,13.66l72,72a8,8,0,0,0,11.32,0l72-72A8,8,0,0,0,207.39,140.94ZM128,204.69,75.31,152H180.69Z"}))],["fill",c.createElement(c.Fragment,null,c.createElement("path",{d:"M205.66,149.66l-72,72a8,8,0,0,1-11.32,0l-72-72A8,8,0,0,1,56,136h64V40a8,8,0,0,1,16,0v96h64a8,8,0,0,1,5.66,13.66Z"}))],["light",c.createElement(c.Fragment,null,c.createElement("path",{d:"M204.24,148.24l-72,72a6,6,0,0,1-8.48,0l-72-72a6,6,0,0,1,8.48-8.48L122,201.51V40a6,6,0,0,1,12,0V201.51l61.76-61.75a6,6,0,0,1,8.48,8.48Z"}))],["regular",c.createElement(c.Fragment,null,c.createElement("path",{d:"M205.66,149.66l-72,72a8,8,0,0,1-11.32,0l-72-72a8,8,0,0,1,11.32-11.32L120,196.69V40a8,8,0,0,1,16,0V196.69l58.34-58.35a8,8,0,0,1,11.32,11.32Z"}))],["thin",c.createElement(c.Fragment,null,c.createElement("path",{d:"M202.83,146.83l-72,72a4,4,0,0,1-5.66,0l-72-72a4,4,0,0,1,5.66-5.66L124,206.34V40a4,4,0,0,1,8,0V206.34l65.17-65.17a4,4,0,0,1,5.66,5.66Z"}))]]),I=c.forwardRef((a,b)=>c.createElement(g.default,{ref:b,...a,weights:H}));I.displayName="ArrowDownIcon";let J=new Map([["bold",c.createElement(c.Fragment,null,c.createElement("path",{d:"M112,60a16,16,0,1,1,16,16A16,16,0,0,1,112,60Zm16,52a16,16,0,1,0,16,16A16,16,0,0,0,128,112Zm0,68a16,16,0,1,0,16,16A16,16,0,0,0,128,180Z"}))],["duotone",c.createElement(c.Fragment,null,c.createElement("path",{d:"M176,32V224a16,16,0,0,1-16,16H96a16,16,0,0,1-16-16V32A16,16,0,0,1,96,16h64A16,16,0,0,1,176,32Z",opacity:"0.2"}),c.createElement("path",{d:"M140,128a12,12,0,1,1-12-12A12,12,0,0,1,140,128ZM128,72a12,12,0,1,0-12-12A12,12,0,0,0,128,72Zm0,112a12,12,0,1,0,12,12A12,12,0,0,0,128,184Z"}))],["fill",c.createElement(c.Fragment,null,c.createElement("path",{d:"M160,16H96A16,16,0,0,0,80,32V224a16,16,0,0,0,16,16h64a16,16,0,0,0,16-16V32A16,16,0,0,0,160,16ZM128,208a12,12,0,1,1,12-12A12,12,0,0,1,128,208Zm0-68a12,12,0,1,1,12-12A12,12,0,0,1,128,140Zm0-68a12,12,0,1,1,12-12A12,12,0,0,1,128,72Z"}))],["light",c.createElement(c.Fragment,null,c.createElement("path",{d:"M118,60a10,10,0,1,1,10,10A10,10,0,0,1,118,60Zm10,58a10,10,0,1,0,10,10A10,10,0,0,0,128,118Zm0,68a10,10,0,1,0,10,10A10,10,0,0,0,128,186Z"}))],["regular",c.createElement(c.Fragment,null,c.createElement("path",{d:"M140,128a12,12,0,1,1-12-12A12,12,0,0,1,140,128ZM128,72a12,12,0,1,0-12-12A12,12,0,0,0,128,72Zm0,112a12,12,0,1,0,12,12A12,12,0,0,0,128,184Z"}))],["thin",c.createElement(c.Fragment,null,c.createElement("path",{d:"M120,60a8,8,0,1,1,8,8A8,8,0,0,1,120,60Zm8,60a8,8,0,1,0,8,8A8,8,0,0,0,128,120Zm0,68a8,8,0,1,0,8,8A8,8,0,0,0,128,188Z"}))]]),K=c.forwardRef((a,b)=>c.createElement(g.default,{ref:b,...a,weights:J}));K.displayName="DotsThreeVerticalIcon";var L=a.i(39577),M=a.i(33686);let N=new Map([["bold",c.createElement(c.Fragment,null,c.createElement("path",{d:"M216.88,207.93l-160-176A12,12,0,1,0,39.12,48.07l14.8,16.29A83.58,83.58,0,0,0,44,104c0,25.58-4.59,47-13.27,61.93A20.08,20.08,0,0,0,30.68,186,19.75,19.75,0,0,0,48,196H84.19a44,44,0,0,0,87.62,0h1.79l25.52,28.07a12,12,0,0,0,17.76-16.14ZM68,104a59.84,59.84,0,0,1,3.52-20.29L151.78,172H54.68C63.52,154,68,131.14,68,104Zm60,108a20,20,0,0,1-19.6-16h39.2A20,20,0,0,1,128,212ZM88.89,42.35a12,12,0,0,1,6.37-15.73A84,84,0,0,1,212,104c0,18.68,2.38,34.93,7.07,48.28a12,12,0,1,1-22.64,8C190.83,144.32,188,125.4,188,104a60,60,0,0,0-83.38-55.28A12,12,0,0,1,88.89,42.35Z"}))],["duotone",c.createElement(c.Fragment,null,c.createElement("path",{d:"M208,192H48a8,8,0,0,1-6.88-12C47.71,168.6,56,139.81,56,104a72,72,0,0,1,144,0c0,35.82,8.3,64.6,14.9,76A8,8,0,0,1,208,192Z",opacity:"0.2"}),c.createElement("path",{d:"M53.92,34.62A8,8,0,1,0,42.08,45.38L58.82,63.8A79.59,79.59,0,0,0,48,104c0,35.34-8.26,62.38-13.81,71.94A16,16,0,0,0,48,200H88.8a40,40,0,0,0,78.4,0h15.44l19.44,21.38a8,8,0,1,0,11.84-10.76ZM128,216a24,24,0,0,1-22.62-16h45.24A24,24,0,0,1,128,216ZM48,184c7.7-13.24,16-43.92,16-80a63.65,63.65,0,0,1,6.26-27.62L168.09,184Zm166-4.73a8.13,8.13,0,0,1-2.93.55,8,8,0,0,1-7.44-5.08C196.35,156.19,192,129.75,192,104A64,64,0,0,0,96.43,48.31a8,8,0,0,1-7.9-13.91A80,80,0,0,1,208,104c0,35.35,8.05,58.59,10.52,64.88A8,8,0,0,1,214,179.25Z"}))],["fill",c.createElement(c.Fragment,null,c.createElement("path",{d:"M221.84,192v0a1.85,1.85,0,0,1-3,.28L83.27,43.19a4,4,0,0,1,.8-6A79.55,79.55,0,0,1,129.17,24C173,24.66,207.8,61.1,208,104.92c.14,34.88,8.31,61.54,13.82,71A15.89,15.89,0,0,1,221.84,192Zm-7.92,18.62a8,8,0,0,1-11.85,10.76L182.62,200H167.16a40,40,0,0,1-78.41,0H47.91a15.78,15.78,0,0,1-13.59-7.59,16.42,16.42,0,0,1-.09-16.68c5.55-9.73,13.7-36.64,13.7-71.73A79.42,79.42,0,0,1,58.79,63.85L42,45.38A8,8,0,1,1,53.84,34.62ZM150.59,200H105.32a24,24,0,0,0,45.27,0Z"}))],["light",c.createElement(c.Fragment,null,c.createElement("path",{d:"M52.44,36A6,6,0,0,0,43.56,44L61.31,63.56A77.45,77.45,0,0,0,50,104c0,35.74-8.42,63.2-14.08,72.94A14,14,0,0,0,48,198h42.5a38,38,0,0,0,75,0h18l20,22a6,6,0,0,0,8.88-8.08ZM128,218a26,26,0,0,1-25.29-20h50.58A26,26,0,0,1,128,218ZM48,186a1.9,1.9,0,0,1-1.7-1,2,2,0,0,1,0-2C53.86,170,62,139.69,62,104a65.63,65.63,0,0,1,7.78-31.12L172.62,186Zm165.29-8.62a5.88,5.88,0,0,1-2.2.42,6,6,0,0,1-5.58-3.81c-7.2-18.31-11.49-44.48-11.49-70A66,66,0,0,0,95.45,46.57a6,6,0,1,1-5.93-10.43A78,78,0,0,1,206,104c0,35.7,8.16,59.24,10.66,65.61A6,6,0,0,1,213.27,177.38Z"}))],["regular",c.createElement(c.Fragment,null,c.createElement("path",{d:"M53.92,34.62A8,8,0,1,0,42.08,45.38L58.82,63.8A79.59,79.59,0,0,0,48,104c0,35.34-8.26,62.38-13.81,71.94A16,16,0,0,0,48,200H88.8a40,40,0,0,0,78.4,0h15.44l19.44,21.38a8,8,0,1,0,11.84-10.76ZM128,216a24,24,0,0,1-22.62-16h45.24A24,24,0,0,1,128,216ZM48,184c7.7-13.24,16-43.92,16-80a63.65,63.65,0,0,1,6.26-27.62L168.09,184Zm166-4.73a8.13,8.13,0,0,1-2.93.55,8,8,0,0,1-7.44-5.08C196.35,156.19,192,129.75,192,104A64,64,0,0,0,96.43,48.31a8,8,0,0,1-7.9-13.91A80,80,0,0,1,208,104c0,35.35,8.05,58.59,10.52,64.88A8,8,0,0,1,214,179.25Z"}))],["thin",c.createElement(c.Fragment,null,c.createElement("path",{d:"M51,37.31A4,4,0,0,0,45,42.69L63.8,63.32A75.52,75.52,0,0,0,52,104c0,36.13-8.58,64-14.36,73.95A12,12,0,0,0,48,196H92.23a36,36,0,0,0,71.54,0h20.64L205,218.69a4,4,0,1,0,5.92-5.38ZM128,220a28,28,0,0,1-27.71-24h55.42A28,28,0,0,1,128,220ZM48,188a3.89,3.89,0,0,1-3.43-2,4,4,0,0,1,0-4C52,169.17,60,139.32,60,104a67.58,67.58,0,0,1,9.4-34.51L177.14,188Zm164.55-12.48a3.94,3.94,0,0,1-1.46.28,4,4,0,0,1-3.72-2.54C200.24,155.17,196,129.28,196,104A68,68,0,0,0,94.46,44.83a4,4,0,1,1-4-6.95A76,76,0,0,1,204,104c0,36.05,8.26,59.89,10.79,66.34A4,4,0,0,1,212.53,175.52Z"}))]]),O=c.forwardRef((a,b)=>c.createElement(g.default,{ref:b,...a,weights:N}));O.displayName="BellSlashIcon";var P=a.i(54634);let Q=new Map([["bold",c.createElement(c.Fragment,null,c.createElement("path",{d:"M236,144a68.07,68.07,0,0,1-68,68H80a12,12,0,0,1,0-24h88a44,44,0,0,0,0-88H61l27.52,27.51a12,12,0,0,1-17,17l-48-48a12,12,0,0,1,0-17l48-48a12,12,0,1,1,17,17L61,76H168A68.08,68.08,0,0,1,236,144Z"}))],["duotone",c.createElement(c.Fragment,null,c.createElement("path",{d:"M80,40v96L32,88Z",opacity:"0.2"}),c.createElement("path",{d:"M168,80H88V40a8,8,0,0,0-13.66-5.66l-48,48a8,8,0,0,0,0,11.32l48,48A8,8,0,0,0,88,136V96h80a48,48,0,0,1,0,96H80a8,8,0,0,0,0,16h88a64,64,0,0,0,0-128ZM72,116.69,43.31,88,72,59.31Z"}))],["fill",c.createElement(c.Fragment,null,c.createElement("path",{d:"M232,144a64.07,64.07,0,0,1-64,64H80a8,8,0,0,1,0-16h88a48,48,0,0,0,0-96H88v40a8,8,0,0,1-13.66,5.66l-48-48a8,8,0,0,1,0-11.32l48-48A8,8,0,0,1,88,40V80h80A64.07,64.07,0,0,1,232,144Z"}))],["light",c.createElement(c.Fragment,null,c.createElement("path",{d:"M230,144a62.07,62.07,0,0,1-62,62H80a6,6,0,0,1,0-12h88a50,50,0,0,0,0-100H46.49l37.75,37.76a6,6,0,1,1-8.48,8.48l-48-48a6,6,0,0,1,0-8.48l48-48a6,6,0,0,1,8.48,8.48L46.49,82H168A62.07,62.07,0,0,1,230,144Z"}))],["regular",c.createElement(c.Fragment,null,c.createElement("path",{d:"M232,144a64.07,64.07,0,0,1-64,64H80a8,8,0,0,1,0-16h88a48,48,0,0,0,0-96H51.31l34.35,34.34a8,8,0,0,1-11.32,11.32l-48-48a8,8,0,0,1,0-11.32l48-48A8,8,0,0,1,85.66,45.66L51.31,80H168A64.07,64.07,0,0,1,232,144Z"}))],["thin",c.createElement(c.Fragment,null,c.createElement("path",{d:"M228,144a60.07,60.07,0,0,1-60,60H80a4,4,0,0,1,0-8h88a52,52,0,0,0,0-104H41.66l41.17,41.17a4,4,0,0,1-5.66,5.66l-48-48a4,4,0,0,1,0-5.66l48-48a4,4,0,0,1,5.66,5.66L41.66,84H168A60.07,60.07,0,0,1,228,144Z"}))]]),R=c.forwardRef((a,b)=>c.createElement(g.default,{ref:b,...a,weights:Q}));R.displayName="ArrowUUpLeftIcon";var S=a.i(26616);let T=new Map([["bold",c.createElement(c.Fragment,null,c.createElement("path",{d:"M216.49,79.52l-56-56A12,12,0,0,0,152,20H56A20,20,0,0,0,36,40V216a20,20,0,0,0,20,20H200a20,20,0,0,0,20-20V88A12,12,0,0,0,216.49,79.52ZM160,57l23,23H160ZM60,212V44h76V92a12,12,0,0,0,12,12h48V212Z"}))],["duotone",c.createElement(c.Fragment,null,c.createElement("path",{d:"M208,88H152V32Z",opacity:"0.2"}),c.createElement("path",{d:"M213.66,82.34l-56-56A8,8,0,0,0,152,24H56A16,16,0,0,0,40,40V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V88A8,8,0,0,0,213.66,82.34ZM160,51.31,188.69,80H160ZM200,216H56V40h88V88a8,8,0,0,0,8,8h48V216Z"}))],["fill",c.createElement(c.Fragment,null,c.createElement("path",{d:"M213.66,82.34l-56-56A8,8,0,0,0,152,24H56A16,16,0,0,0,40,40V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V88A8,8,0,0,0,213.66,82.34ZM152,88V44l44,44Z"}))],["light",c.createElement(c.Fragment,null,c.createElement("path",{d:"M212.24,83.76l-56-56A6,6,0,0,0,152,26H56A14,14,0,0,0,42,40V216a14,14,0,0,0,14,14H200a14,14,0,0,0,14-14V88A6,6,0,0,0,212.24,83.76ZM158,46.48,193.52,82H158ZM200,218H56a2,2,0,0,1-2-2V40a2,2,0,0,1,2-2h90V88a6,6,0,0,0,6,6h50V216A2,2,0,0,1,200,218Z"}))],["regular",c.createElement(c.Fragment,null,c.createElement("path",{d:"M213.66,82.34l-56-56A8,8,0,0,0,152,24H56A16,16,0,0,0,40,40V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V88A8,8,0,0,0,213.66,82.34ZM160,51.31,188.69,80H160ZM200,216H56V40h88V88a8,8,0,0,0,8,8h48V216Z"}))],["thin",c.createElement(c.Fragment,null,c.createElement("path",{d:"M210.83,85.17l-56-56A4,4,0,0,0,152,28H56A12,12,0,0,0,44,40V216a12,12,0,0,0,12,12H200a12,12,0,0,0,12-12V88A4,4,0,0,0,210.83,85.17ZM156,41.65,198.34,84H156ZM200,220H56a4,4,0,0,1-4-4V40a4,4,0,0,1,4-4h92V88a4,4,0,0,0,4,4h52V216A4,4,0,0,1,200,220Z"}))]]),U=c.forwardRef((a,b)=>c.createElement(g.default,{ref:b,...a,weights:T}));U.displayName="FileIcon";let V=new Map([["bold",c.createElement(c.Fragment,null,c.createElement("path",{d:"M71.51,88.49a12,12,0,0,1,17-17L116,99V24a12,12,0,0,1,24,0V99l27.51-27.52a12,12,0,0,1,17,17l-48,48a12,12,0,0,1-17,0ZM224,116H188a12,12,0,0,0,0,24h32v56H36V140H68a12,12,0,0,0,0-24H32a20,20,0,0,0-20,20v64a20,20,0,0,0,20,20H224a20,20,0,0,0,20-20V136A20,20,0,0,0,224,116Zm-20,52a16,16,0,1,0-16,16A16,16,0,0,0,204,168Z"}))],["duotone",c.createElement(c.Fragment,null,c.createElement("path",{d:"M232,136v64a8,8,0,0,1-8,8H32a8,8,0,0,1-8-8V136a8,8,0,0,1,8-8H224A8,8,0,0,1,232,136Z",opacity:"0.2"}),c.createElement("path",{d:"M240,136v64a16,16,0,0,1-16,16H32a16,16,0,0,1-16-16V136a16,16,0,0,1,16-16H72a8,8,0,0,1,0,16H32v64H224V136H184a8,8,0,0,1,0-16h40A16,16,0,0,1,240,136Zm-117.66-2.34a8,8,0,0,0,11.32,0l48-48a8,8,0,0,0-11.32-11.32L136,108.69V24a8,8,0,0,0-16,0v84.69L85.66,74.34A8,8,0,0,0,74.34,85.66ZM200,168a12,12,0,1,0-12,12A12,12,0,0,0,200,168Z"}))],["fill",c.createElement(c.Fragment,null,c.createElement("path",{d:"M74.34,85.66A8,8,0,0,1,85.66,74.34L120,108.69V24a8,8,0,0,1,16,0v84.69l34.34-34.35a8,8,0,0,1,11.32,11.32l-48,48a8,8,0,0,1-11.32,0ZM240,136v64a16,16,0,0,1-16,16H32a16,16,0,0,1-16-16V136a16,16,0,0,1,16-16H84.4a4,4,0,0,1,2.83,1.17L111,145A24,24,0,0,0,145,145l23.8-23.8A4,4,0,0,1,171.6,120H224A16,16,0,0,1,240,136Zm-40,32a12,12,0,1,0-12,12A12,12,0,0,0,200,168Z"}))],["light",c.createElement(c.Fragment,null,c.createElement("path",{d:"M238,136v64a14,14,0,0,1-14,14H32a14,14,0,0,1-14-14V136a14,14,0,0,1,14-14H72a6,6,0,0,1,0,12H32a2,2,0,0,0-2,2v64a2,2,0,0,0,2,2H224a2,2,0,0,0,2-2V136a2,2,0,0,0-2-2H184a6,6,0,0,1,0-12h40A14,14,0,0,1,238,136Zm-114.24-3.76a6,6,0,0,0,8.48,0l48-48a6,6,0,0,0-8.48-8.48L134,113.51V24a6,6,0,0,0-12,0v89.51L84.24,75.76a6,6,0,0,0-8.48,8.48ZM198,168a10,10,0,1,0-10,10A10,10,0,0,0,198,168Z"}))],["regular",c.createElement(c.Fragment,null,c.createElement("path",{d:"M240,136v64a16,16,0,0,1-16,16H32a16,16,0,0,1-16-16V136a16,16,0,0,1,16-16H72a8,8,0,0,1,0,16H32v64H224V136H184a8,8,0,0,1,0-16h40A16,16,0,0,1,240,136Zm-117.66-2.34a8,8,0,0,0,11.32,0l48-48a8,8,0,0,0-11.32-11.32L136,108.69V24a8,8,0,0,0-16,0v84.69L85.66,74.34A8,8,0,0,0,74.34,85.66ZM200,168a12,12,0,1,0-12,12A12,12,0,0,0,200,168Z"}))],["thin",c.createElement(c.Fragment,null,c.createElement("path",{d:"M236,136v64a12,12,0,0,1-12,12H32a12,12,0,0,1-12-12V136a12,12,0,0,1,12-12H72a4,4,0,0,1,0,8H32a4,4,0,0,0-4,4v64a4,4,0,0,0,4,4H224a4,4,0,0,0,4-4V136a4,4,0,0,0-4-4H184a4,4,0,0,1,0-8h40A12,12,0,0,1,236,136Zm-110.83-5.17a4,4,0,0,0,5.66,0l48-48a4,4,0,1,0-5.66-5.66L132,118.34V24a4,4,0,0,0-8,0v94.34L82.83,77.17a4,4,0,0,0-5.66,5.66ZM196,168a8,8,0,1,0-8,8A8,8,0,0,0,196,168Z"}))]]),W=c.forwardRef((a,b)=>c.createElement(g.default,{ref:b,...a,weights:V}));function X(){let{currentUser:a,currentTenantId:g,refreshUnreadCount:h}=(0,d.useApp)(),i=(0,q.useSearchParams)().get("chatId"),[j,l]=(0,c.useState)([]),[m,o]=(0,c.useState)(null),[p,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(!1),[A,C]=(0,c.useState)(!1),[F,H]=(0,c.useState)(null),[J,N]=(0,c.useState)(""),[Q,T]=(0,c.useState)(null),[V,X]=(0,c.useState)(null),[Y,Z]=(0,c.useState)(!1),[$,_]=(0,c.useState)({level:"all"}),[aa,ab]=(0,c.useState)(!1),[ac,ad]=(0,c.useState)(null),[ae,af]=(0,c.useState)([]),[ag,ah]=(0,c.useState)(!1),[ai,aj]=(0,c.useState)(0),ak=(0,c.useRef)(null),[al,am]=(0,c.useState)(!1),[an,ao]=(0,c.useState)(""),[ap,aq]=(0,c.useState)([]),[ar,as]=(0,c.useState)(!1);(0,c.useEffect)(()=>{let a=setTimeout(async()=>{if(!an.trim()||!i||!g)return void aq([]);as(!0);try{let a=await e.ChatService.searchMessages(g,an,i);aq(a)}catch(a){console.error(a)}finally{as(!1)}},500);return()=>clearTimeout(a)},[an,i,g]);let at=(0,q.useRouter)(),au=(0,c.useRef)(void 0),av=(0,c.useRef)(null),aw=(0,c.useRef)(null);(0,c.useEffect)(()=>{if(!i||!a||!g){o(null),l([]);return}(async()=>{t(!0);try{let b=w.DB.conversations.find(a=>a.id===i);if(b){let c=b.title;if("dm"===b.type){let b=w.DB.conversationMembers.find(b=>b.conversation_id===i&&b.user_id!==a.id),d=b?w.DB.users.find(a=>a.id===b.user_id):null;c=d?.name||"Usuario"}o({...b,title:c})}let c=await e.ChatService.getMessages(i);if(l(c.data.reverse()),b&&"dm"===b.type&&a){let b=w.DB.conversationMembers.filter(a=>a.conversation_id===i).find(b=>b.user_id!==a.id);if(b){let c=await e.ChatService.isBlocked(a.id,b.user_id),d=await e.ChatService.isBlocked(b.user_id,a.id);ab(c||d),(c||d)&&ad(c?a.id:b.user_id)}}else ab(!1);au.current=c.nextCursor,C(c.hasMore),await e.ChatService.markAsRead(i,a.id),h();let d=await e.ChatService.getNotificationSettings(i,a.id);_(d),setTimeout(()=>aw.current?.scrollIntoView({behavior:"auto"}),100)}catch(a){console.error(a)}finally{t(!1)}})()},[i,a,g]);let ax=async()=>{if(!av.current||u||!A||!i)return;let{scrollTop:a}=av.current;if(0===a){v(!0);let a=av.current.scrollHeight;try{let b=await e.ChatService.getMessages(i,au.current);l(a=>[...b.data,...a]),au.current=b.nextCursor,C(b.hasMore),setTimeout(()=>{if(av.current){let b=av.current.scrollHeight;av.current.scrollTop=b-a}},0)}catch(a){console.error(a)}finally{v(!1)}}},ay=async()=>{if(!p.trim()&&0===ae.length||!a||!g||!i)return;if(F){try{await e.ChatService.editMessage(F,a.id,p),l(a=>a.map(a=>a.id===F?{...a,body:p}:a)),H(null),r("")}catch(a){console.error(a)}return}let b=`TEMP-${Date.now()}`,c={id:b,tenant_id:g,conversation_id:i,sender_id:a.id,body:p||(ae.length?"Archivo adjunto":""),body_type:ae.length?(ae[0].mime_type||ae[0].type||"").startsWith("image/")?"image":"file":"text",created_at:new Date().toISOString(),senderName:a.name,reply_to_message_id:Q?.id,replyTo:Q?{id:Q.id,senderName:Q.senderName||"User",body:Q.body}:void 0,reactions:[],attachments:[...ae]};l(a=>[...a,c]),r(""),T(null),af([]),setTimeout(()=>aw.current?.scrollIntoView({behavior:"smooth"}),100);try{let d=await e.ChatService.sendMessage(i,a.id,c.body,b,c.reply_to_message_id,c.attachments);l(a=>a.map(a=>a.id===b?d:a))}catch(a){console.error("Failed to send",a)}},az=async b=>{if(a){X(null);try{await e.ChatService.deleteMessage(b,a.id),l(a=>a.map(a=>a.id===b?{...a,deleted_at:new Date().toISOString(),body:""}:a))}catch(a){console.error(a)}}},aA=()=>{H(null),r("")},aB=async(b,c)=>{if(a){X(null),l(d=>d.map(d=>{if(d.id!==b)return d;let e=d.reactions||[],f=e.find(b=>b.user_id===a.id&&b.emoji===c),g=[...e];return f?g=g.filter(b=>b.user_id!==a.id||b.emoji!==c):g.push({message_id:b,user_id:a.id,emoji:c,created_at:new Date().toISOString()}),{...d,reactions:g}}));try{await e.ChatService.toggleReaction(b,a.id,c)}catch(a){console.error(a)}}},aC=async a=>{if(!a.target.files?.length||!g)return;let b=Array.from(a.target.files);for(let a of(ah(!0),aj(0),b))try{aj(0);let b=await e.ChatService.uploadFile(a,g,a=>aj(a));af(a=>[...a,b])}catch(b){console.error(b),alert(`Error al subir ${a.name}: ${b.message}`)}ah(!1),aj(0),ak.current&&(ak.current.value="")},aD=async()=>{if(i&&a&&confirm("Â¿EstÃ¡s seguro de que quieres salir del grupo?"))try{await e.ChatService.leaveGroup(i,a.id),at.push("/dashboard/chat")}catch(a){console.error(a)}},aE=async b=>{if(!i||!a)return;let c=b?new Date(Date.now()+36e5*b).toISOString():"2099-12-31T23:59:59Z";try{await e.ChatService.muteConversation(i,a.id,c),_(a=>({...a,mutedUntil:c})),Z(!1),alert(`Chat silenciado ${b?`por ${b}h`:"para siempre"}`)}catch(a){console.error(a)}},aF=async b=>{if(i&&a)try{await e.ChatService.updateNotificationSettings(i,a.id,b),_(a=>({...a,level:b})),Z(!1)}catch(a){console.error(a)}},aG=async()=>{if(m&&"dm"===m.type&&a)try{let b=(await e.ChatService.getGroupMembers(m.id)).find(b=>b.id!==a.id);if(!b)return;aa?(await e.ChatService.unblockUser(a.id,b.id),ab(!1),alert("Usuario desbloqueado")):confirm("Â¿EstÃ¡s seguro de bloquear a este usuario? No recibirÃ¡s mensajes.")&&(await e.ChatService.blockUser(a.id,b.id),ab(!0)),Z(!1)}catch(a){console.error(a)}},aH=async b=>{if(!a||!g)return;let c=prompt("Describe el motivo del reporte:");if(c)try{await e.ChatService.reportContent(a.id,g,{targetId:b.id,type:"message",reason:c,detail:`Reported by ${a.name}`}),alert("Reporte enviado. Gracias por contribuir a la seguridad."),X(null)}catch(a){console.error(a),alert("Error al reportar")}};return i?s&&0===j.length?(0,b.jsx)("div",{className:"h-full flex items-center justify-center bg-white",children:(0,b.jsx)(n,{size:32,className:"animate-spin text-blue-500"})}):(0,b.jsxs)("div",{className:"flex flex-col h-full bg-[#f0f2f5]",children:[" ",(0,b.jsxs)("div",{className:"h-16 px-6 border-b border-gray-200 flex items-center justify-between bg-white z-10 shadow-sm",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-white font-bold shadow-sm
                        ${m?.type==="group"?"bg-indigo-500":"bg-pink-500"}`,children:m?.title?.[0]||"?"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-bold text-gray-900 leading-tight",children:m?.title}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:m?.type==="group"?"Grupo":"En lÃ­nea"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 text-blue-600 relative",children:[(0,b.jsx)("button",{onClick:()=>am(!al),className:`p-2 rounded-full transition-colors ${al?"bg-blue-100 text-blue-700":"hover:bg-blue-50"}`,title:"Buscar en el chat",children:(0,b.jsx)(k.MagnifyingGlass,{size:20,weight:"bold"})}),(0,b.jsx)("button",{className:"p-2 hover:bg-blue-50 rounded-full transition-colors",children:(0,b.jsx)(B,{size:20,weight:"fill"})}),(0,b.jsx)("button",{className:"p-2 hover:bg-blue-50 rounded-full transition-colors",children:(0,b.jsx)(D,{size:20,weight:"fill"})}),(0,b.jsx)("div",{className:"w-px h-6 bg-gray-200 mx-1"}),(0,b.jsx)("button",{onClick:()=>Z(!Y),className:"p-2 hover:bg-gray-100 text-gray-400 rounded-full transition-colors",children:(0,b.jsx)(K,{size:24,weight:"bold"})}),Y&&(0,b.jsxs)("div",{className:"absolute top-12 right-0 bg-white shadow-xl rounded-xl py-2 w-48 z-20 border border-gray-100 animate-in fade-in zoom-in-95 duration-100",children:[(0,b.jsx)("div",{className:"px-4 py-2 text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Opciones"}),(0,b.jsxs)("button",{onClick:()=>aE(1),className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-50 text-gray-700 flex items-center gap-3",children:[(0,b.jsx)(O,{size:16})," Silenciar 1h"]}),(0,b.jsxs)("button",{onClick:()=>aE(8),className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-50 text-gray-700 flex items-center gap-3",children:[(0,b.jsx)(O,{size:16})," Silenciar 8h"]}),(0,b.jsx)("div",{className:"h-px bg-gray-100 my-1"}),(0,b.jsx)("div",{className:"px-4 py-1 text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"Preferencias"}),(0,b.jsxs)("button",{onClick:()=>aF("all"),className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-50 text-gray-700 flex items-center gap-3",children:[(0,b.jsx)("span",{className:`w-2 h-2 rounded-full ${!$?.level||"all"===$.level?"bg-green-500":"bg-gray-200"}`})," Todo"]}),(0,b.jsxs)("button",{onClick:()=>aF("mentions"),className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-50 text-gray-700 flex items-center gap-3",children:[(0,b.jsx)("span",{className:`w-2 h-2 rounded-full ${$?.level==="mentions"?"bg-yellow-500":"bg-gray-200"}`})," Solo menciones"]}),(0,b.jsxs)("button",{onClick:()=>aF("none"),className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-50 text-gray-700 flex items-center gap-3",children:[(0,b.jsx)("span",{className:`w-2 h-2 rounded-full ${$?.level==="none"?"bg-red-500":"bg-gray-200"}`})," Nada"]}),m?.type==="dm"&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"h-px bg-gray-100 my-1"}),(0,b.jsxs)("button",{onClick:aG,className:"w-full text-left px-4 py-2 text-sm hover:bg-red-50 text-red-600 flex items-center gap-3",children:[(0,b.jsx)(O,{size:16})," ",aa?"Desbloquear":"Bloquear Usuario"]})]}),m?.type==="group"&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"h-px bg-gray-100 my-1"}),(0,b.jsxs)("button",{onClick:aD,className:"w-full text-left px-4 py-2 text-sm hover:bg-red-50 text-red-600 flex items-center gap-3",children:[(0,b.jsx)(P.SignOut,{size:16})," Salir del Grupo"]})]})]})]})]}),al&&(0,b.jsxs)("div",{className:"bg-white border-b border-gray-200 p-4 animate-in slide-in-from-top-2 z-10 shadow-sm flex flex-col gap-2 max-h-[300px]",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(k.MagnifyingGlass,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),(0,b.jsx)("input",{autoFocus:!0,type:"text",placeholder:"Buscar en esta conversaciÃ³n...",className:"w-full pl-9 pr-4 py-2 bg-gray-50 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all",value:an,onChange:a=>ao(a.target.value)}),an&&(0,b.jsx)("button",{onClick:()=>ao(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:(0,b.jsx)(f.X,{size:14})})]}),(0,b.jsx)("div",{className:"overflow-y-auto custom-scrollbar flex-1",children:ar?(0,b.jsx)("div",{className:"py-4 flex justify-center text-blue-500",children:(0,b.jsx)(n,{size:20,className:"animate-spin"})}):ap.length>0?(0,b.jsx)("div",{className:"space-y-1 mt-1",children:ap.map(a=>(0,b.jsxs)("button",{onClick:()=>{var b;let c;return b=a.id,void((c=document.getElementById(b))?(c.scrollIntoView({behavior:"smooth",block:"center"}),c.classList.add("bg-blue-100"),setTimeout(()=>c.classList.remove("bg-blue-100"),2e3)):alert("El mensaje es muy antiguo y no estÃ¡ en la vista actual. (Deep linking pendiente)"))},className:"w-full text-left p-2 hover:bg-gray-50 rounded-lg flex flex-col text-sm border-b border-gray-50 last:border-0",children:[(0,b.jsxs)("div",{className:"flex justify-between items-baseline mb-0.5",children:[(0,b.jsx)("span",{className:"font-bold text-xs text-gray-700",children:a.senderName}),(0,b.jsx)("span",{className:"text-[10px] text-gray-400",children:new Date(a.created_at).toLocaleDateString()})]}),(0,b.jsx)("div",{className:"text-gray-600 truncate text-xs w-full",dangerouslySetInnerHTML:{__html:a.body.replace(RegExp(`(${an})`,"gi"),'<span class="bg-yellow-200 text-black rounded px-0.5">$1</span>')}})]},a.id))}):an.trim()?(0,b.jsx)("div",{className:"text-center py-4 text-xs text-gray-400",children:"No se encontraron mensajes."}):(0,b.jsx)("div",{className:"text-center py-4 text-xs text-gray-400",children:"Escribe para buscar..."})})]}),(0,b.jsxs)("div",{ref:av,onScroll:ax,className:"flex-1 overflow-y-auto p-4 md:p-8 space-y-4",style:{backgroundImage:'url("https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png")',backgroundRepeat:"repeat",backgroundSize:"400px"},children:[u&&(0,b.jsx)("div",{className:"flex justify-center py-2",children:(0,b.jsxs)("div",{className:"bg-white/80 px-3 py-1 rounded-full shadow-sm flex items-center gap-2",children:[(0,b.jsx)(n,{size:14,className:"animate-spin text-blue-600"}),(0,b.jsx)("span",{className:"text-xs font-medium text-gray-600",children:"Cargando historial..."})]})}),j.map((c,d)=>{let e=c.sender_id===a?.id,f=j[d-1],g=f&&f.sender_id===c.sender_id&&new Date(c.created_at).getTime()-new Date(f.created_at).getTime()<6e4;return(0,b.jsxs)("div",{id:c.id,className:`flex flex-col ${e?"items-end":"items-start"} ${g?"mt-1":"mt-4"}`,children:[m?.type==="group"&&!e&&!g&&(0,b.jsx)("span",{className:"text-[11px] font-bold text-gray-500 ml-1 mb-1",children:c.senderName}),(0,b.jsxs)("div",{className:`relative px-4 py-2 max-w-[85%] md:max-w-[65%] w-fit shadow-sm text-[15px] leading-relaxed break-words group/bubble
                                ${e?"bg-[#d9fdd3] text-gray-900 rounded-2xl rounded-tr-none":"bg-white text-gray-900 rounded-2xl rounded-tl-none"}
                            `,children:[c.deleted_at?(0,b.jsxs)("span",{className:"italic text-gray-500 text-sm flex items-center gap-1",children:[(0,b.jsx)(E.Info,{size:14})," Mensaje eliminado"]}):(0,b.jsxs)(b.Fragment,{children:[c.replyTo&&(0,b.jsxs)("div",{className:"mb-1 bg-black/5 rounded md-4 p-1 border-l-4 border-blue-500 text-xs text-gray-600 flex flex-col cursor-pointer",onClick:()=>{document.getElementById(c.replyTo.id)?.scrollIntoView({behavior:"smooth",block:"center"})},children:[(0,b.jsx)("span",{className:"font-bold text-blue-600 mb-0.5",children:c.replyTo.senderName}),(0,b.jsx)("span",{className:"truncate",children:c.replyTo.body})]}),c.attachments&&c.attachments.length>0&&(0,b.jsx)("div",{className:"mb-2 space-y-2",children:c.attachments.map(a=>(0,b.jsx)("div",{children:(a.mime_type||a.type||"").startsWith("image/")?(0,b.jsx)("div",{className:"rounded-lg overflow-hidden border border-black/10",children:(0,b.jsx)("img",{src:a.url||"https://via.placeholder.com/300",alt:"Attachment",className:"max-w-full max-h-[300px] object-cover"})}):(0,b.jsxs)("div",{className:"flex items-center gap-3 bg-black/5 p-3 rounded-lg border border-black/5",children:[(0,b.jsx)("div",{className:"p-2 bg-white rounded-full text-blue-500 shadow-sm",children:(0,b.jsx)(U,{size:24,weight:"fill"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-sm font-semibold truncate text-gray-800",children:a.file_name}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:[(a.size/1024).toFixed(1)," KB"]})]}),(0,b.jsx)("a",{href:a.url,download:!0,target:"_blank",className:"p-2 hover:bg-black/10 rounded-full text-gray-500 transition-colors",children:(0,b.jsx)(W,{size:20})})]})},a.id))}),c.body,c.reactions&&c.reactions.length>0&&(0,b.jsx)("div",{className:"flex flex-wrap gap-1 mt-1.5 -mb-2 z-20 relative",children:Array.from(new Set(c.reactions.map(a=>a.emoji))).map(d=>{let e=c.reactions?.filter(a=>a.emoji===d).length,f=c.reactions?.find(b=>b.emoji===d&&b.user_id===a?.id);return(0,b.jsxs)("button",{onClick:()=>aB(c.id,d),className:`text-[10px] px-1.5 py-0.5 rounded-full border shadow-sm flex items-center gap-0.5 transition-colors
                                                                ${f?"bg-blue-100 border-blue-200 text-blue-700":"bg-white border-gray-100 text-gray-600 hover:bg-gray-50"}
                                                            `,children:[(0,b.jsx)("span",{children:d}),(0,b.jsx)("span",{className:"font-bold",children:e})]},d)})}),!c.deleted_at&&(0,b.jsxs)("div",{className:`absolute -top-2 ${e?"-left-8":"-right-8"} opacity-0 group-hover/bubble:opacity-100 transition-opacity flex items-center gap-1`,children:[(0,b.jsxs)("div",{className:"bg-white shadow-sm rounded-full px-1 py-0.5 border border-gray-100 hidden md:flex",children:[(0,b.jsx)("button",{onClick:()=>aB(c.id,"ðŸ‘"),className:"p-1 hover:scale-110 transition-transform",children:"ðŸ‘"}),(0,b.jsx)("button",{onClick:()=>aB(c.id,"â¤ï¸"),className:"p-1 hover:scale-110 transition-transform",children:"â¤ï¸"}),(0,b.jsx)("button",{onClick:()=>aB(c.id,"ðŸ˜‚"),className:"p-1 hover:scale-110 transition-transform",children:"ðŸ˜‚"})]}),(0,b.jsx)("button",{onClick:()=>X(V===c.id?null:c.id),className:"p-1 bg-gray-100 hover:bg-gray-200 rounded-full text-gray-500 shadow-sm",children:(0,b.jsx)(I,{size:14,weight:"bold"})}),V===c.id&&(0,b.jsxs)("div",{className:"absolute top-6 right-0 bg-white shadow-lg rounded-lg py-1 w-32 z-30 border border-gray-100 flex flex-col",children:[(0,b.jsxs)("button",{onClick:()=>{X(null),T(c)},className:"text-left px-3 py-2 text-sm hover:bg-gray-50 text-gray-700 flex items-center gap-2",children:[(0,b.jsx)(R,{size:14})," Responder"]}),e&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("button",{onClick:()=>{X(null),H(c.id),N(c.body),r(c.body)},className:"text-left px-3 py-2 text-sm hover:bg-gray-50 text-gray-700 flex items-center gap-2",children:[(0,b.jsx)(M.PencilSimple,{size:14})," Editar"]}),(0,b.jsxs)("button",{onClick:()=>az(c.id),className:"text-left px-3 py-2 text-sm hover:bg-gray-50 text-red-600 flex items-center gap-2",children:[(0,b.jsx)(L.Trash,{size:14})," Eliminar"]})]}),(0,b.jsxs)("button",{onClick:()=>aB(c.id,"ðŸ‘Ž"),className:"text-left px-3 py-2 text-sm hover:bg-gray-50 text-gray-700 flex items-center gap-2",children:[(0,b.jsx)(S.ThumbsUp,{className:"rotate-180",size:14})," No me gusta"]}),(0,b.jsxs)("button",{onClick:()=>aH(c),className:"text-left px-3 py-2 text-sm hover:bg-red-50 text-red-600 flex items-center gap-2",children:[(0,b.jsx)(E.Info,{size:14})," Reportar"]})]})]})]}),(0,b.jsxs)("div",{className:`text-[10px] mt-1 flex items-center justify-end gap-1 select-none ${e?"opacity-80":"text-gray-400"}`,children:[new Date(c.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),e&&(0,b.jsx)(G,{weight:"bold",size:14,className:"text-blue-500"})]})]})]},c.id)}),(0,b.jsx)("div",{ref:aw})]}),aa?(0,b.jsxs)("div",{className:"p-4 bg-gray-100 border-t border-gray-200 text-center text-gray-500 text-sm",children:["No puedes enviar mensajes a esta conversaciÃ³n porque has bloqueado al usuario o te han bloqueado.",(0,b.jsx)("button",{onClick:aG,className:"text-blue-500 font-bold ml-2 hover:underline",children:"Gestionar bloqueo"})]}):(0,b.jsxs)("div",{className:"bg-white px-4 py-3 border-t border-gray-200",children:[Q&&(0,b.jsxs)("div",{className:"max-w-4xl mx-auto mb-2 bg-gray-50 rounded-lg p-2 border-l-4 border-blue-500 flex justify-between items-center animate-in slide-in-from-bottom-2 fade-in",children:[(0,b.jsxs)("div",{className:"text-sm",children:[(0,b.jsxs)("div",{className:"text-blue-600 font-bold text-xs",children:["Respondiendo a ",Q.senderName]}),(0,b.jsx)("div",{className:"text-gray-500 truncate max-w-xs",children:Q.body})]}),(0,b.jsx)("button",{onClick:()=>T(null),className:"p-1 hover:bg-gray-200 rounded-full text-gray-500",children:(0,b.jsx)(f.X,{size:16})})]}),ae.length>0&&(0,b.jsx)("div",{className:"max-w-4xl mx-auto mb-2 flex gap-2 overflow-x-auto pb-1",children:ae.map((a,c)=>(0,b.jsxs)("div",{className:"relative group shrink-0 w-20 h-20 rounded-lg overflow-hidden border border-gray-200",children:[(a.mime_type||a.type||"").startsWith("image/")?(0,b.jsx)("img",{src:a.url,className:"w-full h-full object-cover"}):(0,b.jsxs)("div",{className:"w-full h-full bg-gray-50 flex flex-col items-center justify-center p-1",children:[(0,b.jsx)(U,{size:24,className:"text-gray-400 mb-1"}),(0,b.jsx)("span",{className:"text-[9px] text-gray-500 truncate w-full text-center",children:a.file_name})]}),(0,b.jsx)("button",{onClick:()=>af(a=>a.filter((a,b)=>b!==c)),className:"absolute top-1 right-1 p-0.5 bg-black/50 text-white rounded-full hover:bg-red-500 transition-colors",children:(0,b.jsx)(f.X,{size:12})})]},c))}),(0,b.jsxs)("div",{className:"flex items-end gap-2 max-w-4xl mx-auto",children:[(0,b.jsx)("input",{type:"file",multiple:!0,hidden:!0,ref:ak,onChange:aC}),(0,b.jsxs)("button",{onClick:()=>ak.current?.click(),disabled:ag,className:`p-3 rounded-full transition-colors mb-0.5 relative group ${ag?"bg-blue-50 text-blue-500":"text-gray-500 hover:bg-gray-100"}`,children:[ag?(0,b.jsxs)("div",{className:"flex items-center justify-center",children:[(0,b.jsx)(n,{className:"animate-spin",size:22}),(0,b.jsx)("span",{className:"absolute text-[8px] font-bold",children:ai})]}):(0,b.jsx)(y.Paperclip,{size:22}),(0,b.jsx)("div",{className:"absolute bottom-full left-0 mb-2 hidden group-hover:block w-48 bg-gray-800 text-white text-xs p-2 rounded shadow-lg z-50",children:"ImÃ¡genes, PDF, Word, Excel, TXT (MÃ¡x 10MB)"})]}),(0,b.jsxs)("div",{className:"flex-1 bg-gray-100 rounded-3xl flex items-center px-4 py-2 focus-within:ring-2 focus-within:ring-blue-500/20 focus-within:bg-white transition-all border border-transparent focus-within:border-blue-200",children:[F&&(0,b.jsx)("div",{className:"mr-2 text-blue-600 font-bold text-xs bg-blue-50 px-2 py-1 rounded",children:"Editando"}),(0,b.jsx)("textarea",{className:"flex-1 bg-transparent border-none focus:ring-0 resize-none max-h-32 py-2 text-gray-800 placeholder-gray-500 custom-scrollbar leading-150",placeholder:"Escribe un mensaje...",rows:1,style:{minHeight:"24px"},value:p,onChange:a=>r(a.target.value),onKeyDown:a=>{"Enter"!==a.key||a.shiftKey||(a.preventDefault(),ay()),"Escape"===a.key&&(F&&aA(),Q&&T(null),ae.length&&af([]))}}),F&&(0,b.jsx)("button",{onClick:aA,className:"text-gray-400 hover:text-red-500 mr-1 transition-colors",children:(0,b.jsx)(f.X,{size:20})}),(0,b.jsx)("button",{className:"text-gray-400 hover:text-yellow-500 ml-2 transition-colors",children:(0,b.jsx)(z.Smiley,{size:24})})]}),(0,b.jsx)("button",{onClick:ay,className:`p-3 rounded-full transition-all duration-200 shadow-sm flex items-center justify-center mb-0.5
                            ${p.trim()?"bg-blue-600 text-white hover:bg-blue-700 hover:scale-105 active:scale-95":"bg-gray-200 text-gray-400 cursor-not-allowed"}
                        `,children:(0,b.jsx)(x.PaperPlaneRight,{weight:"fill",size:22})})]})]})]}):(0,b.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-gray-400 p-8 text-center bg-slate-50",children:[(0,b.jsx)("div",{className:"w-24 h-24 bg-white rounded-full flex items-center justify-center mb-4 shadow-sm",children:(0,b.jsx)(x.PaperPlaneRight,{size:48,weight:"thin",className:"text-blue-300"})}),(0,b.jsx)("h3",{className:"text-xl font-bold text-gray-700",children:"Comienza a charlar"}),(0,b.jsx)("p",{className:"max-w-xs mt-2 text-sm text-gray-500",children:"Selecciona una conversaciÃ³n de tu bandeja de entrada."})]})}function Y(){return(0,b.jsx)(j,{sidebar:(0,b.jsx)(v,{}),children:(0,b.jsx)(X,{})})}W.displayName="DownloadIcon",a.s(["default",()=>Y],2689)}];

//# sourceMappingURL=app_dashboard_chat_page_tsx_28a96c12._.js.map