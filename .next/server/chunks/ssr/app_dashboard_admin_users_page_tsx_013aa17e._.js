module.exports=[57353,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(98263),e=a.i(82665),f=a.i(69478),g=a.i(10158),h=a.i(56262),i=a.i(39577),j=a.i(27964),k=a.i(25603),l=a.i(73856),m=a.i(60217);let n=new Map([["bold",c.createElement(c.Fragment,null,c.createElement("path",{d:"M196,76a16,16,0,1,1-16-16A16,16,0,0,1,196,76Zm48,22.74A84.3,84.3,0,0,1,160.11,180H160a83.52,83.52,0,0,1-23.65-3.38l-7.86,7.87A12,12,0,0,1,120,188H108v12a12,12,0,0,1-12,12H84v12a12,12,0,0,1-12,12H40a20,20,0,0,1-20-20V187.31a19.86,19.86,0,0,1,5.86-14.14l53.52-53.52A84,84,0,1,1,244,98.74ZM202.43,53.57A59.48,59.48,0,0,0,158,36c-32,1-58,27.89-58,59.89a59.69,59.69,0,0,0,4.2,22.19,12,12,0,0,1-2.55,13.21L44,189v23H60V200a12,12,0,0,1,12-12H84V176a12,12,0,0,1,12-12h19l9.65-9.65a12,12,0,0,1,13.22-2.55A59.58,59.58,0,0,0,160,156h.08c32,0,58.87-26.07,59.89-58A59.55,59.55,0,0,0,202.43,53.57Z"}))],["duotone",c.createElement(c.Fragment,null,c.createElement("path",{d:"M232,98.36C230.73,136.92,198.67,168,160.09,168a71.68,71.68,0,0,1-26.92-5.17h0L120,176H96v24H72v24H40a8,8,0,0,1-8-8V187.31a8,8,0,0,1,2.34-5.65l58.83-58.83h0A71.68,71.68,0,0,1,88,95.91c0-38.58,31.08-70.64,69.64-71.87A72,72,0,0,1,232,98.36Z",opacity:"0.2"}),c.createElement("path",{d:"M216.57,39.43A80,80,0,0,0,83.91,120.78L28.69,176A15.86,15.86,0,0,0,24,187.31V216a16,16,0,0,0,16,16H72a8,8,0,0,0,8-8V208H96a8,8,0,0,0,8-8V184h16a8,8,0,0,0,5.66-2.34l9.56-9.57A79.73,79.73,0,0,0,160,176h.1A80,80,0,0,0,216.57,39.43ZM224,98.1c-1.09,34.09-29.75,61.86-63.89,61.9H160a63.7,63.7,0,0,1-23.65-4.51,8,8,0,0,0-8.84,1.68L116.69,168H96a8,8,0,0,0-8,8v16H72a8,8,0,0,0-8,8v16H40V187.31l58.83-58.82a8,8,0,0,0,1.68-8.84A63.72,63.72,0,0,1,96,95.92c0-34.14,27.81-62.8,61.9-63.89A64,64,0,0,1,224,98.1ZM192,76a12,12,0,1,1-12-12A12,12,0,0,1,192,76Z"}))],["fill",c.createElement(c.Fragment,null,c.createElement("path",{d:"M216.57,39.43A80,80,0,0,0,83.91,120.78L28.69,176A15.86,15.86,0,0,0,24,187.31V216a16,16,0,0,0,16,16H72a8,8,0,0,0,8-8V208H96a8,8,0,0,0,8-8V184h16a8,8,0,0,0,5.66-2.34l9.56-9.57A79.73,79.73,0,0,0,160,176h.1A80,80,0,0,0,216.57,39.43ZM180,92a16,16,0,1,1,16-16A16,16,0,0,1,180,92Z"}))],["light",c.createElement(c.Fragment,null,c.createElement("path",{d:"M215.15,40.85A78,78,0,0,0,86.2,121.31l-56.1,56.1a13.94,13.94,0,0,0-4.1,9.9V216a14,14,0,0,0,14,14H72a6,6,0,0,0,6-6V206H96a6,6,0,0,0,6-6V182h18a6,6,0,0,0,4.24-1.76l10.45-10.44A77.59,77.59,0,0,0,160,174h.1A78,78,0,0,0,215.15,40.85ZM226,98.16c-1.12,35.16-30.67,63.8-65.88,63.84a65.93,65.93,0,0,1-24.51-4.67,6,6,0,0,0-6.64,1.26L117.51,170H96a6,6,0,0,0-6,6v18H72a6,6,0,0,0-6,6v18H40a2,2,0,0,1-2-2V187.31a2,2,0,0,1,.58-1.41l58.83-58.83a6,6,0,0,0,1.26-6.64A65.61,65.61,0,0,1,94,95.92C94,60.71,122.68,31.16,157.83,30A66,66,0,0,1,226,98.16ZM190,76a10,10,0,1,1-10-10A10,10,0,0,1,190,76Z"}))],["regular",c.createElement(c.Fragment,null,c.createElement("path",{d:"M216.57,39.43A80,80,0,0,0,83.91,120.78L28.69,176A15.86,15.86,0,0,0,24,187.31V216a16,16,0,0,0,16,16H72a8,8,0,0,0,8-8V208H96a8,8,0,0,0,8-8V184h16a8,8,0,0,0,5.66-2.34l9.56-9.57A79.73,79.73,0,0,0,160,176h.1A80,80,0,0,0,216.57,39.43ZM224,98.1c-1.09,34.09-29.75,61.86-63.89,61.9H160a63.7,63.7,0,0,1-23.65-4.51,8,8,0,0,0-8.84,1.68L116.69,168H96a8,8,0,0,0-8,8v16H72a8,8,0,0,0-8,8v16H40V187.31l58.83-58.82a8,8,0,0,0,1.68-8.84A63.72,63.72,0,0,1,96,95.92c0-34.14,27.81-62.8,61.9-63.89A64,64,0,0,1,224,98.1ZM192,76a12,12,0,1,1-12-12A12,12,0,0,1,192,76Z"}))],["thin",c.createElement(c.Fragment,null,c.createElement("path",{d:"M213.74,42.26A76,76,0,0,0,88.51,121.84l-57,57A11.93,11.93,0,0,0,28,187.31V216a12,12,0,0,0,12,12H72a4,4,0,0,0,4-4V204H96a4,4,0,0,0,4-4V180h20a4,4,0,0,0,2.83-1.17l11.33-11.34A75.72,75.72,0,0,0,160,172h.1A76,76,0,0,0,213.74,42.26Zm14.22,56c-1.15,36.22-31.6,65.72-67.87,65.77H160a67.52,67.52,0,0,1-25.21-4.83,4,4,0,0,0-4.45.83l-12,12H96a4,4,0,0,0-4,4v20H72a4,4,0,0,0-4,4v20H40a4,4,0,0,1-4-4V187.31a4.06,4.06,0,0,1,1.17-2.83L96,125.66a4,4,0,0,0,.83-4.45A67.51,67.51,0,0,1,92,95.91C92,59.64,121.55,29.19,157.77,28A68,68,0,0,1,228,98.23ZM188,76a8,8,0,1,1-8-8A8,8,0,0,1,188,76Z"}))]]),o=c.forwardRef((a,b)=>c.createElement(m.default,{ref:b,...a,weights:n}));o.displayName="KeyIcon";var p=a.i(87754),q=a.i(39321),r=a.i(56536),s=a.i(4971),t=a.i(60144),u=a.i(70054),v=a.i(1739);function w({isOpen:a,onClose:d,onImport:e,tenantId:f}){let[g,h]=(0,c.useState)(null),[i,j]=(0,c.useState)([]),[k,l]=(0,c.useState)([]),[m,n]=(0,c.useState)(!1);if(!a)return null;let o=async a=>{let b=a.target.files?.[0];if(!b)return;h(b),l([]),j([]);let c=(await b.text()).split("\n").filter(a=>a.trim());if(c.length<2)return void l(["El archivo estÃ¡ vacÃ­o o no tiene datos"]);let d=c[0].split(",").map(a=>a.trim()),e=["name","email"].filter(a=>!d.includes(a));if(e.length>0)return void l([`Faltan campos requeridos: ${e.join(", ")}`]);let g=[],i=[];for(let a=1;a<c.length;a++){let b=c[a].split(",").map(a=>a.trim()),e={};if(d.forEach((a,c)=>{e[a]=b[c]||""}),!e.name||!e.email){i.push(`L\xednea ${a+1}: Faltan campos requeridos (name, email)`);continue}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email)){i.push(`L\xednea ${a+1}: Email inv\xe1lido "${e.email}"`);continue}let h=parseInt(e.level)||3;if(h<1||h>6){i.push(`L\xednea ${a+1}: Nivel inv\xe1lido. Debe ser entre 1 y 6`);continue}let j={id:`user_${Date.now()}_${a}`,tenantId:f,name:e.name,email:e.email,password:e.password||"ChangeMe123!",level:h,role:e.role||"Usuario",unit:e.unit||"",jobTitle:e.jobTitle||"",phone:e.phone||"",location:e.location||"",status:"ACTIVE"===e.status||"SUSPENDED"===e.status||"PENDING_INVITE"===e.status||"DELETED"===e.status?e.status:"ACTIVE",initials:e.name.split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2)};g.push(j)}i.length>0&&l(i),j(g)},p=()=>{h(null),j([]),l([]),n(!1),d()};return(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fadeIn",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-5xl w-full max-h-[90vh] overflow-hidden flex flex-col animate-slideUp",children:[(0,b.jsxs)("div",{className:"bg-gradient-to-r from-indigo-600 to-indigo-700 text-white p-6 flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-3 bg-white/20 rounded-lg",children:(0,b.jsx)(r.UploadSimple,{size:32,weight:"fill"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-2xl font-bold",children:"Importar Usuarios"}),(0,b.jsx)("p",{className:"text-indigo-100 text-sm mt-1",children:"Carga masiva desde archivo CSV"})]})]}),(0,b.jsx)("button",{onClick:p,className:"p-2 hover:bg-white/20 rounded-lg transition-colors",children:(0,b.jsx)(q.X,{size:24,weight:"bold"})})]}),(0,b.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[(0,b.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)(v.Info,{size:24,className:"text-blue-600 flex-shrink-0",weight:"fill"}),(0,b.jsxs)("div",{className:"text-sm text-blue-900",children:[(0,b.jsx)("p",{className:"font-bold mb-2",children:"Instrucciones:"}),(0,b.jsxs)("ol",{className:"list-decimal list-inside space-y-1",children:[(0,b.jsx)("li",{children:"Descarga el archivo de ejemplo haciendo clic en el botÃ³n abajo"}),(0,b.jsx)("li",{children:"Edita el archivo CSV con los datos de tus usuarios"}),(0,b.jsx)("li",{children:"AsegÃºrate de mantener el formato y los nombres de las columnas"}),(0,b.jsx)("li",{children:"Sube el archivo editado usando el botÃ³n de carga"})]})]})]})}),(0,b.jsx)("div",{className:"flex justify-center",children:(0,b.jsxs)("button",{onClick:()=>{let a=document.createElement("a");a.href="/templates/usuarios-ejemplo.csv",a.download="usuarios-ejemplo.csv",a.click()},className:"flex items-center gap-2 px-6 py-3 bg-green-600 text-white rounded-lg font-bold hover:bg-green-700 transition-colors shadow-lg",children:[(0,b.jsx)(s.DownloadSimple,{size:20,weight:"bold"}),"Descargar Plantilla CSV de Ejemplo"]})}),(0,b.jsxs)("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-4",children:[(0,b.jsx)("h3",{className:"font-bold text-slate-800 mb-3",children:"Formato del Archivo CSV"}),(0,b.jsxs)("div",{className:"text-sm text-slate-700 space-y-2",children:[(0,b.jsx)("p",{children:(0,b.jsx)("strong",{children:"Columnas requeridas:"})}),(0,b.jsxs)("ul",{className:"list-disc list-inside space-y-1 ml-4",children:[(0,b.jsxs)("li",{children:[(0,b.jsx)("code",{className:"bg-slate-200 px-2 py-0.5 rounded",children:"name"})," - Nombre completo del usuario"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("code",{className:"bg-slate-200 px-2 py-0.5 rounded",children:"email"})," - Email corporativo (debe ser Ãºnico)"]})]}),(0,b.jsx)("p",{className:"mt-3",children:(0,b.jsx)("strong",{children:"Columnas opcionales:"})}),(0,b.jsxs)("ul",{className:"list-disc list-inside space-y-1 ml-4",children:[(0,b.jsxs)("li",{children:[(0,b.jsx)("code",{className:"bg-slate-200 px-2 py-0.5 rounded",children:"password"})," - ContraseÃ±a inicial (default: ChangeMe123!)"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("code",{className:"bg-slate-200 px-2 py-0.5 rounded",children:"level"})," - Nivel de acceso 1-6 (default: 3)"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("code",{className:"bg-slate-200 px-2 py-0.5 rounded",children:"role"})," - Rol del usuario (ej: Analista, Manager)"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("code",{className:"bg-slate-200 px-2 py-0.5 rounded",children:"unit"})," - Unidad organizacional"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("code",{className:"bg-slate-200 px-2 py-0.5 rounded",children:"jobTitle"})," - Cargo o tÃ­tulo del puesto"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("code",{className:"bg-slate-200 px-2 py-0.5 rounded",children:"phone"})," - TelÃ©fono de contacto"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("code",{className:"bg-slate-200 px-2 py-0.5 rounded",children:"location"})," - UbicaciÃ³n fÃ­sica"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("code",{className:"bg-slate-200 px-2 py-0.5 rounded",children:"status"})," - ACTIVE o INACTIVE (default: ACTIVE)"]})]})]})]}),(0,b.jsxs)("div",{className:"border-2 border-dashed border-slate-300 rounded-xl p-8 text-center hover:border-indigo-400 transition-colors",children:[(0,b.jsx)("input",{type:"file",accept:".csv",onChange:o,className:"hidden",id:"csv-upload"}),(0,b.jsxs)("label",{htmlFor:"csv-upload",className:"cursor-pointer flex flex-col items-center gap-3",children:[(0,b.jsx)("div",{className:"p-4 bg-indigo-100 rounded-full",children:(0,b.jsx)(r.UploadSimple,{size:48,className:"text-indigo-600",weight:"fill"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-lg font-bold text-slate-800",children:g?g.name:"Haz clic para seleccionar un archivo CSV"}),(0,b.jsx)("p",{className:"text-sm text-slate-500 mt-1",children:"o arrastra y suelta aquÃ­"})]})]})]}),k.length>0&&(0,b.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)(u.Warning,{size:24,className:"text-red-600 flex-shrink-0",weight:"fill"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-bold text-red-900 mb-2",children:"Errores encontrados:"}),(0,b.jsxs)("ul",{className:"text-sm text-red-800 space-y-1",children:[k.slice(0,10).map((a,c)=>(0,b.jsxs)("li",{children:["â€¢ ",a]},c)),k.length>10&&(0,b.jsxs)("li",{className:"text-red-600 font-bold",children:["... y ",k.length-10," errores mÃ¡s"]})]})]})]})}),i.length>0&&0===k.length&&(0,b.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3 mb-4",children:[(0,b.jsx)(t.CheckCircle,{size:24,className:"text-green-600 flex-shrink-0",weight:"fill"}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"font-bold text-green-900",children:["Vista Previa: ",i.length," usuarios listos para importar"]}),(0,b.jsx)("p",{className:"text-sm text-green-800 mt-1",children:"Revisa los datos antes de confirmar la importaciÃ³n"})]})]}),(0,b.jsx)("div",{className:"max-h-96 overflow-y-auto bg-white rounded-lg border border-green-200",children:(0,b.jsxs)("table",{className:"w-full text-sm",children:[(0,b.jsx)("thead",{className:"bg-green-100 sticky top-0",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"text-left p-2 font-bold text-green-900",children:"Nombre"}),(0,b.jsx)("th",{className:"text-left p-2 font-bold text-green-900",children:"Email"}),(0,b.jsx)("th",{className:"text-left p-2 font-bold text-green-900",children:"Nivel"}),(0,b.jsx)("th",{className:"text-left p-2 font-bold text-green-900",children:"Rol"}),(0,b.jsx)("th",{className:"text-left p-2 font-bold text-green-900",children:"Unidad"}),(0,b.jsx)("th",{className:"text-left p-2 font-bold text-green-900",children:"Estado"})]})}),(0,b.jsx)("tbody",{children:i.map((a,c)=>(0,b.jsxs)("tr",{className:"border-t border-green-100 hover:bg-green-50",children:[(0,b.jsx)("td",{className:"p-2",children:a.name}),(0,b.jsx)("td",{className:"p-2 text-xs",children:a.email}),(0,b.jsx)("td",{className:"p-2",children:(0,b.jsxs)("span",{className:"px-2 py-0.5 rounded text-xs font-bold bg-blue-100 text-blue-700",children:["Nivel ",a.level]})}),(0,b.jsx)("td",{className:"p-2 text-xs",children:a.role}),(0,b.jsx)("td",{className:"p-2 text-xs",children:a.unit||"-"}),(0,b.jsx)("td",{className:"p-2",children:(0,b.jsx)("span",{className:`px-2 py-0.5 rounded text-xs font-bold ${"ACTIVE"===a.status?"bg-green-100 text-green-700":"bg-slate-100 text-slate-700"}`,children:a.status})})]},c))})]})})]})]}),(0,b.jsxs)("div",{className:"border-t border-slate-200 p-4 bg-slate-50 flex justify-end gap-3",children:[(0,b.jsx)("button",{onClick:p,className:"px-6 py-2 border border-slate-300 text-slate-700 rounded-lg font-bold hover:bg-slate-100 transition-colors",children:"Cancelar"}),(0,b.jsx)("button",{onClick:()=>{0!==i.length&&(n(!0),setTimeout(()=>{e(i),n(!1),p()},1500))},disabled:0===i.length||k.length>0||m,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg font-bold hover:bg-indigo-700 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:m?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}),"Importando..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(r.UploadSimple,{size:20,weight:"bold"}),"Importar ",i.length," Usuarios"]})})]})]})})}var x=a.i(57764),y=a.i(45150);let z=[{level:1,label:"Nivel 1 (Admin Tenant)"},{level:2,label:"Nivel 2 (Jefe Ãrea)"},{level:3,label:"Nivel 3 (Analista Sr)"},{level:4,label:"Nivel 4 (Analista Jr)"},{level:5,label:"Nivel 5 (Asistente)"},{level:6,label:"Nivel 6 (Operativo)"}];function A(){let{currentUser:a,currentTenant:m,adminCreateUser:n,adminUpdateUser:q,adminDeleteUser:r,adminResendInvite:s,isSuperAdmin:t,adminCheckEmailUnique:u}=(0,d.useApp)(),[v,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(null),[F,G]=(0,c.useState)(0),[H,I]=(0,c.useState)(""),[J,K]=(0,c.useState)("details"),[L,M]=(0,c.useState)(""),[N,O]=(0,c.useState)(""),[P,Q]=(0,c.useState)({name:"",email:"",jobTitle:"",level:6,unit:"",status:"ACTIVE",passwordMode:"auto",password:"",mustChangePassword:!0,tenantId:""}),[R,S]=(0,c.useState)("ALL"),{currentTenant:T}=(0,d.useApp)();t||T?.id;let U=P.tenantId||(t?R:T?.id),V=(0,c.useMemo)(()=>{let a="ALL"===U?null:U;return a&&"global"!==a?e.DB.units.filter(b=>b.tenantId===a):[]},[U]),W=(0,c.useMemo)(()=>e.DB.users.filter(a=>{let b=!0;if(t)"ALL"!==R&&(b=a.tenantId===R);else{if(!T)return!1;b=a.tenantId===T.id}let c=a.name.toLowerCase().includes(H.toLowerCase())||(a.jobTitle||"").toLowerCase().includes(H.toLowerCase())||a.email?.toLowerCase().includes(H.toLowerCase()),d=!L||a.unit===L,e=!N||a.level===Number(N);return b&&c&&d&&e}),[T,t,R,H,F,L,N]),X=(0,c.useMemo)(()=>D?e.DB.platformAudit.filter(a=>a.target_user_id===D||a.actor_id===D).sort((a,b)=>new Date(b.created_at).getTime()-new Date(a.created_at).getTime()).slice(0,50):[],[D,F]);if(!t&&(!a||1!==a.level))return(0,b.jsx)("div",{className:"p-8 text-center text-red-500",children:"Acceso Denegado. Solo Admin Tenant."});if(!a)return(0,b.jsx)("div",{children:"Loading..."});let Y=t?"ALL"===R?"Todos los Tenants":e.DB.tenants.find(a=>a.id===R)?.name:m?.name,Z=a=>{if(a.preventDefault(),!D&&P.email&&!u(P.email))return void alert("El correo electrÃ³nico ya estÃ¡ registrado.");if(!D&&"manual"===P.passwordMode&&!P.password)return void alert("Por favor, ingresa una contraseÃ±a manual.");let b=z.find(a=>a.level===Number(P.level))?.label.split("(")[1].replace(")","")||"Usuario";"global"===P.tenantId&&(b="Super Admin");let{password:c,passwordMode:d,...e}=P,f={...e,role:b};D?q(D,f):(console.log(`[Notification System] Creating user ${P.email} with role ${b}`),n(f,{sendNotification:"auto"===P.passwordMode,customPassword:"manual"===P.passwordMode?P.password:void 0}),alert(`Usuario creado exitosamente. ${"auto"===P.passwordMode?"Se enviÃ³ invitaciÃ³n por correo.":"ContraseÃ±a asignada manualmente."}`)),A(!1),G(a=>a+1)};return(0,b.jsxs)("div",{className:"max-w-6xl mx-auto p-6 animate-fadeIn",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-2xl font-bold text-slate-900 flex items-center gap-2",children:[(0,b.jsx)(f.Users,{className:"text-blue-600"})," GestiÃ³n de Usuarios"]}),(0,b.jsxs)("p",{className:"text-sm text-slate-500 mt-1",children:["Administra el talento humano de ",Y,"."]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{onClick:()=>C(!0),className:"btn btn-secondary flex items-center gap-2",children:"Importar CSV"}),(0,b.jsxs)("button",{onClick:()=>{E(null),Q({name:"",email:"",jobTitle:"",level:6,unit:"",status:"ACTIVE",passwordMode:"auto",password:"",mustChangePassword:!0,tenantId:t?"ALL"===R?"":R:m?.id}),K("details"),A(!0)},className:"btn btn-primary flex items-center gap-2",children:[(0,b.jsx)(g.Plus,{weight:"bold"})," Invitar Usuario"]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:[(0,b.jsxs)("div",{className:"p-4 border-b border-slate-100 flex gap-2 flex-wrap",children:[(0,b.jsxs)("div",{className:"relative flex-1 min-w-[200px]",children:[(0,b.jsx)(j.MagnifyingGlass,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),(0,b.jsx)("input",{className:"w-full pl-10 pr-4 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 ring-blue-500/10",placeholder:"Buscar por nombre o cargo...",value:H,onChange:a=>I(a.target.value)})]}),t&&(0,b.jsxs)("select",{className:"px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm text-slate-600 focus:outline-none focus:ring-2 ring-blue-500/10 font-bold text-blue-800",value:R,onChange:a=>{S(a.target.value),M("")},children:[(0,b.jsx)("option",{value:"ALL",children:"ðŸ¢ Global (Todos)"}),e.DB.tenants.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]}),(0,b.jsxs)("select",{className:"px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm text-slate-600 focus:outline-none focus:ring-2 ring-blue-500/10",value:L,onChange:a=>M(a.target.value),children:[(0,b.jsx)("option",{value:"",children:"Todas las Unidades"}),V.map(a=>(0,b.jsx)("option",{value:a.name,children:a.name},a.id))]}),(0,b.jsxs)("select",{className:"px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm text-slate-600 focus:outline-none focus:ring-2 ring-blue-500/10",value:N,onChange:a=>O(a.target.value),children:[(0,b.jsx)("option",{value:"",children:"Todos los Niveles"}),z.map(a=>(0,b.jsx)("option",{value:a.level,children:a.label},a.level))]})]}),(0,b.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,b.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200 text-slate-500 uppercase font-semibold text-xs",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-6 py-4",children:"Usuario"}),(0,b.jsx)("th",{className:"px-6 py-4",children:"Rol / Nivel"}),(0,b.jsx)("th",{className:"px-6 py-4",children:"Unidad"}),t&&"ALL"===R&&(0,b.jsx)("th",{className:"px-6 py-4",children:"Tenant"}),(0,b.jsx)("th",{className:"px-6 py-4",children:"Estado"}),(0,b.jsx)("th",{className:"px-6 py-4 text-right",children:"Acciones"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-slate-100",children:W.map(a=>(0,b.jsxs)("tr",{className:"hover:bg-slate-50 transition-colors",children:[(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center font-bold text-xs",children:a.initials}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium text-slate-900",children:a.name}),(0,b.jsx)("div",{className:"text-xs text-slate-500",children:a.jobTitle})]})]})}),(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsxs)("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-600 border border-slate-200",children:[(0,b.jsx)("span",{className:"w-1.5 h-1.5 rounded-full bg-slate-400"}),"Nivel ",a.level," - ",a.role]})}),(0,b.jsx)("td",{className:"px-6 py-4",children:a.unit?(0,b.jsxs)("span",{className:"inline-flex items-center gap-1.5 text-slate-600",children:[(0,b.jsx)(l.Buildings,{size:14})," ",a.unit]}):(0,b.jsx)("span",{className:"text-slate-400 italic",children:"Sin asignar"})}),t&&"ALL"===R&&(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsx)("span",{className:`inline-flex items-center gap-1.5 text-xs font-bold px-2 py-1 rounded ${"global"===a.tenantId?"bg-purple-100 text-purple-700":"bg-slate-100 text-slate-500"}`,children:"global"===a.tenantId?"ðŸŒŽ Global":e.DB.tenants.find(b=>b.id===a.tenantId)?.name||"N/A"})}),(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsx)("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${"ACTIVE"===a.status?"bg-green-50 text-green-700 border-green-200":"SUSPENDED"===a.status?"bg-red-50 text-red-700 border-red-200":"bg-yellow-50 text-yellow-700 border-yellow-200"}`,children:"ACTIVE"===a.status?"Activo":"SUSPENDED"===a.status?"Suspendido":"Pendiente"})}),(0,b.jsx)("td",{className:"px-6 py-4 text-right",children:(0,b.jsxs)("div",{className:"flex justify-end gap-1",children:[(0,b.jsx)("button",{onClick:()=>{E(a.id),V.find(b=>b.name===a.unit)?.id,Q({name:a.name,email:a.email||"",jobTitle:a.jobTitle,level:a.level,unit:a.unit,status:a.status,mustChangePassword:a.mustChangePassword,tenantId:a.tenantId}),K("details"),A(!0)},className:"p-1.5 hover:bg-blue-50 text-blue-600 rounded",title:"Editar",children:(0,b.jsx)(h.Pencil,{})}),(0,b.jsx)("button",{onClick:()=>{var b;return b=a.id,void(confirm("Â¿EstÃ¡s seguro de eliminar este usuario?")&&(r(b),G(a=>a+1)))},className:"p-1.5 hover:bg-red-50 text-red-600 rounded",title:"Eliminar",children:(0,b.jsx)(i.Trash,{})})]})})]},a.id))})]})]}),v&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 backdrop-blur-sm",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden animate-fadeIn",children:[(0,b.jsxs)("div",{className:"px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50",children:[(0,b.jsx)("h3",{className:"font-bold text-slate-800",children:D?"Editar Usuario":"Invitar Usuario"}),(0,b.jsx)("button",{onClick:()=>A(!1),className:"text-slate-400 hover:text-slate-600",children:"Ã—"})]}),D&&(0,b.jsxs)("div",{className:"flex border-b border-slate-100 px-6 gap-6",children:[(0,b.jsx)("button",{onClick:()=>K("details"),className:`py-3 text-sm font-medium border-b-2 transition-colors ${"details"===J?"border-blue-500 text-blue-600":"border-transparent text-slate-500 hover:text-slate-800"}`,children:"Detalles"}),(0,b.jsx)("button",{onClick:()=>K("security"),className:`py-3 text-sm font-medium border-b-2 transition-colors ${"security"===J?"border-blue-500 text-blue-600":"border-transparent text-slate-500 hover:text-slate-800"}`,children:"Seguridad & Acceso"}),(0,b.jsx)("button",{onClick:()=>K("logs"),className:`py-3 text-sm font-medium border-b-2 transition-colors ${"logs"===J?"border-blue-500 text-blue-600":"border-transparent text-slate-500 hover:text-slate-800"}`,children:"Actividad"})]}),(0,b.jsxs)("div",{className:"p-6 h-[450px] overflow-y-auto",children:["details"===J&&(0,b.jsxs)("form",{id:"userForm",onSubmit:Z,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-semibold text-slate-500 mb-1",children:"Nombre Completo"}),(0,b.jsx)("input",{required:!0,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 ring-blue-500/20 outline-none transition-all",value:P.name,onChange:a=>Q({...P,name:a.target.value}),placeholder:"Ej. Juan PÃ©rez"})]}),t?(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-semibold text-slate-500 mb-1",children:"OrganizaciÃ³n / Tenant"}),(0,b.jsxs)("select",{className:`w-full px-3 py-2 border rounded-lg bg-white ${"global"===P.tenantId?"ring-2 ring-purple-500 border-purple-500 bg-purple-50":""}`,value:P.tenantId,onChange:a=>Q({...P,tenantId:a.target.value,unit:""}),disabled:!!D,children:[(0,b.jsx)("option",{value:"",disabled:!0,children:"Seleccionar..."}),(0,b.jsx)("option",{value:"global",children:"ðŸŒŽ Global System (Super Admin)"}),e.DB.tenants.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]}),"global"===P.tenantId&&(0,b.jsx)("p",{className:"text-[10px] text-purple-600 mt-1 font-bold",children:"âš ï¸ Este usuario tendrÃ¡ acceso total a la plataforma."})]}):(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-semibold text-slate-500 mb-1",children:"Estado"}),(0,b.jsxs)("select",{className:"w-full px-3 py-2 border rounded-lg bg-white",value:P.status,onChange:a=>Q({...P,status:a.target.value}),children:[(0,b.jsx)("option",{value:"ACTIVE",children:"Activo"}),(0,b.jsx)("option",{value:"PENDING_INVITE",children:"Pendiente"}),(0,b.jsx)("option",{value:"SUSPENDED",children:"Suspendido"})]})]})]}),t&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-semibold text-slate-500 mb-1",children:"Estado"}),(0,b.jsxs)("select",{className:"w-full px-3 py-2 border rounded-lg bg-white",value:P.status,onChange:a=>Q({...P,status:a.target.value}),children:[(0,b.jsx)("option",{value:"ACTIVE",children:"Activo"}),(0,b.jsx)("option",{value:"PENDING_INVITE",children:"Pendiente"}),(0,b.jsx)("option",{value:"SUSPENDED",children:"Suspendido"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-semibold text-slate-500 mb-1",children:"Email Corporativo"}),(0,b.jsx)("input",{type:"email",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 ring-blue-500/20 outline-none transition-all",value:P.email,onChange:a=>Q({...P,email:a.target.value}),placeholder:"usuario@empresa.com"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-semibold text-slate-500 mb-1",children:"Cargo / Puesto"}),(0,b.jsx)("input",{required:!0,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 ring-blue-500/20 outline-none transition-all",value:P.jobTitle,onChange:a=>Q({...P,jobTitle:a.target.value}),placeholder:"Ej. Analista Senior"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-semibold text-slate-500 mb-1",children:"Capa / Nivel"}),(0,b.jsx)("select",{className:"w-full px-3 py-2 border rounded-lg bg-white",value:P.level,onChange:a=>Q({...P,level:Number(a.target.value)}),disabled:"global"===P.tenantId,children:"global"===P.tenantId?(0,b.jsx)("option",{value:"1",children:"Nivel Global (Super Admin)"}):z.map(a=>(0,b.jsx)("option",{value:a.level,children:a.label},a.level))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-semibold text-slate-500 mb-1",children:"Unidad Org."}),(0,b.jsxs)("select",{className:"w-full px-3 py-2 border rounded-lg bg-white",value:P.unit||"",onChange:a=>Q({...P,unit:a.target.value}),children:[(0,b.jsx)("option",{value:"",children:"(Sin asignar)"}),V.map(a=>(0,b.jsx)("option",{value:a.name,children:a.name},a.id))]}),"global"===P.tenantId&&(0,b.jsx)("p",{className:"text-[10px] text-slate-400 mt-1",children:"Global no tiene unidades."})]})]}),!D&&(0,b.jsxs)("div",{className:"space-y-4 p-4 bg-slate-50 rounded-xl border border-slate-200 mt-4",children:[(0,b.jsxs)("h4",{className:"text-xs font-bold text-slate-700 uppercase tracking-wider flex items-center gap-2",children:[(0,b.jsx)(k.UserCircle,{size:16,className:"text-blue-600"})," ConfiguraciÃ³n de Acceso"]}),(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer group",children:[(0,b.jsx)("input",{type:"radio",name:"pwdMode",checked:"auto"===P.passwordMode,onChange:()=>Q({...P,passwordMode:"auto"}),className:"w-4 h-4 text-blue-600 border-slate-300 focus:ring-blue-500"}),(0,b.jsx)("span",{className:"text-sm text-slate-600 group-hover:text-slate-900 transition-colors",children:"Auto-generar y enviar"})]}),(0,b.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer group",children:[(0,b.jsx)("input",{type:"radio",name:"pwdMode",checked:"manual"===P.passwordMode,onChange:()=>Q({...P,passwordMode:"manual"}),className:"w-4 h-4 text-blue-600 border-slate-300 focus:ring-blue-500"}),(0,b.jsx)("span",{className:"text-sm text-slate-600 group-hover:text-slate-900 transition-colors",children:"Asignar manual"})]})]}),"manual"===P.passwordMode&&(0,b.jsxs)("div",{className:"animate-fadeIn",children:[(0,b.jsx)("label",{className:"block text-[10px] font-bold text-slate-400 uppercase mb-1",children:"ContraseÃ±a Manual"}),(0,b.jsx)("input",{type:"password",required:"manual"===P.passwordMode,className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 ring-blue-500/20 outline-none transition-all",value:P.password,onChange:a=>Q({...P,password:a.target.value}),placeholder:"MÃ­nimo 8 caracteres"})]})]})]}),"security"===J&&(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"p-4 bg-orange-50 border border-orange-100 rounded-xl",children:[(0,b.jsxs)("h4",{className:"flex items-center gap-2 font-bold text-orange-800 text-sm mb-2",children:[(0,b.jsx)(p.Envelope,{size:18})," ComunicaciÃ³n"]}),(0,b.jsx)("p",{className:"text-xs text-orange-700 mb-3",children:"EnvÃ­a un correo electrÃ³nico al usuario con instrucciones para restablecer su acceso."}),(0,b.jsx)("button",{type:"button",onClick:()=>{D&&confirm(`\xbfReenviar credenciales de acceso a ${P.email}?`)&&(s(D),alert("Credenciales enviadas correctamente."),G(a=>a+1))},className:"bg-white border border-orange-200 text-orange-700 px-3 py-1.5 rounded-lg text-xs font-semibold hover:bg-orange-100 transition-colors shadow-sm",children:"Reenviar Credenciales"})]}),(0,b.jsxs)("form",{id:"userForm",onSubmit:Z,className:"space-y-4",children:[(0,b.jsx)("div",{className:"border-t border-slate-100 pt-4",children:(0,b.jsxs)("label",{className:"flex items-center gap-3 p-3 border border-slate-200 rounded-xl cursor-pointer hover:bg-slate-50 transition-colors",children:[(0,b.jsx)("input",{type:"checkbox",className:"w-4 h-4 text-blue-600 rounded",checked:P.mustChangePassword,onChange:a=>Q({...P,mustChangePassword:a.target.checked})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-slate-800",children:"Forzar cambio de contraseÃ±a"}),(0,b.jsx)("div",{className:"text-xs text-slate-500",children:"El usuario deberÃ¡ actualizar su clave en el prÃ³ximo inicio de sesiÃ³n."})]})]})}),(0,b.jsxs)("div",{className:"border-t border-slate-100 pt-4",children:[(0,b.jsxs)("h4",{className:"text-xs font-bold text-slate-400 uppercase mb-3 flex items-center gap-2",children:[(0,b.jsx)(o,{size:14})," AsignaciÃ³n Manual de ContraseÃ±a"]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("input",{type:"password",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 ring-blue-500/20 outline-none transition-all text-sm",value:P.password,onChange:a=>Q({...P,password:a.target.value}),placeholder:"Nueva contraseÃ±a (dejar vacÃ­o si no desea cambiar)"}),(0,b.jsx)("p",{className:"text-[10px] text-slate-400",children:"Escribe aquÃ­ solo si deseas sobrescribir la contraseÃ±a actual del usuario manualmente."})]})]})]})]}),"logs"===J&&(0,b.jsx)("div",{className:"space-y-4",children:0===X.length?(0,b.jsx)("div",{className:"text-center py-10 text-slate-400 text-sm",children:"No hay actividad registrada recientemente."}):(0,b.jsxs)("table",{className:"w-full text-xs text-left",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-slate-100 text-slate-500",children:[(0,b.jsx)("th",{className:"py-2",children:"Evento"}),(0,b.jsx)("th",{className:"py-2",children:"Fecha"}),(0,b.jsx)("th",{className:"py-2",children:"Detalle"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-slate-50",children:X.map(a=>(0,b.jsxs)("tr",{className:"hover:bg-slate-50",children:[(0,b.jsx)("td",{className:"py-2 font-medium text-slate-700",children:a.event_type}),(0,b.jsx)("td",{className:"py-2 text-slate-500",children:new Date(a.created_at).toLocaleString()}),(0,b.jsx)("td",{className:"py-2 text-slate-500 max-w-[150px] truncate",title:JSON.stringify(a.metadata),children:a.metadata?.changes&&Array.isArray(a.metadata.changes)?a.metadata.changes.join(", "):"-"})]},a.id))})]})})]}),(0,b.jsxs)("div",{className:"px-6 py-4 border-t border-slate-100 bg-slate-50 flex justify-end gap-3",children:[(0,b.jsx)("button",{type:"button",onClick:()=>A(!1),className:"px-4 py-2 text-slate-500 hover:bg-slate-100 rounded-lg text-sm font-medium",children:"Cancelar"}),"logs"!==J&&(0,b.jsx)("button",{form:"userForm",type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-medium shadow-lg shadow-blue-500/20",children:D?"Guardar Cambios":"Enviar InvitaciÃ³n"})]})]})}),(0,b.jsx)(w,{isOpen:B,onClose:()=>C(!1),onImport:a=>{a.forEach(a=>{n(a,{sendNotification:!1})}),C(!1),G(a=>a+1)},tenantId:t?"ALL"===R?"global":R:m?.id||"global"}),(0,b.jsx)(x.default,{...y.usersGuide})]})}a.s(["default",()=>A],57353)}];

//# sourceMappingURL=app_dashboard_admin_users_page_tsx_013aa17e._.js.map