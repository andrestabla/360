module.exports=[55134,a=>{"use strict";var b=a.i(82665);a.s(["ChatService",0,{getConversations:async(a,c)=>({success:!0,data:b.DB.conversations.filter(b=>b.tenant_id===c&&b.participants.includes(a))}),getConversation:async a=>({success:!0,data:b.DB.conversations.find(b=>b.id===a)||null}),getMessages:async(a,c,d=50)=>{let e=b.DB.messages.filter(b=>b.conversation_id===a);e.sort((a,b)=>new Date(b.created_at).getTime()-new Date(a.created_at).getTime());let f=e.length>d;return f&&(e=e.slice(0,d)),{success:!0,data:e.reverse(),hasMore:f,nextCursor:f?e[0]?.id:void 0}},sendMessage:async(a,c,d,e,f,g)=>{let h=b.DB.users.find(a=>a.id===c),i=b.DB.conversations.find(b=>b.id===a),j={id:`msg-${Date.now()}`,tenant_id:i?.tenant_id||"",conversation_id:a,sender_id:c,body:d,body_type:"text",created_at:new Date().toISOString(),senderName:h?.name||"Unknown",reply_to_message_id:f,attachments:g,tempId:e,status:"sent"};return b.DB.messages.push(j),i&&(i.lastMessage=d,i.lastMessageAt=j.created_at),b.DB.save(),j},createConversation:async(a,c,d,e)=>{let f={id:`conv-${Date.now()}`,tenant_id:a,type:c,name:e,participants:d,createdAt:new Date().toISOString(),unreadCount:0};return b.DB.conversations.push(f),b.DB.save(),{success:!0,data:f}},markAsRead:async(a,c)=>{let d=b.DB.conversations.find(b=>b.id===a);return d&&(d.unreadCount=0),b.DB.save(),{success:!0,data:!0}},getUsers:async a=>({success:!0,data:b.DB.users.filter(b=>b.tenantId===a&&"ACTIVE"===b.status)}),checkNewMessages:async(a,c,d)=>{let e=b.DB.conversations.filter(b=>b.tenant_id===c&&b.participants.includes(a)).map(a=>a.id);return b.DB.messages.filter(b=>e.includes(b.conversation_id)&&b.sender_id!==a&&new Date(b.created_at)>new Date(d))},searchMessages:async(a,c,d)=>{let e=c.toLowerCase(),f=b.DB.messages.filter(b=>b.tenant_id===a);return d&&(f=f.filter(a=>a.conversation_id===d)),f.filter(a=>a.body.toLowerCase().includes(e))},searchConversations:async(a,c,d)=>{let e=d.toLowerCase();return b.DB.conversations.filter(b=>b.tenant_id===a&&b.participants.includes(c)&&(b.name?.toLowerCase().includes(e)||b.title?.toLowerCase().includes(e)))},searchUsers:async(a,c)=>{let d=c.toLowerCase();return b.DB.users.filter(b=>b.tenantId===a&&"ACTIVE"===b.status&&(b.name.toLowerCase().includes(d)||b.email?.toLowerCase().includes(d)))},createDM:async(a,c,d)=>{let e=b.DB.conversations.find(b=>b.tenant_id===a&&"dm"===b.type&&b.participants.includes(c)&&b.participants.includes(d));if(e)return{success:!0,data:e};let f={id:`conv-${Date.now()}`,tenant_id:a,type:"dm",participants:[c,d],createdAt:new Date().toISOString()};return b.DB.conversations.push(f),b.DB.save(),{success:!0,data:f}},createGroup:async(a,c,d,e)=>{let f={id:`conv-${Date.now()}`,tenant_id:a,type:"group",name:c,title:c,participants:[d,...e],createdAt:new Date().toISOString()};return b.DB.conversations.push(f),b.DB.save(),{success:!0,data:f}},isBlocked:async(a,b)=>!1,blockUser:async(a,b)=>!0,unblockUser:async(a,b)=>!0,editMessage:async(a,c,d)=>{let e=b.DB.messages.find(b=>b.id===a&&b.sender_id===c);return e?(e.body=d,b.DB.save(),{success:!0,data:e}):{success:!1,data:null,error:"Message not found"}},deleteMessage:async(a,c)=>{let d=b.DB.messages.findIndex(b=>b.id===a&&b.sender_id===c);return d>-1?(b.DB.messages.splice(d,1),b.DB.save(),{success:!0,data:!0}):{success:!1,data:!1,error:"Message not found"}},toggleReaction:async(a,b,c)=>({success:!0,data:!0}),uploadFile:async(a,b,c)=>(c&&c(100),{id:`att-${Date.now()}`,url:URL.createObjectURL(a),name:a.name,file_name:a.name,size:a.size,type:a.type,mime_type:a.type,tenant_id:b,created_at:new Date().toISOString()}),leaveGroup:async(a,c)=>{let d=b.DB.conversations.find(b=>b.id===a);return d?(d.participants=d.participants.filter(a=>a!==c),b.DB.save(),{success:!0,data:!0}):{success:!1,data:!1}},muteConversation:async(a,b,c)=>({success:!0,data:!0}),getNotificationSettings:async(a,b)=>({level:"all"}),updateNotificationSettings:async(a,b,c)=>!0,getGroupMembers:async a=>{let c=b.DB.conversations.find(b=>b.id===a);return c?b.DB.users.filter(a=>c.participants.includes(a.id)):[]},reportContent:async(a,b,c)=>({success:!0,data:!0})}])}];

//# sourceMappingURL=lib_services_chatService_ts_00ddeba6._.js.map