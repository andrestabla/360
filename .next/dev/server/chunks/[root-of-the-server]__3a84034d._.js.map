{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 56, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/shared/schema.ts"],"sourcesContent":["import { pgTable, text, varchar, integer, timestamp, boolean, json, serial } from \"drizzle-orm/pg-core\";\nimport { relations } from \"drizzle-orm\";\n\nexport const tenants = pgTable(\"tenants\", {\n  id: varchar(\"id\", { length: 255 }).primaryKey(),\n  name: text(\"name\").notNull(),\n  slug: varchar(\"slug\", { length: 255 }).notNull().unique(),\n  domains: json(\"domains\").$type<string[]>().default([]),\n  status: varchar(\"status\", { length: 50 }).notNull().default(\"ACTIVE\"),\n  timezone: varchar(\"timezone\", { length: 100 }).default(\"UTC\"),\n  locale: varchar(\"locale\", { length: 20 }).default(\"es\"),\n  branding: json(\"branding\").$type<Record<string, unknown>>().default({}),\n  policies: json(\"policies\").$type<Record<string, unknown>>().default({}),\n  ssoConfig: json(\"sso_config\").$type<Record<string, unknown>>(),\n  storageConfig: json(\"storage_config\").$type<Record<string, unknown>>(),\n  integrations: json(\"integrations\").$type<Record<string, unknown>[]>().default([]),\n  features: json(\"features\").$type<string[]>().default([]),\n  sector: varchar(\"sector\", { length: 255 }),\n  contactName: varchar(\"contact_name\", { length: 255 }),\n  contactEmail: varchar(\"contact_email\", { length: 255 }),\n  contactPhone: varchar(\"contact_phone\", { length: 100 }),\n  users: integer(\"users\").default(0),\n  storage: varchar(\"storage\", { length: 50 }).default(\"0 GB\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\", { length: 255 }).primaryKey(),\n  name: text(\"name\").notNull(),\n  email: varchar(\"email\", { length: 255 }),\n  role: varchar(\"role\", { length: 100 }).notNull(),\n  level: integer(\"level\").default(1),\n  tenantId: varchar(\"tenant_id\", { length: 255 }).notNull().references(() => tenants.id),\n  unit: varchar(\"unit\", { length: 255 }),\n  initials: varchar(\"initials\", { length: 10 }),\n  bio: text(\"bio\"),\n  phone: varchar(\"phone\", { length: 50 }),\n  location: varchar(\"location\", { length: 255 }),\n  jobTitle: varchar(\"job_title\", { length: 255 }),\n  language: varchar(\"language\", { length: 20 }).default(\"es\"),\n  timezone: varchar(\"timezone\", { length: 100 }),\n  status: varchar(\"status\", { length: 50 }).notNull().default(\"ACTIVE\"),\n  avatar: text(\"avatar\"),\n  password: text(\"password\"),\n  mustChangePassword: boolean(\"must_change_password\").default(false),\n  inviteSentAt: timestamp(\"invite_sent_at\"),\n  inviteExpiresAt: timestamp(\"invite_expires_at\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const units = pgTable(\"units\", {\n  id: varchar(\"id\", { length: 255 }).primaryKey(),\n  tenantId: varchar(\"tenant_id\", { length: 255 }).notNull().references(() => tenants.id),\n  name: text(\"name\").notNull(),\n  parentId: varchar(\"parent_id\", { length: 255 }),\n  managerId: varchar(\"manager_id\", { length: 255 }),\n  level: integer(\"level\").default(0),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const documents = pgTable(\"documents\", {\n  id: varchar(\"id\", { length: 255 }).primaryKey(),\n  tenantId: varchar(\"tenant_id\", { length: 255 }).notNull().references(() => tenants.id),\n  title: text(\"title\").notNull(),\n  content: text(\"content\"),\n  category: varchar(\"category\", { length: 255 }),\n  unitId: varchar(\"unit_id\", { length: 255 }),\n  ownerId: varchar(\"owner_id\", { length: 255 }),\n  status: varchar(\"status\", { length: 50 }).default(\"DRAFT\"),\n  version: integer(\"version\").default(1),\n  tags: json(\"tags\").$type<string[]>().default([]),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const conversations = pgTable(\"conversations\", {\n  id: varchar(\"id\", { length: 255 }).primaryKey(),\n  tenantId: varchar(\"tenant_id\", { length: 255 }).notNull().references(() => tenants.id),\n  type: varchar(\"type\", { length: 20 }).notNull().default(\"dm\"),\n  name: text(\"name\"),\n  title: text(\"title\"),\n  participants: json(\"participants\").$type<string[]>().default([]),\n  lastMessage: text(\"last_message\"),\n  lastMessageAt: timestamp(\"last_message_at\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const messages = pgTable(\"messages\", {\n  id: varchar(\"id\", { length: 255 }).primaryKey(),\n  tenantId: varchar(\"tenant_id\", { length: 255 }).notNull().references(() => tenants.id),\n  conversationId: varchar(\"conversation_id\", { length: 255 }).notNull().references(() => conversations.id),\n  senderId: varchar(\"sender_id\", { length: 255 }).notNull(),\n  body: text(\"body\").notNull(),\n  bodyType: varchar(\"body_type\", { length: 50 }).default(\"text\"),\n  attachments: json(\"attachments\").$type<Record<string, unknown>[]>().default([]),\n  readBy: json(\"read_by\").$type<string[]>().default([]),\n  replyToMessageId: varchar(\"reply_to_message_id\", { length: 255 }),\n  reactions: json(\"reactions\").$type<Record<string, unknown>[]>().default([]),\n  deletedAt: timestamp(\"deleted_at\"),\n  editedAt: timestamp(\"edited_at\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const workflows = pgTable(\"workflows\", {\n  id: varchar(\"id\", { length: 255 }).primaryKey(),\n  tenantId: varchar(\"tenant_id\", { length: 255 }).notNull().references(() => tenants.id),\n  title: text(\"title\").notNull(),\n  description: text(\"description\"),\n  status: varchar(\"status\", { length: 50 }).default(\"DRAFT\"),\n  ownerId: varchar(\"owner_id\", { length: 255 }),\n  steps: json(\"steps\").$type<Record<string, unknown>[]>().default([]),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const surveys = pgTable(\"surveys\", {\n  id: varchar(\"id\", { length: 255 }).primaryKey(),\n  tenantId: varchar(\"tenant_id\", { length: 255 }).notNull().references(() => tenants.id),\n  title: text(\"title\").notNull(),\n  description: text(\"description\"),\n  status: varchar(\"status\", { length: 50 }).default(\"DRAFT\"),\n  questions: json(\"questions\").$type<Record<string, unknown>[]>().default([]),\n  responses: json(\"responses\").$type<Record<string, unknown>[]>().default([]),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const tenantEmailConfigs = pgTable(\"tenant_email_configs\", {\n  id: varchar(\"id\", { length: 255 }).primaryKey(),\n  tenantId: varchar(\"tenant_id\", { length: 255 }),\n  provider: varchar(\"provider\", { length: 50 }).notNull().default(\"SMTP\"),\n  smtpHost: varchar(\"smtp_host\", { length: 255 }),\n  smtpPort: integer(\"smtp_port\").default(587),\n  smtpUser: varchar(\"smtp_user\", { length: 255 }),\n  smtpPasswordEncrypted: text(\"smtp_password_encrypted\"),\n  smtpSecure: boolean(\"smtp_secure\").default(false),\n  fromName: varchar(\"from_name\", { length: 255 }),\n  fromEmail: varchar(\"from_email\", { length: 255 }),\n  replyToEmail: varchar(\"reply_to_email\", { length: 255 }),\n  isEnabled: boolean(\"is_enabled\").default(false),\n  lastTestedAt: timestamp(\"last_tested_at\"),\n  lastTestResult: boolean(\"last_test_result\"),\n  lastTestError: text(\"last_test_error\"),\n  createdBy: varchar(\"created_by\", { length: 255 }),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const auditLogs = pgTable(\"audit_logs\", {\n  id: serial(\"id\").primaryKey(),\n  tenantId: varchar(\"tenant_id\", { length: 255 }).notNull(),\n  userId: varchar(\"user_id\", { length: 255 }),\n  action: varchar(\"action\", { length: 255 }).notNull(),\n  resource: varchar(\"resource\", { length: 255 }),\n  resourceId: varchar(\"resource_id\", { length: 255 }),\n  details: json(\"details\").$type<Record<string, unknown>>(),\n  ipAddress: varchar(\"ip_address\", { length: 50 }),\n  userAgent: text(\"user_agent\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const platformAdmins = pgTable(\"platform_admins\", {\n  id: varchar(\"id\", { length: 255 }).primaryKey(),\n  name: text(\"name\").notNull(),\n  email: varchar(\"email\", { length: 255 }).notNull().unique(),\n  password: text(\"password\").notNull(),\n  role: varchar(\"role\", { length: 50 }).notNull().default(\"SUPER_ADMIN\"),\n  avatar: text(\"avatar\"),\n  lastLogin: timestamp(\"last_login\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const tenantsRelations = relations(tenants, ({ many }) => ({\n  users: many(users),\n  units: many(units),\n  documents: many(documents),\n  conversations: many(conversations),\n  workflows: many(workflows),\n  surveys: many(surveys),\n}));\n\nexport const usersRelations = relations(users, ({ one }) => ({\n  tenant: one(tenants, {\n    fields: [users.tenantId],\n    references: [tenants.id],\n  }),\n}));\n\nexport const unitsRelations = relations(units, ({ one }) => ({\n  tenant: one(tenants, {\n    fields: [units.tenantId],\n    references: [tenants.id],\n  }),\n}));\n\nexport const documentsRelations = relations(documents, ({ one }) => ({\n  tenant: one(tenants, {\n    fields: [documents.tenantId],\n    references: [tenants.id],\n  }),\n}));\n\nexport const conversationsRelations = relations(conversations, ({ one, many }) => ({\n  tenant: one(tenants, {\n    fields: [conversations.tenantId],\n    references: [tenants.id],\n  }),\n  messages: many(messages),\n}));\n\nexport const messagesRelations = relations(messages, ({ one }) => ({\n  tenant: one(tenants, {\n    fields: [messages.tenantId],\n    references: [tenants.id],\n  }),\n  conversation: one(conversations, {\n    fields: [messages.conversationId],\n    references: [conversations.id],\n  }),\n}));\n\nexport type Tenant = typeof tenants.$inferSelect;\nexport type InsertTenant = typeof tenants.$inferInsert;\nexport type User = typeof users.$inferSelect;\nexport type InsertUser = typeof users.$inferInsert;\nexport type Unit = typeof units.$inferSelect;\nexport type InsertUnit = typeof units.$inferInsert;\nexport type Document = typeof documents.$inferSelect;\nexport type InsertDocument = typeof documents.$inferInsert;\nexport type Conversation = typeof conversations.$inferSelect;\nexport type InsertConversation = typeof conversations.$inferInsert;\nexport type Message = typeof messages.$inferSelect;\nexport type InsertMessage = typeof messages.$inferInsert;\nexport type Workflow = typeof workflows.$inferSelect;\nexport type InsertWorkflow = typeof workflows.$inferInsert;\nexport type Survey = typeof surveys.$inferSelect;\nexport type InsertSurvey = typeof surveys.$inferInsert;\nexport type AuditLog = typeof auditLogs.$inferSelect;\nexport type InsertAuditLog = typeof auditLogs.$inferInsert;\nexport type PlatformAdmin = typeof platformAdmins.$inferSelect;\nexport type InsertPlatformAdmin = typeof platformAdmins.$inferInsert;\nexport type TenantEmailConfig = typeof tenantEmailConfigs.$inferSelect;\nexport type InsertTenantEmailConfig = typeof tenantEmailConfigs.$inferInsert;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 469, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/server/db.ts"],"sourcesContent":["import { drizzle } from \"drizzle-orm/node-postgres\";\nimport pg from \"pg\";\nimport * as schema from \"@shared/schema\";\n\nconst { Pool } = pg;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle(pool, { schema });\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;;;;;;AAEA,MAAM,EAAE,IAAI,EAAE,GAAG,+GAAE;AAEnB,IAAI,CAAC,QAAQ,GAAG,CAAC,YAAY,EAAE;IAC7B,MAAM,IAAI,MACR;AAEJ;AAEO,MAAM,OAAO,IAAI,KAAK;IAAE,kBAAkB,QAAQ,GAAG,CAAC,YAAY;AAAC;AACnE,MAAM,KAAK,IAAA,yKAAO,EAAC,MAAM;IAAE,QAAA;AAAO"}},
    {"offset": {"line": 503, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/api/health/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { db } from '@/server/db';\nimport { sql } from 'drizzle-orm';\n\nexport async function GET() {\n  try {\n    const platformAdminsResult = await db.execute(sql`SELECT COUNT(*) as count FROM platform_admins`);\n    const tenantsResult = await db.execute(sql`SELECT COUNT(*) as count FROM tenants`);\n    const usersResult = await db.execute(sql`SELECT COUNT(*) as count FROM users`);\n\n    return NextResponse.json({\n      status: 'ok',\n      database: 'connected',\n      counts: {\n        platformAdmins: platformAdminsResult.rows[0]?.count || 0,\n        tenants: tenantsResult.rows[0]?.count || 0,\n        users: usersResult.rows[0]?.count || 0,\n      },\n      env: process.env.NODE_ENV,\n    });\n  } catch (error: any) {\n    console.error('Health check error:', error);\n    return NextResponse.json({\n      status: 'error',\n      database: 'disconnected',\n      error: error?.message?.includes('does not exist') \n        ? 'Tables not found - database not initialized' \n        : 'Database connection error',\n      env: process.env.NODE_ENV,\n    }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;;;;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,uBAAuB,MAAM,oHAAE,CAAC,OAAO,CAAC,qJAAG,CAAC,6CAA6C,CAAC;QAChG,MAAM,gBAAgB,MAAM,oHAAE,CAAC,OAAO,CAAC,qJAAG,CAAC,qCAAqC,CAAC;QACjF,MAAM,cAAc,MAAM,oHAAE,CAAC,OAAO,CAAC,qJAAG,CAAC,mCAAmC,CAAC;QAE7E,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,QAAQ;YACR,UAAU;YACV,QAAQ;gBACN,gBAAgB,qBAAqB,IAAI,CAAC,EAAE,EAAE,SAAS;gBACvD,SAAS,cAAc,IAAI,CAAC,EAAE,EAAE,SAAS;gBACzC,OAAO,YAAY,IAAI,CAAC,EAAE,EAAE,SAAS;YACvC;YACA,GAAG;QACL;IACF,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,QAAQ;YACR,UAAU;YACV,OAAO,OAAO,SAAS,SAAS,oBAC5B,gDACA;YACJ,GAAG;QACL,GAAG;YAAE,QAAQ;QAAI;IACnB;AACF"}}]
}