(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,98342,e=>{"use strict";var s=e.i(31487);e.s(["ChatService",0,{getConversations:async(e,t)=>({success:!0,data:s.DB.conversations.filter(s=>s.tenant_id===t&&s.participants.includes(e))}),getConversation:async e=>({success:!0,data:s.DB.conversations.find(s=>s.id===e)||null}),getMessages:async(e,t,a=50)=>{let n=s.DB.messages.filter(s=>s.conversation_id===e);n.sort((e,s)=>new Date(s.created_at).getTime()-new Date(e.created_at).getTime());let i=n.length>a;return i&&(n=n.slice(0,a)),{success:!0,data:n.reverse(),hasMore:i,nextCursor:i?n[0]?.id:void 0}},sendMessage:async(e,t,a,n,i,r)=>{let c=s.DB.users.find(e=>e.id===t),d=s.DB.conversations.find(s=>s.id===e),o={id:`msg-${Date.now()}`,tenant_id:d?.tenant_id||"",conversation_id:e,sender_id:t,body:a,body_type:"text",created_at:new Date().toISOString(),senderName:c?.name||"Unknown",reply_to_message_id:i,attachments:r,tempId:n,status:"sent"};return s.DB.messages.push(o),d&&(d.lastMessage=a,d.lastMessageAt=o.created_at),s.DB.save(),o},createConversation:async(e,t,a,n)=>{let i={id:`conv-${Date.now()}`,tenant_id:e,type:t,name:n,participants:a,createdAt:new Date().toISOString(),unreadCount:0};return s.DB.conversations.push(i),s.DB.save(),{success:!0,data:i}},markAsRead:async(e,t)=>{let a=s.DB.conversations.find(s=>s.id===e);return a&&(a.unreadCount=0),s.DB.save(),{success:!0,data:!0}},getUsers:async e=>({success:!0,data:s.DB.users.filter(s=>s.tenantId===e&&"ACTIVE"===s.status)}),checkNewMessages:async(e,t,a)=>{let n=s.DB.conversations.filter(s=>s.tenant_id===t&&s.participants.includes(e)).map(e=>e.id);return s.DB.messages.filter(s=>n.includes(s.conversation_id)&&s.sender_id!==e&&new Date(s.created_at)>new Date(a))},searchMessages:async(e,t,a)=>{let n=t.toLowerCase(),i=s.DB.messages.filter(s=>s.tenant_id===e);return a&&(i=i.filter(e=>e.conversation_id===a)),i.filter(e=>e.body.toLowerCase().includes(n))},searchConversations:async(e,t,a)=>{let n=a.toLowerCase();return s.DB.conversations.filter(s=>s.tenant_id===e&&s.participants.includes(t)&&(s.name?.toLowerCase().includes(n)||s.title?.toLowerCase().includes(n)))},searchUsers:async(e,t)=>{let a=t.toLowerCase();return s.DB.users.filter(s=>s.tenantId===e&&"ACTIVE"===s.status&&(s.name.toLowerCase().includes(a)||s.email?.toLowerCase().includes(a)))},createDM:async(e,t,a)=>{let n=s.DB.conversations.find(s=>s.tenant_id===e&&"dm"===s.type&&s.participants.includes(t)&&s.participants.includes(a));if(n)return{success:!0,data:n};let i={id:`conv-${Date.now()}`,tenant_id:e,type:"dm",participants:[t,a],createdAt:new Date().toISOString()};return s.DB.conversations.push(i),s.DB.save(),{success:!0,data:i}},createGroup:async(e,t,a,n)=>{let i={id:`conv-${Date.now()}`,tenant_id:e,type:"group",name:t,title:t,participants:[a,...n],createdAt:new Date().toISOString()};return s.DB.conversations.push(i),s.DB.save(),{success:!0,data:i}},isBlocked:async(e,s)=>!1,blockUser:async(e,s)=>!0,unblockUser:async(e,s)=>!0,editMessage:async(e,t,a)=>{let n=s.DB.messages.find(s=>s.id===e&&s.sender_id===t);return n?(n.body=a,s.DB.save(),{success:!0,data:n}):{success:!1,data:null,error:"Message not found"}},deleteMessage:async(e,t)=>{let a=s.DB.messages.findIndex(s=>s.id===e&&s.sender_id===t);return a>-1?(s.DB.messages.splice(a,1),s.DB.save(),{success:!0,data:!0}):{success:!1,data:!1,error:"Message not found"}},toggleReaction:async(e,s,t)=>({success:!0,data:!0}),uploadFile:async(e,s,t)=>(t&&t(100),{id:`att-${Date.now()}`,url:URL.createObjectURL(e),name:e.name,file_name:e.name,size:e.size,type:e.type,mime_type:e.type,tenant_id:s,created_at:new Date().toISOString()}),leaveGroup:async(e,t)=>{let a=s.DB.conversations.find(s=>s.id===e);return a?(a.participants=a.participants.filter(e=>e!==t),s.DB.save(),{success:!0,data:!0}):{success:!1,data:!1}},muteConversation:async(e,s,t)=>({success:!0,data:!0}),getNotificationSettings:async(e,s)=>({level:"all"}),updateNotificationSettings:async(e,s,t)=>!0,getGroupMembers:async e=>{let t=s.DB.conversations.find(s=>s.id===e);return t?s.DB.users.filter(e=>t.participants.includes(e.id)):[]},reportContent:async(e,s,t)=>({success:!0,data:!0})}])}]);