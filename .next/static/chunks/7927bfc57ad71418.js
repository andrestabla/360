(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,25209,e=>{"use strict";var t=e.i(71645),a=e.i(69464);let l=new Map([["bold",t.createElement(t.Fragment,null,t.createElement("path",{d:"M232.49,215.51,185,168a92.12,92.12,0,1,0-17,17l47.53,47.54a12,12,0,0,0,17-17ZM44,112a68,68,0,1,1,68,68A68.07,68.07,0,0,1,44,112Z"}))],["duotone",t.createElement(t.Fragment,null,t.createElement("path",{d:"M192,112a80,80,0,1,1-80-80A80,80,0,0,1,192,112Z",opacity:"0.2"}),t.createElement("path",{d:"M229.66,218.34,179.6,168.28a88.21,88.21,0,1,0-11.32,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z"}))],["fill",t.createElement(t.Fragment,null,t.createElement("path",{d:"M168,112a56,56,0,1,1-56-56A56,56,0,0,1,168,112Zm61.66,117.66a8,8,0,0,1-11.32,0l-50.06-50.07a88,88,0,1,1,11.32-11.31l50.06,50.06A8,8,0,0,1,229.66,229.66ZM112,184a72,72,0,1,0-72-72A72.08,72.08,0,0,0,112,184Z"}))],["light",t.createElement(t.Fragment,null,t.createElement("path",{d:"M228.24,219.76l-51.38-51.38a86.15,86.15,0,1,0-8.48,8.48l51.38,51.38a6,6,0,0,0,8.48-8.48ZM38,112a74,74,0,1,1,74,74A74.09,74.09,0,0,1,38,112Z"}))],["regular",t.createElement(t.Fragment,null,t.createElement("path",{d:"M229.66,218.34l-50.07-50.06a88.11,88.11,0,1,0-11.31,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z"}))],["thin",t.createElement(t.Fragment,null,t.createElement("path",{d:"M226.83,221.17l-52.7-52.7a84.1,84.1,0,1,0-5.66,5.66l52.7,52.7a4,4,0,0,0,5.66-5.66ZM36,112a76,76,0,1,1,76,76A76.08,76.08,0,0,1,36,112Z"}))]]),s=t.forwardRef((e,s)=>t.createElement(a.default,{ref:s,...e,weights:l}));s.displayName="MagnifyingGlassIcon",e.s(["MagnifyingGlass",()=>s],25209)},1753,e=>{"use strict";var t=e.i(71645),a=e.i(69464);let l=new Map([["bold",t.createElement(t.Fragment,null,t.createElement("path",{d:"M228,144v64a12,12,0,0,1-12,12H40a12,12,0,0,1-12-12V144a12,12,0,0,1,24,0v52H204V144a12,12,0,0,1,24,0Zm-108.49,8.49a12,12,0,0,0,17,0l40-40a12,12,0,0,0-17-17L140,115V32a12,12,0,0,0-24,0v83L96.49,95.51a12,12,0,0,0-17,17Z"}))],["duotone",t.createElement(t.Fragment,null,t.createElement("path",{d:"M216,48V208H40V48A16,16,0,0,1,56,32H200A16,16,0,0,1,216,48Z",opacity:"0.2"}),t.createElement("path",{d:"M224,144v64a8,8,0,0,1-8,8H40a8,8,0,0,1-8-8V144a8,8,0,0,1,16,0v56H208V144a8,8,0,0,1,16,0Zm-101.66,5.66a8,8,0,0,0,11.32,0l40-40a8,8,0,0,0-11.32-11.32L136,124.69V32a8,8,0,0,0-16,0v92.69L93.66,98.34a8,8,0,0,0-11.32,11.32Z"}))],["fill",t.createElement(t.Fragment,null,t.createElement("path",{d:"M224,144v64a8,8,0,0,1-8,8H40a8,8,0,0,1-8-8V144a8,8,0,0,1,16,0v56H208V144a8,8,0,0,1,16,0Zm-101.66,5.66a8,8,0,0,0,11.32,0l40-40A8,8,0,0,0,168,96H136V32a8,8,0,0,0-16,0V96H88a8,8,0,0,0-5.66,13.66Z"}))],["light",t.createElement(t.Fragment,null,t.createElement("path",{d:"M222,144v64a6,6,0,0,1-6,6H40a6,6,0,0,1-6-6V144a6,6,0,0,1,12,0v58H210V144a6,6,0,0,1,12,0Zm-98.24,4.24a6,6,0,0,0,8.48,0l40-40a6,6,0,0,0-8.48-8.48L134,129.51V32a6,6,0,0,0-12,0v97.51L92.24,99.76a6,6,0,0,0-8.48,8.48Z"}))],["regular",t.createElement(t.Fragment,null,t.createElement("path",{d:"M224,144v64a8,8,0,0,1-8,8H40a8,8,0,0,1-8-8V144a8,8,0,0,1,16,0v56H208V144a8,8,0,0,1,16,0Zm-101.66,5.66a8,8,0,0,0,11.32,0l40-40a8,8,0,0,0-11.32-11.32L136,124.69V32a8,8,0,0,0-16,0v92.69L93.66,98.34a8,8,0,0,0-11.32,11.32Z"}))],["thin",t.createElement(t.Fragment,null,t.createElement("path",{d:"M220,144v64a4,4,0,0,1-4,4H40a4,4,0,0,1-4-4V144a4,4,0,0,1,8,0v60H212V144a4,4,0,0,1,8,0Zm-94.83,2.83a4,4,0,0,0,5.66,0l40-40a4,4,0,1,0-5.66-5.66L132,134.34V32a4,4,0,0,0-8,0V134.34L90.83,101.17a4,4,0,0,0-5.66,5.66Z"}))]]),s=t.forwardRef((e,s)=>t.createElement(a.default,{ref:s,...e,weights:l}));s.displayName="DownloadSimpleIcon",e.s(["DownloadSimple",()=>s],1753)},82006,e=>{"use strict";var t=e.i(71645),a=e.i(69464);let l=new Map([["bold",t.createElement(t.Fragment,null,t.createElement("path",{d:"M244,56v48a12,12,0,0,1-12,12H184a12,12,0,1,1,0-24H201.1l-19-17.38c-.13-.12-.26-.24-.38-.37A76,76,0,1,0,127,204h1a75.53,75.53,0,0,0,52.15-20.72,12,12,0,0,1,16.49,17.45A99.45,99.45,0,0,1,128,228h-1.37A100,100,0,1,1,198.51,57.06L220,76.72V56a12,12,0,0,1,24,0Z"}))],["duotone",t.createElement(t.Fragment,null,t.createElement("path",{d:"M216,128a88,88,0,1,1-88-88A88,88,0,0,1,216,128Z",opacity:"0.2"}),t.createElement("path",{d:"M240,56v48a8,8,0,0,1-8,8H184a8,8,0,0,1,0-16H211.4L184.81,71.64l-.25-.24a80,80,0,1,0-1.67,114.78,8,8,0,0,1,11,11.63A95.44,95.44,0,0,1,128,224h-1.32A96,96,0,1,1,195.75,60L224,85.8V56a8,8,0,1,1,16,0Z"}))],["fill",t.createElement(t.Fragment,null,t.createElement("path",{d:"M240,56v48a8,8,0,0,1-8,8H184a8,8,0,0,1-5.66-13.66l17-17-10.55-9.65-.25-.24a80,80,0,1,0-1.67,114.78,8,8,0,1,1,11,11.63A95.44,95.44,0,0,1,128,224h-1.32A96,96,0,1,1,195.75,60l10.93,10L226.34,50.3A8,8,0,0,1,240,56Z"}))],["light",t.createElement(t.Fragment,null,t.createElement("path",{d:"M238,56v48a6,6,0,0,1-6,6H184a6,6,0,0,1,0-12h32.55l-30.38-27.8c-.06-.06-.12-.13-.19-.19a82,82,0,1,0-1.7,117.65,6,6,0,0,1,8.24,8.73A93.46,93.46,0,0,1,128,222h-1.28A94,94,0,1,1,194.37,61.4L226,90.35V56a6,6,0,1,1,12,0Z"}))],["regular",t.createElement(t.Fragment,null,t.createElement("path",{d:"M240,56v48a8,8,0,0,1-8,8H184a8,8,0,0,1,0-16H211.4L184.81,71.64l-.25-.24a80,80,0,1,0-1.67,114.78,8,8,0,0,1,11,11.63A95.44,95.44,0,0,1,128,224h-1.32A96,96,0,1,1,195.75,60L224,85.8V56a8,8,0,1,1,16,0Z"}))],["thin",t.createElement(t.Fragment,null,t.createElement("path",{d:"M236,56v48a4,4,0,0,1-4,4H184a4,4,0,0,1,0-8h37.7L187.53,68.69l-.13-.12a84,84,0,1,0-1.75,120.51,4,4,0,0,1,5.5,5.82A91.43,91.43,0,0,1,128,220h-1.26A92,92,0,1,1,193,62.84l35,32.05V56a4,4,0,1,1,8,0Z"}))]]),s=t.forwardRef((e,s)=>t.createElement(a.default,{ref:s,...e,weights:l}));s.displayName="ArrowClockwiseIcon",e.s(["ArrowClockwise",()=>s],82006)},41052,e=>{"use strict";var t=e.i(43476),a=e.i(71645),l=e.i(73146),s=e.i(31487),n=e.i(22187),r=e.i(25209),i=e.i(1753),d=e.i(82006),c=e.i(90961),o=e.i(68817);function m(){let{isSuperAdmin:e}=(0,l.useApp)(),[m,p]=(0,a.useState)(""),[x,h]=(0,a.useState)("ALL"),[u,g]=(0,a.useState)("ALL"),[b,v]=(0,a.useState)(""),[f,w]=(0,a.useState)(""),[j,N]=(0,a.useState)(1),[y,A]=(0,a.useState)(0);if(!e)return(0,t.jsx)("div",{className:"p-8 text-center text-red-500",children:"Acceso Denegado. Solo Super Admins."});let _=(0,a.useMemo)(()=>Array.from(new Set(s.DB.platformAudit.map(e=>e.event_type))).sort(),[y]),E=(0,a.useMemo)(()=>s.DB.platformAudit.filter(e=>{let t=m.toLowerCase(),a=e.event_type.toLowerCase().includes(t)||e.actor_name.toLowerCase().includes(t)||e.target_tenant_id&&e.target_tenant_id.toLowerCase().includes(t)||e.target_user_id&&e.target_user_id.toLowerCase().includes(t),l="ALL"===x||e.target_tenant_id===x,s="ALL"===u||e.event_type===u,n=!0;if(b&&(n=n&&new Date(e.created_at)>=new Date(b)),f){let t=new Date(f);t.setDate(t.getDate()+1),n=n&&new Date(e.created_at)<t}return a&&l&&s&&n}).sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()),[m,x,u,b,f,y]),M=Math.ceil(E.length/20),L=E.slice((j-1)*20,20*j);return(0,t.jsxs)("div",{className:"max-w-7xl mx-auto p-6 animate-fadeIn",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-2xl font-bold text-slate-900 flex items-center gap-2",children:[(0,t.jsx)(n.ShieldCheck,{className:"text-purple-600"})," AuditorÃ­a Global"]}),(0,t.jsx)("p",{className:"text-sm text-slate-500 mt-1",children:"Registro inalterable de actividades crÃ­ticas en la plataforma."})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>A(e=>e+1),className:"btn btn-secondary",title:"Actualizar",children:(0,t.jsx)(d.ArrowClockwise,{})}),(0,t.jsxs)("button",{onClick:()=>{let e=new Blob([["ID,Fecha,Evento,Actor ID,Actor Nombre,Target Tenant,Target User,IP,Metadata",...E.map(e=>[e.id,new Date(e.created_at).toISOString(),e.event_type,e.actor_id,`"${e.actor_name}"`,e.target_tenant_id||"",e.target_user_id||"",e.ip,`"${JSON.stringify(e.metadata).replace(/"/g,'""')}"`]).map(e=>e.join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),t=URL.createObjectURL(e),a=document.createElement("a");a.setAttribute("href",t),a.setAttribute("download",`auditoria_export_${new Date().toISOString().split("T")[0]}.csv`),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a),s.DB.platformAudit.unshift({id:`audit-${Date.now()}`,event_type:"AUDIT_EXPORT",actor_id:"superadmin",actor_name:"Super Admin",metadata:{count:E.length,filters:{search:m,filterTenantId:x,filterEventType:u}},ip:"127.0.0.1",created_at:new Date().toISOString()}),A(e=>e+1)},className:"btn btn-primary flex items-center gap-2",children:[(0,t.jsx)(i.DownloadSimple,{weight:"bold"})," Exportar CSV"]})]})]}),(0,t.jsx)("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-slate-200 mb-6 space-y-4",children:(0,t.jsxs)("div",{className:"flex flex-wrap gap-4 items-end",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,t.jsx)("label",{className:"text-xs font-bold text-slate-500 uppercase mb-1 block",children:"BÃºsqueda"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(r.MagnifyingGlass,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),(0,t.jsx)("input",{className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 ring-purple-500/20 outline-none",placeholder:"Buscar por evento, usuario, tenant...",value:m,onChange:e=>{p(e.target.value),N(1)}})]})]}),(0,t.jsxs)("div",{className:"w-48",children:[(0,t.jsx)("label",{className:"text-xs font-bold text-slate-500 uppercase mb-1 block",children:"Tenant"}),(0,t.jsxs)("select",{className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 ring-purple-500/20 outline-none bg-slate-50",value:x,onChange:e=>{h(e.target.value),N(1)},children:[(0,t.jsx)("option",{value:"ALL",children:"Todos los Tenants"}),s.DB.tenants.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{className:"w-48",children:[(0,t.jsx)("label",{className:"text-xs font-bold text-slate-500 uppercase mb-1 block",children:"Tipo de Evento"}),(0,t.jsxs)("select",{className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 ring-purple-500/20 outline-none bg-slate-50",value:u,onChange:e=>{g(e.target.value),N(1)},children:[(0,t.jsx)("option",{value:"ALL",children:"Todos"}),_.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]}),(0,t.jsxs)("div",{className:"w-36",children:[(0,t.jsx)("label",{className:"text-xs font-bold text-slate-500 uppercase mb-1 block",children:"Desde"}),(0,t.jsx)("input",{type:"date",className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 ring-purple-500/20 outline-none",value:b,onChange:e=>{v(e.target.value),N(1)}})]}),(0,t.jsxs)("div",{className:"w-36",children:[(0,t.jsx)("label",{className:"text-xs font-bold text-slate-500 uppercase mb-1 block",children:"Hasta"}),(0,t.jsx)("input",{type:"date",className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 ring-purple-500/20 outline-none",value:f,onChange:e=>{w(e.target.value),N(1)}})]})]})}),(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:[(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,t.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200 text-slate-500 uppercase font-semibold text-xs",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-4 whitespace-nowrap",children:"Fecha / Hora"}),(0,t.jsx)("th",{className:"px-6 py-4 whitespace-nowrap",children:"Evento"}),(0,t.jsx)("th",{className:"px-6 py-4 whitespace-nowrap",children:"Actor"}),(0,t.jsx)("th",{className:"px-6 py-4 whitespace-nowrap",children:"Contexto"}),(0,t.jsx)("th",{className:"px-6 py-4 min-w-[300px]",children:"Detalle (Metadata)"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-slate-100",children:0===L.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:5,className:"px-6 py-8 text-center text-slate-400 italic",children:"No se encontraron eventos de auditorÃ­a con los filtros actuales."})}):L.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-slate-50 transition-colors group",children:[(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-slate-500 text-xs",children:new Date(e.created_at).toLocaleString()}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsx)("span",{className:"font-mono text-xs font-medium bg-slate-100 px-2 py-1 rounded text-slate-700 border border-slate-200",children:e.event_type})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"font-medium text-slate-900",children:e.actor_name}),(0,t.jsx)("span",{className:"text-[10px] text-slate-400 font-mono",children:e.actor_id})]})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[e.target_tenant_id&&(0,t.jsxs)("span",{className:"text-xs text-slate-600 flex items-center gap-1",children:["ğŸ¢ ",s.DB.tenants.find(t=>t.id===e.target_tenant_id)?.name||e.target_tenant_id]}),e.target_user_id&&(0,t.jsxs)("span",{className:"text-xs text-slate-500 flex items-center gap-1",children:["ğŸ‘¤ ",s.DB.users.find(t=>t.id===e.target_user_id)?.name||e.target_user_id]})]})}),(0,t.jsx)("td",{className:"px-6 py-4 text-xs text-slate-600 break-all font-mono bg-slate-50/50",children:(0,t.jsx)("div",{className:"max-h-20 overflow-y-auto custom-scrollbar",children:JSON.stringify(e.metadata,null,2)})})]},e.id))})]})}),M>1&&(0,t.jsxs)("div",{className:"px-6 py-4 border-t border-slate-100 bg-slate-50 flex justify-between items-center",children:[(0,t.jsxs)("div",{className:"text-xs text-slate-500",children:["Mostrando ",(j-1)*20+1," - ",Math.min(20*j,E.length)," de ",E.length," eventos"]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>N(e=>Math.max(1,e-1)),disabled:1===j,className:"p-2 border border-slate-200 rounded bg-white disabled:opacity-50 hover:bg-slate-100",children:(0,t.jsx)(c.CaretLeft,{})}),(0,t.jsxs)("span",{className:"flex items-center px-4 text-xs font-medium text-slate-600",children:["PÃ¡gina ",j," de ",M]}),(0,t.jsx)("button",{onClick:()=>N(e=>Math.min(M,e+1)),disabled:j===M,className:"p-2 border border-slate-200 rounded bg-white disabled:opacity-50 hover:bg-slate-100",children:(0,t.jsx)(o.CaretRight,{})})]})]})]})]})}e.s(["default",()=>m])}]);